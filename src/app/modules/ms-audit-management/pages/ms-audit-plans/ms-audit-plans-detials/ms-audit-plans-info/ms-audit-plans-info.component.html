
<ng-container *mobxAutorun>
    <div *ngIf="!MsAuditPlansStore.individualLoaded">
        <app-ng-audit-plan-detials-loader></app-ng-audit-plan-detials-loader>
    </div>
</ng-container>
<div class="tab-content" *ngIf="MsAuditPlansStore.individualLoaded  && AuthStore.getActivityPermission(5356,'MS_AUDIT_PLAN_DETAILS') ">
    <!-- Profille -->
    <div class="tab-pane active" id="info" *mobxAutorun>

        <div class="row widget">
            <div class="col-sm-12 col-lg-8 padding-right-0">
                <div class="bg-white widg-padding-cmn">
                    <div class="min-height-64">
                    <div class="issue-top-sec">
                        <div class="clearfix">
                            <h5 class="d-inline-block cmn-head-style label-tag-style mr-2">
                                <span class="issue-smoal-head-text">#{{MsAuditPlansStore.individualMsAuditPlansDetails?.reference_code? MsAuditPlansStore.individualMsAuditPlansDetails?.reference_code: '##'}}</span> 
                                {{ MsAuditPlansStore.individualMsAuditPlansDetails?.title ? MsAuditPlansStore.individualMsAuditPlansDetails?.title: AppStore.noContentText }}
                                <span
                                [ngClass]="'draft-tag draft-tag-'+MsAuditPlansStore.individualMsAuditPlansDetails?.ms_audit_plan_status?.label+' label-tag-style-tag label-left-arow-tag d-inline-block status-tag-new-one'">
                                {{MsAuditPlansStore.individualMsAuditPlansDetails?.ms_audit_plan_status? MsAuditPlansStore.individualMsAuditPlansDetails?.ms_audit_plan_status?.language[0]?.pivot?.title : 'NA' }}</span>                           
                            </h5>                                             
                        </div>
                        <div class="clearfix">
                            <p class="label-tag-style"><i class="fas fa-calendar-alt date-pics-two"></i> 
                                {{ MsAuditPlansStore.individualMsAuditPlansDetails?.start_date | date: OrganizationGeneralSettingsStore.organizationSettings?.date_time_format}}  
                                To  
                                {{ MsAuditPlansStore.individualMsAuditPlansDetails?.end_date | date: OrganizationGeneralSettingsStore.organizationSettings?.date_time_format}}
                                <!-- <span class="blinking">( 2 Days )</span> -->
                            </p>
                        </div>
                        <!-- <p>The primary objective of a Quality Assurance Audit is to gather information related to the on-going status of a process and then applying the information gathered to evaluate the performance of the process against defined criteria. When performing an audit you are reviewing the activities, the records, processes, systems, user experiences, competences, etc., in place and seeing how they compare to expected standards of performance, customer expectations, design expectations, etc.</p> -->
                        <div class="mb-2 mt-2" [ngStyle] = "{display: !OrganizationGeneralSettingsStore?.organizationSettings?.is_ms_type ? 'none':'block'}"> 
                            <h6 *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.ms_type_organizations.length>0">{{'ms_type' | translate}} </h6>
                            <label *ngFor="let type of MsAuditPlansStore.individualMsAuditPlansDetails?.ms_type_organizations" class="outline-tag">{{type.ms_type.title}} <span>{{type.ms_type_version.title}}</span></label> 
                        </div>
                    </div>
                    <div>
                        <div class="row">

                            <div class="col-md-4">
                                <h6>{{'ms_audit_program' | translate}}</h6>
                                <p> {{ MsAuditPlansStore.individualMsAuditPlansDetails?.ms_audit_program?.title ? MsAuditPlansStore.individualMsAuditPlansDetails?.ms_audit_program?.title: AppStore.noContentText }}</p>
                            </div>

                            <div class="col-md-4">
                                <h6>{{'audit_mode' | translate}}</h6>
                                <p>{{ MsAuditPlansStore.individualMsAuditPlansDetails?.ms_audit_mode ? MsAuditPlansStore.individualMsAuditPlansDetails?.ms_audit_mode?.language[0]?.pivot?.title: AppStore.noContentText }}</p>
                            </div>

                            <!-- <div class="col-md-4">
                                <h6>{{'team' | translate}}</h6>
                                <p> {{ MsAuditPlansStore.individualMsAuditPlansDetails?.team ? MsAuditPlansStore.individualMsAuditPlansDetails?.team?.title: AppStore.noContentText }}</p>
                            </div> -->

                            <!-- <div class="col-md-4">
                                <h6>{{'checklist_title' | translate}}</h6>
                                <p> {{ MsAuditPlansStore.individualMsAuditPlansDetails?.checklist_group ? MsAuditPlansStore.individualMsAuditPlansDetails?.checklist_group?.title: AppStore.noContentText }}</p>
                            </div> -->

                            <div class="col-md-4" *ngIf = " MsAuditPlansStore.individualMsAuditPlansDetails?.organization && OrganizationLevelSettingsStore.organizationLevelSettings?.is_subsidiary">
                                <h6>{{'organization' | translate}} </h6>
                                <p>{{ MsAuditPlansStore.individualMsAuditPlansDetails?.organization ? MsAuditPlansStore.individualMsAuditPlansDetails?.organization?.title: AppStore.noContentText }}</p>
                            </div>

                            <div class="col-md-4" *ngIf=" MsAuditPlansStore.individualMsAuditPlansDetails?.division" [ngStyle] = "{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_division ? 'none':'block'}">
                                <h6>{{'division' | translate}}</h6>
                                <p>{{ MsAuditPlansStore.individualMsAuditPlansDetails?.division ? MsAuditPlansStore.individualMsAuditPlansDetails?.division?.title: AppStore.noContentText }}</p>
                            </div>

                          

                            <div class="col-md-4" *ngIf=" MsAuditPlansStore.individualMsAuditPlansDetails?.section" [ngStyle] = "{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_section ? 'none':'block'}">
                                <h6> {{'section' | translate}}</h6>
                                <p>{{ MsAuditPlansStore.individualMsAuditPlansDetails?.section ? MsAuditPlansStore.individualMsAuditPlansDetails?.section?.title: AppStore.noContentText }}</p>
                            </div>

                            <div class="col-md-4" *ngIf=" MsAuditPlansStore.individualMsAuditPlansDetails?.sub_section " [ngStyle] = "{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_sub_section ? 'none':'block'}">
                                <h6>{{'sub_section' | translate}}</h6>
                                <p>{{ MsAuditPlansStore.individualMsAuditPlansDetails?.sub_section ? MsAuditPlansStore.individualMsAuditPlansDetails?.sub_section?.title: AppStore.noContentText }}</p>
                            </div>
    
                        </div>

                        <div class="row">
                            <div class="col-md-12" *ngIf=" MsAuditPlansStore.individualMsAuditPlansDetails?.department.length "  [ngStyle] = "{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_department ? 'none':'block'}">
                                <h6> {{'department' | translate}}</h6>
                               
                                <p>{{MsAuditPlansStore.individualMsAuditPlansDetails?.department?.length?getArrayFormatedString('title',MsAuditPlansStore.individualMsAuditPlansDetails?.department):AppStore.noContentText}} </p>
                            </div>
                        </div>


                         <div class="row">
                            <div class="col-md-12">
                                <h6 >{{'audit_scope' | translate}}</h6>
                                <p *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.scope" [innerHTML]=" MsAuditPlansStore.individualMsAuditPlansDetails?.scope" style="white-space: pre-wrap;"> 
                                </p>
                                <p *ngIf="!MsAuditPlansStore.individualMsAuditPlansDetails?.scope">{{ AppStore.noContentText}}</p>

                                <h6>{{'audit_objective' | translate}}</h6>
                                <ul class="arrowlist ml-0 pl-0 mt-0 mb-0" *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.objective?.length">
                                    <li
                                        *ngFor="let objetive of MsAuditPlansStore.individualMsAuditPlansDetails?.objective">
                                        {{objetive.title}}
                                        
                                    </li>

                                </ul>
                                <!-- <p *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.objective" [innerHTML]=" MsAuditPlansStore.individualMsAuditPlansDetails?.objective" style="white-space: pre-wrap;"> 
                                </p> -->
                                <p *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.objective?.length==0">{{ AppStore.noContentText}}</p>
                                
                                <h6 class="mt-4">{{'audit_criteria' | translate}}</h6>
                                <!-- <p *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.criteria" [innerHTML]=" MsAuditPlansStore.individualMsAuditPlansDetails?.criteria" style="white-space: pre-wrap;"> 
                                </p> -->
                                <ul class="arrowlist ml-0 pl-0 mt-0 mb-0" *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.criteria?.length">
                                    <li
                                        *ngFor="let criteria of MsAuditPlansStore.individualMsAuditPlansDetails?.criteria">
                                        {{criteria.title}}
                                        
                                    </li>

                                </ul>
                                <p *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.criteria?.length==0">{{ AppStore.noContentText}}</p>
                            </div>

                            <!--<div class="col-md-12">
                            <h6>{{'audit_procedure' | translate}}</h6>

                            <div  *ngIf="ProcessStore?.selectedProcessesList.length>0" class="audit-form-table w-100 not-fixed-table mb-3">
                                <table class="table table-bordered ordinary-table audit-page-table mb-1 table-scroll word-break">
                                    <thead>
                                        <tr>
                                            <th class="border-top-0" width="5%">#</th>
                                            <th class="border-top-0" width="13%">{{'ref_id' | translate}}
                                            </th>
                                            <th class="border-top-0" width="15%">{{'group' |
                                                translate}}</th>
                                            <th class="border-top-0" width="15%">{{'audit_procedure' | translate}}
                                            </th>
                                            <th class="border-top-0" width="21%">{{'process_category' |
                                                translate}}</th>
                                           
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr
                                            *ngFor="let selected of ProcessStore?.selectedProcessesList; let list=index">
                                            <td class="text-center">{{list+1}}</td>
                                            <td>{{selected.reference_code}}</td>
                                            <td>{{selected.process_group_title}}</td>
                                            <td> {{selected.title}}
                                            </td>
                                            <td>
                                                {{selected.process_category_title?selected.process_category_title:AppStore.noContentText}}
                                            </td>
                                            
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div  *ngIf="ProcessStore?.selectedProcessesList.length == 0"  class="mb-3">
                               
                                <app-context-no-data [sourceData] = "getNoDataSource('center')"></app-context-no-data>
                            </div>
                            </div>-->
                        </div> 
                    </div>


                    
                    </div>
                    <div class="row">
                        <div class="col-xl-12">
                            <hr class="mb-2">
                            <ng-container *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.created_by.first_name">
                                <app-user-popup-box
                                    [source]=" getEmployeePopupDetails( MsAuditPlansStore.individualMsAuditPlansDetails?.created_by, MsAuditPlansStore.individualMsAuditPlansDetails?.created_at )">
                                </app-user-popup-box>
                            </ng-container>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3 col-lg-3">

                </div>
            </div>
            <div class="col-sm-12 col-lg-4">



                <div class="bg-white p-3 mb-3">
                    <h6 class="text-left">{{'audit_leader' | translate}}</h6>
                    <hr class="mt-0 mb-3">
                    <div *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.lead_auditor" class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg p-0">
                        <app-user-popup-box [source]="getEmployeePopupDetails(MsAuditPlansStore.individualMsAuditPlansDetails?.lead_auditor)"></app-user-popup-box>
                    </div>

                </div>

                <div class="bg-white p-3 mb-3 edit-option">
                    <!-- <div class="edit-option-show-inner" style="margin: -3px 0 0 0;">
                        <a href="#"><i class="fas fa-plus"></i></a>
                    </div> -->
                    <h6 class="text-left">{{'auditor' | translate}}</h6>
                    <hr class="mt-0 mb-3">
                    <ul class="arci-user-tab-dtl workflow-lst-pics-loop clearfix">
                        <li class="rounde-hov-bg" *ngFor="let users of MsAuditPlansStore.individualMsAuditPlansDetails?.auditors;let i=index">
                            <app-user-popup-box [showName]="false"
                               [source]="getEmployeePopupDetails(users)">
                            </app-user-popup-box>
                         </li>
                        <div
                            *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.auditors.length==0">
                            {{ AppStore.noContentText }}
                        </div>
                    </ul>
                </div>

                <!-- <div class="bg-white p-3 mb-3">
                    <h6 class="text-left">{{'auditee_leader' | translate}}</h6>
                    <hr class="mt-0 mb-3">
                    <div *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.lead_auditee" class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg p-0">
                        <app-user-popup-box [source]="getEmployeePopupDetails(MsAuditPlansStore.individualMsAuditPlansDetails?.lead_auditee)"></app-user-popup-box>
                    </div>

                </div> -->

                <!-- <div class="bg-white p-3 mb-3 edit-option">
                   
                    <h6 class="text-left">{{'auditees' | translate}}</h6>
                    <hr class="mt-0 mb-3">
                    <ul class="arci-user-tab-dtl workflow-lst-pics-loop clearfix">
                        <ng-container
                            *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.auditees.length>0">
                            <div
                                *ngFor="let users of MsAuditPlansStore.individualMsAuditPlansDetails?.auditees;let i=index">
                                <li class="rounde-hov-bg">
                                    <app-user-popup-box [source]="getEmployeePopupDetails(users)"
                                        [showName]="false"></app-user-popup-box>
                                </li>
                            </div>
                        </ng-container>
                        <div
                            *ngIf="MsAuditPlansStore.individualMsAuditPlansDetails?.auditees.length==0">
                            {{ AppStore.noContentText }}
                        </div>
                    </ul>

                </div> -->




            </div>

        </div>
    </div>
</div>


<!-- Form Modal -->
<div class="modal modal-style-1 popup-full-width fade" data-keyboard="false" data-backdrop="static" *mobxAutorun #formModal>
    <app-ms-audit-plans-add *ngIf = "MsAuditPlansObject.type" [source]="MsAuditPlansObject"></app-ms-audit-plans-add> 
</div>

<!-- Delete Confirmation Modal Start --->
<div class="modal modal-style-1 fade" id="delete-popup" #confirmationPopUp data-backdrop="static" data-keyboard="false">
    <app-delete-popup [source]="popupObject"></app-delete-popup>
</div>

<ng-container>
    <div class="modal modal-style-1 popup-full-width fade" data-keyboard="false" data-backdrop="static" #commentModal>
      <app-ms-audit-plan-workflow-comment *ngIf="AuditPlanWorkflowStore.commentForm">
      </app-ms-audit-plan-workflow-comment>
    </div>
  </ng-container>
  
  <div class="modal modal-style-1 popup-full-width fade" id="process-popup" data-keyboard="false" data-backdrop="static"
#workflowHistory *mobxAutorun>
<app-ms-audit-plan-workflow-history *ngIf="workflowHistoryOpened == true"></app-ms-audit-plan-workflow-history>
</div>

<div class="modal modal-style-1 popup-full-width fade" id="process-popup" data-keyboard="false" data-backdrop="static"
#workflowModal *mobxAutorun>
<app-audit-plan-workflow-popup *ngIf="workflowModalOpened == true"></app-audit-plan-workflow-popup>
</div>

<!--Activity Logs model -->
<div class="modal modal-style-1 popup-full-width fade" *mobxAutorun #activityLogsModal>
    <app-audit-plan-activity-log *ngIf="MsAuditPlansStore.activity_log_form_modal" ></app-audit-plan-activity-log>
</div>