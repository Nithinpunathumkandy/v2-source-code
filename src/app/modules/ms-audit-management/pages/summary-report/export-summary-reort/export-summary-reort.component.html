<nav class="edit-bar" data-toggle="affix" #navBar>
    <app-sub-menu>-</app-sub-menu>
    <div class="module-name-block module-name-block-space float-left">
        <a class="dropdown module-title">{{'Audit Report Summary'|translate}}</a>
    </div>
   
</nav>
<ng-container >
<table  class="wrapper" width="100%" cellpadding="0" cellspacing="0" role="presentation" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; margin: 0 auto; padding: 0; width: 1000px; margin: 0 auto; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 100%;">
    <tbody id="report"><tr style="vertical-align: top;">
        <td align="center" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box;">
            <table class="content" width="100%" cellpadding="0" cellspacing="0" role="presentation" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; margin: 0; padding: 0; width: 100%; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 100%;">
                
            </table>

            <table style="width: 1000px; min-height: 550px; margin: 20px 0; background: #fff;">
                <tr style="vertical-align: middle;">
                <td style="vertical-align: left; padding:30px; text-align:left;">
            
            
                        <table style="width: 100%; height: 500px; background: #ffedd1; background-size: 100% 100%;">
                            <tr style="vertical-align: top;">
                                <td style="text-align: left; padding: 20px;">
                                    <img src="assets/images/iso-logo.png" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; width: 150px; padding: 5px;">
                                </td>
                                <td style="text-align: right; padding: 20px;">
                                    <img src="http://172.105.61.65/isorobotv2-html/images/login-logo.png" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; width: 146px;">
                                </td>
                            </tr>
            
                            <tr style="vertical-align: bottom;">
                                <td colspan="2" style="padding: 20px;">
                                    <p style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; color: #33475b; font-size: 30px; line-height: 1.5em; margin-top: 0px; text-align: left; margin-bottom: 4px;"><span style="font-weight: bold;">Audit Program Annual Summary Report </span></p>
            

                                    <div style="border-top: 1px solid #8a1538; padding-top: 10px;">
                                        <p style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; color: #000; font-size: 15px; line-height: 1.2em; margin-top: 0px; text-align: left; margin-bottom: 2px; font-weight: bold;">{{AuditProgramSummaryReportStore.IndividualMsAuditPrgramsReportDetails?.created_by?.first_name}} {{AuditProgramSummaryReportStore.IndividualMsAuditPrgramsReportDetails?.created_by?.last_name}} </p>
                                        <p style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; color: #000; font-size: 13px; line-height: 1.2em; margin-top: 0px; text-align: left; margin-bottom: 0px; font-weight: normal;">{{AuditProgramSummaryReportStore.IndividualMsAuditPrgramsReportDetails?.created_by?.designation}} | Published at {{AuditProgramSummaryReportStore.IndividualMsAuditPrgramsReportDetails?.created_at | date: OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
                                    </div>
            
            
            
                                </td>
                            </tr>
                        </table>
             
                </td>
            </tr>
            </table>
            
            <div  style="width: 1000px; min-height: 600px; padding: 30px; margin: 20px 0; background: #fff; text-align: left;">
                <div >
                    <h4 style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; color: #33475b; font-size: 20px; line-height: 1.5em; margin-top: 0px; text-align: left; margin-bottom: 2px; font-weight: bold;">{{AuditProgramSummaryReportStore.IndividualMsAuditPrgramsReportDetails?.executive_summary?.title}}</h4>
                    <p style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; color: #506e91; font-size: 14px; line-height: 1.5em; text-align: left; margin-bottom: 13px; margin-top: 0px;">{{AuditProgramSummaryReportStore.IndividualMsAuditPrgramsReportDetails?.executive_summary ? AuditProgramSummaryReportStore.IndividualMsAuditPrgramsReportDetails?.executive_summary?.description : 'NA'}}</p>
                </div>
              
                <div *ngFor="let program of AuditProgramSummaryReportStore.IndividualMsAuditPrgramsReportDetails?.ms_audit_annual_summary_report_content ;let mIndex = index" style="margin-left: 20px;">
                    <h4 style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; color: #33475b; font-size: 20px; line-height: 1.5em; margin-top: 0px; text-align: left; margin-bottom: 2px; font-weight: bold;">{{program?.title}}</h4>
                    <div *ngFor="let childrenContent of program?.details;let childrenNum=index">
                        <h4 style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; color: #33475b; font-size: 17px; line-height: 1.5em; margin-top: 0px; text-align: left; margin-bottom: 2px; font-weight: bold;">{{childrenNum+1}}.{{childrenContent?.title}}</h4>
                        <p style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; box-sizing: border-box; color: #506e91; font-size: 14px; line-height: 1.5em; text-align: left; margin-bottom: 13px; margin-top: 0px;">{{childrenContent?.description}}</p>
                        <div class="db-md-screen-center" style="min-height: 335px;" *ngIf="childrenContent?.type =='internal-imsarnbd' && childrenContent?.graph?.length > 0">
                            <div id="ibarChart1" style="width: 100%; height: 325px"></div>
                        </div>
                        <div class="db-md-screen-center" style="min-height: 335px;" *ngIf="childrenContent?.type == 'external-earncbd' && childrenContent?.graph?.length > 0">
                           <div id="ibarChart2" style="width: 100%; height: 325px"></div>
                       </div>
                       <div class="db-md-screen-center" style="min-height: 335px;" *ngIf="childrenContent?.type == 'nonconformity-csbd' && childrenContent?.graph?.length > 0">
                        <div id="ibarChart3" style="width: 100%; height: 325px"></div>
                    </div>
                       <div class="db-md-screen-center" style="min-height: 260px;" *ngIf="childrenContent?.type == 'internal-imsarnbd' && childrenContent?.graph?.length == 0">
                        <app-no-chart-data [source]="'bar'">
                        </app-no-chart-data>
                    </div>
                    <div class="db-md-screen-center" style="min-height: 260px;" *ngIf="childrenContent?.type == 'external-earncbd' && childrenContent?.graph?.length == 0">
                       <app-no-chart-data [source]="'bar'">
                       </app-no-chart-data>
                   </div>
                   <div class="db-md-screen-center" style="min-height: 260px;" *ngIf="childrenContent?.type == 'nonconformity-csbd' && childrenContent?.graph?.length == 0">
                    <app-no-chart-data [source]="'bar'">
                    </app-no-chart-data>
                </div>
                    </div>
                    
                </div>
            
            
            </div> 


</td>
</tr>
</tbody>
</table>
</ng-container>


<!-- loader popup -->
<div class="modal modal-style-1 image-download-popup-new fade" id="loadMe" aria-labelledby="loadMeLabel" tabindex="-1" role="dialog" #loaderPopUp>
    <app-loader [source] = "downloadMessage"></app-loader>
 </div>