<nav class="edit-bar" data-toggle="affix" scrollPoint #navigationBar *mobxAutorun>
   <app-breadcrumb-menu></app-breadcrumb-menu>
   <div class="module-name-block module-name-block-space float-left">
      <a class="dropdown module-title">{{'dashboard'|translate}}</a>
   </div>
</nav>

<main class="mt-3 acl-page db-small-space-boxes db-layout-150">
   <div class="container-fluid" *mobxAutorun>
      <div class="widget" *ngIf="NonConformityDashboardStore.dashboardLoaded">
         <div class="row sm-row">
            <div class="col-xl-5 col-lg-12 col-sm-12 sm-col"
               *ngIf="OrganizationModulesStore.checkIndividualSubModule(3500,61401)">
               <div class="bg-white btm-space-10 ceo-db-first-box-one db-shadow ">
                  <div class="row align-items-center">
                     <div class="col-md-5 border-right">
                        <div class="text-center pointer"
                           (click)="redirectToPage('all',NonConformityDashboardStore.FindingCount?.total_finding)">
                           <h3 class="big-text-four">{{NonConformityDashboardStore.FindingCount?.total_finding}}</h3>
                           <h5 class="mb-0 elips-2 pl-2">{{ 'non_conformity/findings' | translate }}</h5>
                        </div>
                     </div>
                     <div class="col-md-7 text-center">
                        <div class="clearfix round-type-status-main-bg">
                           <div class="round-type-status-main">
                              <div class="open-close-status-db d-flex align-items-center status-open">
                                 <div class="round-type-status-value">
                                    <h6 class="mb-0">
                                       {{NonConformityDashboardStore.FindingCount?.open_finding_percentage}}%</h6>
                                 </div>
                                 <div
                                    [ngClass]="NonConformityDashboardStore.FindingCount?.total_open_finding!=0?'round-type-status-bg bg-white rounded-circle pointer':'round-type-status-bg bg-white rounded-circle'"
                                    (click)="redirectToPage('open',NonConformityDashboardStore.FindingCount?.total_open_finding)">
                                    <div class="round-type-status rounded-circle">
                                       <h6 class="mb-0">{{NonConformityDashboardStore.FindingCount?.total_open_finding}}
                                       </h6>
                                       <h5>{{ 'open' | translate }}</h5>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="round-type-status-main">
                              <div
                                 class="open-close-status-db open-close-status-db-right d-flex align-items-center status-closed">
                                 <div
                                    [ngClass]="NonConformityDashboardStore.FindingCount?.total_closed_finding!=0?'round-type-status-bg bg-white rounded-circle pointer':'round-type-status-bg bg-white rounded-circle'"
                                    (click)="redirectToPage('closed',NonConformityDashboardStore.FindingCount?.total_closed_finding)">
                                    <div class="round-type-status rounded-circle">
                                       <h6 class="mb-0">
                                          {{NonConformityDashboardStore.FindingCount?.total_closed_finding}}</h6>
                                       <h5>{{ 'closed' | translate }}</h5>

                                    </div>
                                 </div>
                                 <div class="round-type-status-value">
                                    <h6 class="mb-0">
                                       {{NonConformityDashboardStore.FindingCount?.closed_finding_percentage}}%</h6>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <div class="col-xl-7 col-lg-12 col-sm-12 sm-col">
               <div class="clearfix">
                  <div class="bg-white btm-space-10 ceo-db-small-box-one db-shadow"
                     *ngFor="let row of NonConformityDashboardStore.riskRating">
                     <div class="left-line-type-text">
                        <!-- [ngClass]=" row.color_code ? 'big-line-bdr-left bg-' + row.color_code : 'big-line-bdr-left'" -->
                        <!-- <span 
                         class="big-line-bdr-left"
                         [ngStyle]="{ background: row.color_code }"></span> -->
                        <h3 class="big-text-one mb-0">{{row.count}}</h3>
                        <!-- <h5>{{row.risk_ratings}}</h5> -->
                        <p [attr.class]="'dot-div-new mb-0 dot-'+row.label">{{row.risk_ratings}}</p>
                     </div>
                  </div>
                  <!-- <div class="bg-white btm-space-10 ceo-db-small-box-one db-shadow">
                      <div class="left-line-type-text">
                         <span class="big-line-bdr-left bg-orange"></span>
                         <h5>Significant</h5>
                         <h6>58</h6>
                      </div>
                   </div>
                   <div class="bg-white btm-space-10 ceo-db-small-box-one db-shadow">
                      <div class="left-line-type-text">
                         <span class="big-line-bdr-left bg-yellow"></span>
                         <h5>High</h5>
                         <h6>30</h6>
                      </div>
                   </div>
                   <div class="bg-white btm-space-10 ceo-db-small-box-one db-shadow">
                      <div class="left-line-type-text">
                         <span class="big-line-bdr-left bg-light-green"></span>
                         <h5>Moderate</h5>
                         <h6>20</h6>
                      </div>
                   </div>
                   <div class="bg-white btm-space-10 ceo-db-small-box-one db-shadow ceo-db-full-width-box">
                      <div class="left-line-type-text">
                         <span class="big-line-bdr-left bg-green"></span>
                         <h5>Low</h5>
                         <h6>20</h6>
                      </div>
                   </div> -->
               </div>
            </div>
         </div>

         <div class="row sm-row" *ngIf="OrganizationModulesStore.checkIndividualSubModule(3500,61401)">
            <div class="col-sm-12 sm-col">
               <div class="bg-white widg-padding-cmn btm-space-10 tab-with-text-db">
                  <div class="row widget-heading line-tab">
                     <div class="col-lg-6 col-md-12">
                        <h5 class="cmn-head-style m-0">{{ 'non_conformity/findings' | translate }}</h5>
                     </div>
                     <div class="col-lg-6 col-md-12">
                        <ul class="nav nav-tabs float-right">
                           <li class="nav-item"> <a (click)="createLineChart(1)" class="nav-link active show"
                                 data-toggle="tab" href="#risk-heat-map-one" data-original-title="" title="">{{
                                 'by_department' | translate }}</a> </li>
                           <li class="nav-item"> <a (click)="createLineChart(2)" class="nav-link" data-toggle="tab"
                                 href="#risk-heat-map-two" data-original-title="" title="">{{ 'by_year' | translate
                                 }}</a> </li>
                        </ul>
                     </div>
                  </div>
                  <div class="tab-content tab-content-body pt-3">
                     <div class="tab-pane active show" id="risk-heat-map-one">
                        <div class="dpt-pic-ceo w-100" style="min-height: 230px;">
                           <div id="lineChartDepartment" style="width: 100%;height: 230px;"></div>
                        </div>
                     </div>
                     <div class="tab-pane fade" id="risk-heat-map-two">
                        <div class="tab-pane active show" id="risk-heat-map-one">
                           <div class="dpt-pic-ceo w-100" style="min-height: 230px;">
                              <div id="lineChartYears" style="width: 100%;height: 230px;"></div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>

         <div class="row sm-row">
            <div class="col-lg-6 col-sm-12 sm-col">
               <div class="bg-white widg-padding-cmn btm-space-10 ceo-db-five relative db-shadow">
                  <h5 class="cmn-head-style">{{ 'finding_category' | translate }} </h5>
                  <hr>
                  <div class="dpt-pic-ceo w-100" *ngIf="!showCategoryPieNoData">
                     <div id="chartfindingCategory" style="width: 100%; height: 250px" #findingCategoryPieChartDiv>
                     </div>
                  </div>
                  <div class="dpt-pic-ceo w-100" *ngIf="showCategoryPieNoData" style="min-height: 250px;">
                     <app-no-chart-data [source]="findingCategoryPieChart">
                     </app-no-chart-data>
                  </div>
               </div>
            </div>

            <div class="col-lg-6 col-sm-12 sm-col">
               <div class="bg-white widg-padding-cmn btm-space-10 ceo-db-five relative db-shadow">
                  <h5 class="cmn-head-style">{{ 'action_plans' | translate }} </h5>
                  <hr>
                  <div class="dpt-pic-ceo w-100" *ngIf="!showActionPlanPieNoData">
                     <div id="chartfindingActionPlan" style="width: 100%; height: 250px"></div>
                  </div>
                  <div class="dpt-pic-ceo w-100" *ngIf="showActionPlanPieNoData" style="min-height: 250px;">
                     <app-no-chart-data [source]="actionPlanPieChart">
                     </app-no-chart-data>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <ng-container *mobxAutorun>
         <div *ngIf="!NonConformityDashboardStore.dashboardLoaded">
            <app-dashboard-loader></app-dashboard-loader>
         </div>
      </ng-container>
   </div>
</main>