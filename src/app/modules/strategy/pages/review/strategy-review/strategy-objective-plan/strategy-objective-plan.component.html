<div class="tab-pane tab-edit-class assessment-tab-user" id="top-tab-left-two">

   <app-strategy-review-plan-loader  *ngIf="!StrategyInitiativeStore.loaded"></app-strategy-review-plan-loader>
    <div class="row" *ngIf="StrategyInitiativeStore.loaded">
       <div class="col-sm-12">
           <div class="panel-group panel-drop-sections pt-0" id="jd" role="tablist" aria-multiselectable="true">
               <div class="panel panel-default" *ngFor="let data of StrategyInitiativeStore.allItems| paginate: {currentPage:StrategyInitiativeStore.currentPage, itemsPerPage:StrategyInitiativeStore.itemsPerPage,totalItems:StrategyInitiativeStore.totalItems};let mIndex = index">
                   <div [ngClass]="selectedIndex == mIndex ? 'panel-heading active' : 'panel-heading'" role="tab" id="headingOne">
                       <div class="panel-title relative" >
                           <a role="button"  aria-expanded="false" aria-controls="collapseOne" class="collapsed" (click)="selectedIndexChange(mIndex,data)">
                               <h5 class="width96pc mt-0" style="padding-right: 140px;"> {{data.title}} <span class="draft-tag label-tag-style-tag label-left-arow-tag d-inline-block status-tag-new-one ml-3">{{data.status_title}}</span> <span class="drop-down-icone"><i class="fas fa-chevron-down"></i></span> </h5>
                           </a>
                           <span class="accordion-score-right">{{'score' | translate}}: <span class="text-light-blue bold" style="font-size: 18px;">{{data.score ? data.score : '0' }}%</span></span>
                       </div>
                   </div>
                   <div [ngClass]="selectedIndex == mIndex ? 'drop-detail-sec panel-collapse collapse show' : 'drop-detail-sec panel-collapse collapse'" role="tabpanel" aria-labelledby="headingOne" >
                       <div class="panel-body bg-white">

                         <!-- <div class="processes-issue clearfix d-flex align-items-center mb-3">
                            <h5 class="w-100"><img src="images/issue-processes.png">Lorem Ipsum is a dummy text</h5>
                            <div style="width: 100px;">
                               <a href="#" data-toggle="modal" data-target="#action-popup1" class="btn btn-small">Action</a>
                            </div>
                        </div> -->

                        <div class="row">
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'focus_area' | translate}}</h6>
                            <p>{{StrategyInitiativeStore.induvalInitiative?.strategy_profile_focus_area ? StrategyInitiativeStore.induvalInitiative?.strategy_profile_focus_area?.focus_area?.title : AppStore.noContentText }}</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'objectives' | translate}}</h6>
                            <p>{{StrategyInitiativeStore.induvalInitiative?.strategy_profile_objective ? StrategyInitiativeStore.induvalInitiative?.strategy_profile_objective?.objective?.title : AppStore.noContentText }}</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'target' | translate}}</h6>
                            <p>{{StrategyInitiativeStore.induvalInitiative?.target ? StrategyInitiativeStore.induvalInitiative?.target : AppStore.noContentText }}</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'sm_achieved_target' | translate}}</h6>
                            <p>3 Units</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'sm_total_cost' | translate}}</h6>
                            <p>{{OrganizationGeneralSettingsStore?.organizationSettings?.currency}} {{StrategyInitiativeStore.induvalInitiative?.budget}}</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'start_date' | translate}}</h6>
                            <p>{{StrategyInitiativeStore.induvalInitiative?.start_date | date:
                              OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'target_date' | translate}}</h6>
                            <p>{{StrategyInitiativeStore.induvalInitiative?.end_date | date:
                              OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'sm_actual_end_date' | translate}}</h6>
                            <p>{{StrategyInitiativeStore.induvalInitiative?.actual_end_date | date:
                              OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6">
                            <h6>{{'review_frequency' | translate}}</h6>
                            <p>{{StrategyInitiativeStore.induvalInitiative?.strategy_review_frequency ? StrategyInitiativeStore.induvalInitiative?.strategy_review_frequency?.strategy_kpi_data_type_language[0].pivot.title : AppStore.noContentText }}</p>
                         </div>
                         <div class="col-xl-2 col-lg-3 col-sm-6" *ngIf="StrategyInitiativeStore.induvalInitiative?.responsible_users.length == 1">
                            <div class="label-and-user-pic">
                               <h6>{{'responsible_users' | translate}}</h6>
                               <div class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg">
                                 <app-user-popup-box
                                 [source]="getPopupDetails(StrategyInitiativeStore.induvalInitiative?.responsible_users[0])"
                                 [showName]="true"
                                 [activateButtons]="false">
                             </app-user-popup-box>

                                   <!-- user-dtl-popup start -->
                                 
                                    <!-- user-dtl-popup end --> 
                               </div>
                           </div>
                         </div>
                         <!-- <div class="col-xl-2 col-lg-3 col-sm-6">
                            <div class="label-and-user-pic">
                               <h6>Review User</h6>
                               <div class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg">
                                   <img src="images/round-5.png" data-toggle="modal" data-target="#user301" data-ui-class="a-zoom" class="rounded-circle rounde-hov details-show-popup" width="35px" height="35px">
                                   
                                   <div class="pointer new-size-text">
                                       <h6>Carlos Philip </h6>
                                       <span>Admin</span>
                                   </div>

                                   
                               </div>
                           </div>
                         </div> -->
                        </div>
                        <h6 *ngIf="StrategyInitiativeStore.induvalInitiative?.responsible_users.length > 1">{{'responsible_users' | translate}}</h6>
                        <div class="row" *ngIf="StrategyInitiativeStore.induvalInitiative?.responsible_users.length > 1">
                           <div class="col-xl-2 col-lg-3 col-sm-6" *ngFor=" let user of StrategyInitiativeStore.induvalInitiative?.responsible_users" >
                              <div class="label-and-user-pic">
                                 <div class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg">
                                    <app-user-popup-box
                                    [source]="getPopupDetails(user)"
                                    [showName]="true"
                                    [activateButtons]="false">
                                </app-user-popup-box>
  
                                     <!-- user-dtl-popup start -->
                                   
                                      <!-- user-dtl-popup end --> 
                                 </div>
                             </div>
                           </div>
                        </div>

                           <h6>{{'sm_kpi_measures' | translate}}</h6>
                           <div class="audit-form-table w-100 table-align-top not-fixed-table mb-3">
                               <table *ngIf="StrategyInitiativeStore.induvalInitiative?.kpis.length > 0" class="table table-bordered ordinary-table audit-page-table mb-3 table-scroll">
                                 <thead>
                                    <tr>
                                       <th class="border-top-0 text-center" width="4%">#</th>
                                       <!-- <th class="border-top-0" width="10%">Ref ID</th> -->
                                       <th class="border-top-0" width="46%">KPI</th>
                                       <th class="border-top-0" width="10%">{{'minimum_value' | translate}}</th>
                                       <th class="border-top-0" width="10%">{{'maximum_value' | translate}}</th>
                                       <th class="border-top-0" width="10%">{{'target' | translate}}</th>
                                       <th class="border-top-0" width="10%">{{'sm_achieved_target' | translate}}</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                  <tr *ngFor="let k of StrategyInitiativeStore.induvalInitiative?.kpis;let num = index" >
                                     <!-- <td class="text-center">1</td> -->
                                     <td>{{num+1}}</td>
                                     <td>{{k.kpi?.title}}</td>
                                     <td>{{k.minimum}}</td>
                                     <td>{{k.maximum}}</td>
                                     <td>{{k.target ? k.target : 'NA'}}</td>
                                     <td>{{k.target_unit_id ? k.target_unit_id : 'NA'}}
                                        <!-- <div class="edit-option-show-inner">
                                          <a data-toggle="modal" data-target="#kpi-measures-edit-popup"><i class="fas fa-pen"></i></a>
                                           <a data-toggle="modal" data-target="#kpi-measures-history-popup"><i class="fas fa-history"></i></a>
                                        </div> -->
                                     </td>
                                  </tr>
                                  
                                 </tbody>
                              </table>

                            </div>

                            <h6 *ngIf="StrategyInitiativeStore.milesstones.length > 0">{{'sm_milestones' | translate}}</h6>
                            <div class="common-tab-md clearfix" *ngIf="StrategyInitiativeStore.milesstones.length > 0">
                                <div class="tab-common-left-md">
                                  <div class=" issues-tab active-right-border-none"><!-- tab menu start -->
                                    <ul class="nav nav-tabs nav-tabs--vertical nav-tabs--left vertical-tab" role="navigation">
                                      <li class="nav-item" (click)="selectedItem(mIndex,milestone.id)" *ngFor="let milestone of StrategyInitiativeStore.milesstones;let mIndex = index"> 
                                         <a [ngClass]="selectedNote == mIndex ? 'nav-link text-left active show' : 'nav-link text-left'"data-toggle="tab" role="tab" aria-controls="lorem" aria-selected="true">{{milestone.title}}</a>
                                      </li>
                                    </ul>
                                  </div><!-- tab menu end -->
                                </div>

                               <div *ngIf="StrategyInitiativeStore.milesstones.length > 0" class="tab-common-left-content-m bg-white cmn-bdr widg-padding-cmn min-height-590">
                                  <div class="tab-content">
                                     <div *ngFor="let milestone of StrategyInitiativeStore.milesstones;let mIndex = index"
                                     [ngClass]="selectedNote == mIndex ? 'tab-pane fade active show' : 'tab-pane fade'" id="review" role="tabpanel"
                                     class="edit-and-delete-main">
                                     <div *ngIf="milestone.strategy_initiative_milestone_action_plans.length > 0"  class="edit-option-show" style="margin: 20px -15px 0 0;"><!-- edit-and-delete starts -->
                                       <a data-toggle="modal" *ngIf="AuthStore.getActivityPermission(3200, 'UPDATE_STRATEGY_INITIATIVE_REVIEW')" (click)="openAllPlanMesureModal(milestone)"><i class="fas fa-pen"></i></a>
                                       <a data-toggle="modal" (click)="openAllPlanMesureHistoryModal(milestone)"><i class="fas fa-history"></i></a>
                                     </div>
                                        <h6>{{'description' | translate}}</h6>
                                        <p style="white-space: pre-wrap;">{{milestone.description ? milestone.description : AppStore.noContentText}}</p>

                                        <div class="row">
                                           <div class="col-xl-3 col-lg-4 col-sm-4">
                                              <p class="text-yellow">{{'score' | translate}}: {{milestone.score}}%</p>
                                           </div>
                                           <div class="col-xl-3 col-lg-4 col-sm-4">
                                              <p class="text-red"> {{'sm_total_budget' | translate}} :{{OrganizationGeneralSettingsStore?.organizationSettings?.currency}} {{milestone.budget}}</p>
                                           </div>
                                           <div class="col-xl-3 col-lg-4 col-sm-4">
                                              <p class="text-green">{{'sm_total_cost' | translate}} : {{OrganizationGeneralSettingsStore?.organizationSettings?.currency}} {{StrategyInitiativeStore.induvalInitiative?.budget}}</p>
                                           </div>
                                        </div>

                                        <div class="row">
                                           <div class="col-xl-3 col-lg-4 col-sm-6">
                                              <h6>{{'sm_total_cost' | translate}}</h6>
                                              <p>{{OrganizationGeneralSettingsStore?.organizationSettings?.currency}} {{StrategyInitiativeStore.induvalInitiative?.budget}}</p>
                                           </div>
                                           <div class="col-xl-3 col-lg-4 col-sm-6">
                                              <h6>{{'start_date' | translate}}</h6>
                                              <p>{{milestone.start_date | date:
                                                OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
                                           </div>
                                           <div class="col-xl-3 col-lg-4 col-sm-6">
                                              <h6>{{'end_date' | translate}}</h6>
                                              <p>{{milestone.end_date | date:
                                                OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
                                           </div>
                                           <div class="col-xl-3 col-lg-4 col-sm-6">
                                              <h6>{{'sm_actual_end_date' | translate}}</h6>
                                              <p>Nov 27, 2020</p>
                                           </div>
                                           <!-- <div class="col-xl-3 col-lg-4 col-sm-6">
                                              <div class="label-and-user-pic">
                                                 <h6>Responsible User</h6>
                                                 <div class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg">
                                                     <img src="images/round-8.png" data-toggle="modal" data-target="#user301" data-ui-class="a-zoom" class="rounded-circle rounde-hov details-show-popup" width="35px" height="35px">
                                                     
                                                     <div class="pointer new-size-text">
                                                         <h6>Manual Thomas </h6>
                                                         <span>Team Lead</span>
                                                     </div>

                                                   
                                                 </div>
                                             </div>
                                           </div> -->
                                        </div>

                                        <h6>{{'action_plans' | translate}}</h6>
                                        <div *ngIf="milestone.strategy_initiative_milestone_action_plans.length > 0" class="audit-form-table w-100 table-align-top not-fixed-table mb-0">
                                           <table class="table table-bordered ordinary-table audit-page-table mb-3 table-scroll">
                                             <thead>
                                                <tr>
                                                   <th class="border-top-0 text-center" width="4%">#</th>
                                                   <th class="border-top-0" width="51%">{{'title' | translate}}</th>
                                                   <th class="border-top-0" width="15%">{{'sm_achieved_value' | translate}}</th>
                                                   <th class="border-top-0" width="15%">{{'sm_actual_end_date' | translate}}</th>
                                                   <th class="border-top-0" width="15%">{{'sm_cost' | translate}}</th>
                                                </tr>
                                             </thead>
                                             <tbody>
                                              <tr class="edit-option" *ngFor="let plan of milestone.strategy_initiative_milestone_action_plans;let num = index">
                                                 <td class="text-center">{{num+1}}</td>
                                                 <td>{{plan.title}}</td>
                                                 <td>{{plan.actual_value ? plan.actual_value : "NA"}}</td>
                                                 <td>{{plan.actual_end_date ? (plan.actual_end_date | date:OrganizationGeneralSettingsStore.organizationSettings?.date_format) : "NA"}}</td>
                                                 <td>{{plan.cost ? OrganizationGeneralSettingsStore?.organizationSettings?.currency : ''}} {{plan.cost ? plan.cost : 'NA'}}
                                                   <div class="edit-option-show-inner">
                                                      <a data-toggle="modal" *ngIf="AuthStore.getActivityPermission(3200, 'UPDATE_STRATEGY_INITIATIVE_REVIEW')" (click)="openPlanMesureModal(plan,milestone)"><i class="fas fa-pen"></i></a>
                                                       <a data-toggle="modal" (click)="openplanMesureHistoryModal(plan)"><i class="fas fa-history"></i></a>
                                                    </div>
                                                 </td>
                                              </tr>
                                            
                                             </tbody>
                                          </table>

                                        </div>



                                     </div>
                                  
                                  </div>
                               </div>
                                  
                            </div>


                       </div>
                   </div>
               </div>
           
               <div *ngIf="StrategyInitiativeStore.totalItems > StrategyInitiativeStore.itemsPerPage"
                  class="col-sm-12">
                  <ul class="pagination justify-content-center mt-3">
                      <div class="list">
                          <pagination-controls [previousLabel]="'previous' | translate" [nextLabel]="'next' | translate"  class="my-pagination" (pageChange)="pageChange($event)">
                          </pagination-controls>
                      </div>
                  </ul>
              </div>
           </div>
       </div>
    </div>
 </div>

 <div class="modal modal-style-1 popup-full-width fade" id="add-new-notes-popup" data-keyboard="false"
 data-backdrop="static" #planMesure>
 <app-add-plans-measure *ngIf="planMesureObject.type" [source]="planMesureObject" ></app-add-plans-measure>
</div>

<div class="modal modal-style-1 popup-full-width fade" id="add-new-notes-popup" data-keyboard="false"
data-backdrop="static" #planMesureHistory>
<app-plan-measure-history *ngIf="planMesureHistoryObject.type" [source]="planMesureHistoryObject"></app-plan-measure-history>
</div>

<div class="modal modal-style-1 popup-full-width fade" id="add-new-notes-popup" data-keyboard="false"
data-backdrop="static" #allPlanMesure>
<app-action-plan-measures-main-edit *ngIf="allPlanMesureObject.type" [source]="allPlanMesureObject"></app-action-plan-measures-main-edit>
</div>

<div class="modal modal-style-1 popup-full-width fade" id="add-new-notes-popup" data-keyboard="false"
data-backdrop="static" #allPlanMesureHistory>
<app-review-plan-measure-main-history *ngIf="allPlanMesureObjectHistory.type" [source]="allPlanMesureObjectHistory"></app-review-plan-measure-main-history>
</div>