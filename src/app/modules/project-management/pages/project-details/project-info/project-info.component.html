<div class="tab-pane tab-edit-class smoal-left-tab-page active" id="project-tab-two" *mobxAutorun>
    <div class="row">
        <div class="col-lg-9 col-sm-12">
            <div class="bg-white widg-padding-cmn min-height-83">
                <div class="d-flex align-items-center title-logo-main mb-3">
                    <div class="rounded-circle" style="width: 40px; height: 40px;">
                        <img onerror="this.src='/assets/images/no-image.png'"
                            [src]="createImagePreview('project-logo', ProjectDetailStore?.getsubProjectDetails?.image_token)"
                            class="img-fluid mr-0">
                    </div>
                    <div class="pointer round-logo-right-box pl-2">
                        <h5 class="d-inline-block cmn-head-style mr-2"><span
                                class="issue-smoal-head-text">#{{ProjectDetailStore?.getsubProjectDetails?.id}}</span>
                            {{ProjectDetailStore?.getsubProjectDetails?.title}}<span
                                class="draft-tag label-tag-style-tag label-left-arow-tag"
                                [ngClass]="ProjectDetailStore?.getsubProjectDetails?.project_status?.icon_class"
                                style="line-height: 16px; vertical-align: middle; margin-top: -5px;">
                                {{ProjectDetailStore?.getsubProjectDetails?.project_status?.language[0]?.pivot?.title}}</span>
                        </h5>
                        <p class="mb-0"><i class="fas fa-calendar-alt date-pics-two"></i>
                            {{ProjectDetailStore?.getsubProjectDetails?.start_date | date:'mediumDate'}} -
                            {{ProjectDetailStore?.getsubProjectDetails?.target_date | date:'mediumDate'}}
                            <span class="text-red">( {{diffDays(ProjectDetailStore?.getsubProjectDetails?.target_date)
                                }} {{diffDays(ProjectDetailStore?.getsubProjectDetails?.target_date)>=0?' Days
                                Remaining' : ' Days Due'}} )</span>
                        </p>
                    </div>
                </div>
                <p [innerHTML]="ProjectDetailStore?.getsubProjectDetails?.description"></p>

                <div class="row">
                    <div class="col-lg-4 col-sm-6">
                        <h6>{{'category'| translate}}</h6>
                        <p>{{ProjectDetailStore?.getsubProjectDetails?.project_category?.title ||
                            AppStore.noContentText}}</p>
                    </div>
                    <div class="col-lg-4 col-sm-6">
                        <h6>{{'project_type'| translate}}</h6>
                        <p><span class="risk-type-bx"><i class="ml-0 mr-1"><img src="/assets/images/risk-type-icon.png">
                                </i>{{ProjectDetailStore?.getsubProjectDetails?.project_type?.is_external?
                                'External':'Internal'}}</span></p>
                    </div>
                    <div class="col-lg-4 col-sm-6" *ngIf="ProjectDetailStore?.getsubProjectDetails?.project">
                        <h6>{{'sub_project'| translate}}</h6>
                        <p>
                            <span
                                *ngFor="let prj of ProjectDetailStore?.getsubProjectDetails?.project; let is_last = last;">
                                {{prj?.title}}<span *ngIf="!is_last">,&nbsp;</span>
                            </span>
                        </p>
                    </div>
                    <div class="col-lg-4 col-sm-6">
                        <h6>{{'organization'| translate}}</h6>
                        <p><span
                                *ngFor="let org of ProjectDetailStore?.getsubProjectDetails?.organizations; let is_last = last;">
                                {{org?.title}}<span *ngIf="!is_last">,&nbsp;</span>
                            </span>
                            <span
                                *ngIf="ProjectDetailStore?.getsubProjectDetails?.organizations?.length == 0">{{AppStore.noContentText}}</span>

                        </p>

                    </div>
                    <div class="col-lg-4 col-sm-6">
                        <h6>{{'division'| translate}}</h6>
                        <p>
                            <span
                                *ngFor="let div of ProjectDetailStore?.getsubProjectDetails?.divisions; let is_last = last;">
                                {{div?.title}}<span *ngIf="!is_last">,&nbsp;</span>
                            </span>
                            <span
                                *ngIf="ProjectDetailStore?.getsubProjectDetails?.divisions?.length == 0">{{AppStore.noContentText}}</span>

                        </p>
                    </div>
                    <div class="col-lg-4 col-sm-6">
                        <h6>{{'section'| translate}}</h6>
                        <p>
                            <span
                                *ngFor="let sec of ProjectDetailStore?.getsubProjectDetails?.sections; let is_last = last;">
                                {{sec?.title}}<span *ngIf="!is_last">,&nbsp;</span>
                            </span>
                            <span
                                *ngIf="ProjectDetailStore?.getsubProjectDetails?.sections?.length == 0">{{AppStore.noContentText}}</span>

                        </p>
                    </div>
                    <div class="col-lg-4 col-sm-6">
                        <h6>{{'department'| translate}}</h6>
                        <p>
                            <span
                                *ngFor="let dep of ProjectDetailStore?.getsubProjectDetails?.departments; let is_last = last;">
                                {{dep?.title}}<span *ngIf="!is_last">,&nbsp;</span>

                            </span>
                            <span
                                *ngIf="ProjectDetailStore?.getsubProjectDetails?.departments?.length == 0">{{AppStore.noContentText}}</span>
                        </p>
                    </div>
                    <div class="col-lg-4 col-sm-6">
                        <h6>{{'sub_section'| translate}}</h6>
                        <p>
                            <span
                                *ngFor="let sub_section of ProjectDetailStore?.getsubProjectDetails?.sub_sections; let is_last = last;">
                                {{sub_section?.title}}<span *ngIf="!is_last">,&nbsp;</span>
                            </span>
                            <span
                                *ngIf="ProjectDetailStore?.getsubProjectDetails?.sub_sections?.length == 0">{{AppStore.noContentText}}</span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-4 col-sm-6">
                        <div class="label-and-user-pic">
                            <h6>{{'project_manager'| translate}}</h6>
                            <app-user-popup-box
                                [source]="assignUserValues(ProjectDetailStore?.getsubProjectDetails?.project_manager)">
                            </app-user-popup-box>
                        </div>
                    </div>

                    <div class="col-lg-4 col-sm-6">
                        <h6>{{'client'| translate}}</h6>
                        <div class="client-logo-inner mb-3">
                            <img style="height: 42px;"
                                [src]="createImagePreview('project-logo', ProjectDetailStore?.getsubProjectDetails?.customer?.image_token)"
                                onerror="this.src='/assets/images/no-image.png'" class="img-fluid">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 edit-and-delete-main">
                        <div class="header-back-line mb-2 mt-2">
                            <h6> {{ 'project_activity' | translate }} </h6><button data-toggle="modal" title="Add"
                                class="btn-plus" (click)="addProjectActivity()">
                                <i class="fas fa-plus"></i></button>
                            <!---->
                        </div>
                        <table class="table table-bordered ordinary-table audit-page-table mb-1 mt-2 table-scroll"
                            *ngIf="ProjectDetailStore?.getsubProjectDetails?.project_activity.length > 0">
                            <thead>
                                <tr>
                                    <th class="border-top-0 text-center" width="5%"> # </th>
                                    <th class="border-top-0" width="40%"> {{'activities' | translate}} </th>
                                    <th class="border-top-0" width="25%"> {{'projected_man_days' | translate}}</th>
                                    <th class="border-top-0" width="15%"> {{'actual_man_days' | translate}} </th>
                                    <th class="border-top-0" width="15%"> {{'variation_diff' | translate}} </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="edit-and-delete-main"
                                    *ngFor="let row of ProjectDetailStore?.getsubProjectDetails?.project_activity;let i =index">
                                    <td class="text-center"> {{i+1}} </td>
                                    <td> {{row.project_time_tracker_activity?.language[0]?.pivot?.title}} </td>
                                    <td> {{row.projected_man_days}}
                                    </td>
                                    <td> {{row.variation? row.variation: AppStore.noContentText}}
                                    </td>
                                    <td> {{row.actual_man_days? row.actual_man_days: AppStore.noContentText }}
                                        <div class="edit-option-show" style="margin: 30px 0 0 0;">
                                            <a [attr.title]="'edit'|translate" (click)="edit(row)"><i
                                                    class="fas fa-pen pointer"></i></a>
                                            <a [attr.title]="'delete'|translate" (click)="delete(row.id)"><i
                                                    class="fas fa-trash pointer"></i></a>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <ng-container *mobxAutorun>
                            <app-no-data *ngIf="ProjectDetailStore?.getsubProjectDetails?.project_activity.length == 0"
                                [border]='false'></app-no-data>
                        </ng-container>
                        <!---->
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-sm-12 padding-left-0">
            <div class="bg-white p-3">
                <h6>{{'project_completion_score'| translate}}</h6>
                <hr class="mt-0 mb-3">
                <div class="progress-circle progress-circle-big-one" [ngClass]="'p'+ (toNumber(ProjectDetailStore?.getsubProjectDetails?.total_tasks) / 
                toNumber(ProjectDetailStore?.getsubProjectDetails?.task_completed)) || 0">
                    <span>{{ (toNumber(ProjectDetailStore?.getsubProjectDetails?.total_tasks) /
                        toNumber(ProjectDetailStore?.getsubProjectDetails?.task_completed)) || 0
                        }}%</span>
                    <div class="left-half-clipper">
                        <div class="first50-bar"></div>
                        <div class="value-bar">
                        </div>
                    </div>
                </div>

                <div class="big-text-box-main clearfix score-box-info mt-3">
                    <div class="big-text-box border-right">
                        <h3 class="big-text-one"><span
                                class="big-big-text">{{ProjectDetailStore?.getsubProjectDetails?.task_completed}}/</span>{{ProjectDetailStore?.getsubProjectDetails?.total_tasks}}
                        </h3>
                        <p class="mb-0">{{'completed'| translate}}</p>
                    </div>
                    <div class="big-text-box">
                        <h3 class="big-text-one">{{diffDays(ProjectDetailStore?.getsubProjectDetails?.target_date) }}
                            Days</h3>
                        <p class="mb-0">{{diffDays(ProjectDetailStore?.getsubProjectDetails?.target_date)>=0?'Remaining'
                            : 'Due'}}</p>
                    </div>
                </div>
            </div>
            <div class="bg-white mt-3 p-3">
                <h6>{{'cost_vs_spent' | translate}}</h6>
                <hr class="mt-0 mb-3">
                <img src="/assets/images/pm-chart-one.png" class="img-fluid d-block mx-auto">
            </div>
        </div>
    </div>
</div>

<div class="modal modal-style-1 popup-full-width fade" *mobxAutorun #ProjectActivityModal>
    <app-project-activity-modal *ngIf="projectActivityObject?.type"
        [source]="projectActivityObject"></app-project-activity-modal>
    <!-- <app-project-activity-modal></app-project-activity-modal> -->
</div>

<div class="modal modal-style-1 fade" id="delete-popup" #confirmationPopUp data-backdrop="static" data-keyboard="false">
    <app-delete-popup [source]="popupObject"></app-delete-popup>
</div>