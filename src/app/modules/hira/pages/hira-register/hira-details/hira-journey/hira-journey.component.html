<div class="tab-pane tab-edit-class " id="risk-journey" *mobxAutorun>
    <div *ngIf="RiskJourneyStore?._individualRiskJourneyLoaded">
        <div class="stup-root-cause-main rca-tab-stup-root-cause-main pt-0 risk-journey-details-main">
            <!-- Risk Context journey Start -->
            <div class="stup-root-cause pb-3 line-top-remove risk-journey-block" id="risk-journey">
                <div class="edit-and-delete-main">


                    <!-- one starts -->
                    <div class="clearfix">
                        <div class="journey-title-box">
                            <div class="journey-title-box-inner d-flex align-items-center">
                                <img src="/assets/images/risk-context-ico.png" width="45" />
                                <div class="ml-2">
                                    {{'risk' | translate}} <br>{{'context' | translate}}
                                </div>
                            </div>
                        </div>
                        <div class="risk-journey-details edit-and-delete-main">
                            <div class="edit-option-show" style="margin: 40px 0px 0 0;">
                                <!-- edit-and-delete starts -->
                                <a (click)="openHistoryPopup()"><i
                                        class="fas fa-history"></i><span>{{'history'|translate}}</span></a>
                                <a (click)="openWorkflowPopup()"><i
                                        class="fas fa-tasks"></i><span>{{'workflow'|translate}}</span></a>
                            </div>
                            <div>
                                <div class="issue-top-sec">
                                    <div
                                        [ngClass]="RiskJourneyStore?.individualRiskJourney?.description ? 'clearfix' : 'clearfix mb-2'">
                                        <h5 class="d-inline-block cmn-head-style label-tag-style"><span
                                                class="issue-smoal-head-text">{{RiskJourneyStore?.individualRiskJourney?.reference_code?RiskJourneyStore?.individualRiskJourney?.reference_code:'xxxx'}}</span>
                                            {{RiskJourneyStore?.individualRiskJourney?.title?RiskJourneyStore?.individualRiskJourney?.title:AppStore.noContentText}}
                                        </h5>
                                    </div>
                                    <p *ngIf="RiskJourneyStore?.individualRiskJourney?.description">
                                        {{RiskJourneyStore?.individualRiskJourney?.description}}
                                    </p>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <h6>{{'risk_impacts'|translate}}</h6>
                                        <ul class="arrowlist pl-0 mt-2"
                                            *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_impacts?.length>0">

                                            <li class="clearfix"
                                                *ngFor="let impact of RiskJourneyStore?.individualRiskJourney?.risk_impacts">
                                                <a>{{impact.title}}</a>
                                            </li>

                                        </ul>
                                        <p *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_impacts?.length==0">
                                            {{AppStore.noContentText}}</p>

                                        <!-- <p style="white-space:pre-line">{{RiskJourneyStore?.individualRiskJourney?.risk_impacts?RiskJourneyStore?.individualRiskJourney?.impact:AppStore.noContentText}}</p> -->
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <h6>{{'risk_causes'|translate}}</h6>
                                        <ul class="arrowlist pl-0 mt-2" *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_causes?.length>0">
            
                                            <li class="clearfix" *ngFor="let cause of RiskJourneyStore?.individualRiskJourney?.risk_causes"><a>{{cause.title}}</a>
                                            </li>
            
                                        </ul>
                                        <p *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_causes?.length==0">{{AppStore.noContentText}}</p>
                                   
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-3">
                                        <h6>{{'risk_sources' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.risk_sources.length>0?getArrayFormatedString('title',RiskJourneyStore?.individualRiskJourney?.risk_sources):AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3">
                                        <h6>{{'risk_category' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.risk_category?.title?RiskJourneyStore?.individualRiskJourney?.risk_category?.title:AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3">
                                        <h6>{{'risk_sub_category' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.risk_sub_category?.title?RiskJourneyStore?.individualRiskJourney?.risk_sub_category?.title:AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3">
                                        <h6>{{'risk_types' | translate}}</h6>
                                        <p *ngFor="let types of RiskJourneyStore?.individualRiskJourney?.risk_types"
                                            class="risk-type-bx risk-type-bx-drop">
                                            <i><img [attr.src]="types.is_internal == 1 ? 'assets/images/internal.svg' : 'assets/images/external.svg'"
                                                    style="width: 15px;"></i>&nbsp;{{types.language[0].pivot.title}}
                                        </p>
                                        <p *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_types.length==0">
                                            {{AppStore.noContentText}}</p>
                                    </div>
                                    <div class="col-md-3">
                                        <h6>{{'risk_areas' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.risk_areas.length>0?getArrayFormatedString('title',RiskJourneyStore?.individualRiskJourney?.risk_areas):AppStore.noContentText}}
                                        </p>
                                    </div>

                                    <div class="col-md-3">
                                        <h6>{{'corporate' | translate}}/{{'functional' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.is_corporate?'Corporate':'Functional'}}
                                        </p>
                                    </div>
                                    <div class="col-md-3">
                                        <h6>{{'issue_date' | translate}}</h6>
                                        <p *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_date">
                                            {{RiskJourneyStore?.individualRiskJourney?.risk_date|date:
                                            OrganizationGeneralSettingsStore?.organizationSettings?.date_format}}
                                        </p>
                                        <p *ngIf="!RiskJourneyStore?.individualRiskJourney?.risk_date">
                                            {{AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3">
                                        <h6>{{'review' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.risk_review_frequency?.type?RiskJourneyStore?.individualRiskJourney?.risk_review_frequency?.type:AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3">
                                        <h6>{{'next_review_date' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.next_review_date?RiskJourneyStore?.individualRiskJourney?.next_review_date:AppStore.noContentText}}
                                        </p>
                                    </div>

                                    <div class="col-md-3"
                                        *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_subsidiary">
                                        <h6>{{'organizations' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.organizations?.length>0?getArrayFormatedString('title',RiskJourneyStore?.individualRiskJourney?.organizations):AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3"
                                        *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_division">
                                        <h6>{{'divisions' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.divisions?.length>0?getArrayFormatedString('title',RiskJourneyStore?.individualRiskJourney?.divisions):AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3"
                                        *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_department">
                                        <h6>{{'departments' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.departments?.length>0?getArrayFormatedString('title',RiskJourneyStore?.individualRiskJourney?.departments):AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3"
                                        *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_section">
                                        <h6>{{'sections' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.sections?.length>0?getArrayFormatedString('title',RiskJourneyStore?.individualRiskJourney?.sections):AppStore.noContentText}}
                                        </p>
                                    </div>
                                    <div class="col-md-3"
                                        *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_sub_section">
                                        <h6>{{'sub_sections' | translate}}</h6>
                                        <p>{{RiskJourneyStore?.individualRiskJourney?.sub_sections?.length>0?getArrayFormatedString('title',RiskJourneyStore?.individualRiskJourney?.sub_sections):AppStore.noContentText}}
                                        </p>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12">
                                        <h6 class="text-left mb-1">{{'responsible_user' | translate}}</h6>
                                        <ul class="arci-user-tab-dtl workflow-lst-pics-loop clearfix mb-2">
                                            <li class="rounde-hov-bg"
                                                *ngFor="let user of RiskJourneyStore?.individualRiskJourney?.responsible_users;let i=index">
                                                <app-user-popup-box [source]="getPopupDetails(user)" [showName]="false">
                                                </app-user-popup-box>
                                            </li>
                                        </ul>

                                        <!-- <div class="row">
                                        <div class="col-sm-1 animation-pulse"
                                            *ngFor="let user of RiskJourneyStore?.individualRiskJourney?.responsible_users;let i=index">
                                            <app-user-popup-box [source]="getPopupDetails(user)" [showName]="false">
                                            </app-user-popup-box>
                                        </div>
                                    </div> -->

                                        <p *ngIf="RiskJourneyStore?.individualRiskJourney?.responsible_users.length==0">
                                            {{AppStore.noContentText}}</p>

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="label-and-user-pic">
                                            <h6>{{'risk_owner' | translate}}</h6>
                                            <div class="row"
                                                *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_owner">
                                                <div class="col-sm-12 animation-pulse">
                                                    <app-user-popup-box
                                                        [source]="getPopupDetails(RiskJourneyStore?.individualRiskJourney?.risk_owner)">
                                                    </app-user-popup-box>
                                                </div>
                                            </div>
                                        </div>

                                        <p *ngIf="!RiskJourneyStore?.individualRiskJourney?.risk_owner">
                                            {{AppStore.noContentText}}
                                        </p>

                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- one ends -->

            <!-- RIsk Mapping Journey  Start-->
            <div class="stup-root-cause pb-3  risk-journey-block">
                <!-- one starts -->
                <div class="clearfix">
                    <div class="journey-title-box">
                        <div class="journey-title-box-inner d-flex align-items-center">
                            <img src="/assets/images/risk-mapping-ico.png" width="40" />
                            <div class="ml-2">
                                {{'risk' | translate}} <br>{{'mapping' | translate}}
                            </div>
                        </div>
                    </div>
                    <div class="risk-journey-details pb-2">

                        <div>
                            <div class="panel-group panel-drop-sections pt-0" id="jrisk-journey-mapping-accordion"
                                role="tablist" aria-multiselectable="true">
                                <div class="panel panel-default"
                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.controls?.length>0">
                                    <div [ngClass]="currentTab=='control' || openAll==true?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne" (click)="toggleTab('control')" #controlTab>
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" href="#rmj1" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{'controls' | translate}} <span
                                                        class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span> </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div id="rmj1" class="drop-detail-sec panel-collapse collapse show" role="tabpanel"
                                        aria-labelledby="headingOne" data-parent="#jrisk-journey-mapping-accordion"
                                        style="" #controlShow>
                                        <div class="panel-body bg-white">
                                            <div class="no-fixed-table scrol-md-device">

                                                <p *ngIf="RiskJourneyStore?.individualRiskJourney?.controls?.length==0">
                                                    {{AppStore.noContentText}}</p>


                                                <table
                                                    class="table table-bordered ordinary-table word-break cmn-table-style mb-1"
                                                    *ngIf=" RiskJourneyStore?.individualRiskJourney?.controls?.length > 0">
                                                    <tr>
                                                        <th class="border-top-0" width="2%">#</th>
                                                        <th class="border-top-0" width="10%">{{'ref_id' | translate}}
                                                        </th>
                                                        <th class="border-top-0" width="88%">{{'title' | translate}}
                                                        </th>
                                                    </tr>
                                                    <tr
                                                        *ngFor="let cntrl of RiskJourneyStore?.individualRiskJourney?.controls; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td>{{cntrl.reference_code}}</td>
                                                        <td>{{cntrl.issues_title?cntrl.issues_title:cntrl.title}}</td>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel panel-default" *ngIf="issues?.length>0">
                                    <div [ngClass]="currentTab=='issue' || openAll==true?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne" (click)="toggleTab('issue')" #issueTab>
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" href="#rmj2" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{'issues' |translate}} <span
                                                        class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span> </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div id="rmj2" class="drop-detail-sec panel-collapse collapse" role="tabpanel"
                                        aria-labelledby="headingOne" data-parent="#jrisk-journey-mapping-accordion"
                                        style="" #issueShow>
                                        <div class="panel-body bg-white">
                                            <div class="no-fixed-table scrol-md-device">

                                                <p *ngIf="issues?.length==0">{{AppStore.noContentText}}</p>

                                                <table
                                                    class="table table-bordered ordinary-table word-break cmn-table-style mb-1"
                                                    *ngIf="issues?.length>0">
                                                    <tr>
                                                        <th class="border-top-0" width="2%">#</th>
                                                        <th class="border-top-0" width="10%">{{'ref_id' | translate}}
                                                        </th>
                                                        <th class="border-top-0" width="19%">{{'issue' | translate}}
                                                        </th>
                                                        <th class="border-top-0" width="15%">{{'issue_types'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="25%">{{'issue_categories'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="17%">{{'issue_domains'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="12%">{{'departments'
                                                            |translate}}</th>
                                                    </tr>
                                                    <tr *ngFor="let selected of issues; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td>#{{selected.reference_code}}</td>
                                                        <td>{{selected.title}}</td>
                                                        <td>
                                                            <span *ngFor="let types of selected.issue_types_list"
                                                                class="risk-type-bx risk-type-bx-drop">
                                                                <i><img [attr.src]="types == 'Internal' ? 'assets/images/internal.svg' : 'assets/images/external.svg'"
                                                                        style="width: 15px;"></i>&nbsp;{{types}}
                                                            </span>
                                                        </td>
                                                        <td>{{selected.issue_categories?selected.issue_categories:AppStore.noContentText}}
                                                        </td>
                                                        <td>{{selected.issue_domains?selected.issue_domains:AppStore.noContentText}}
                                                        </td>
                                                        <td>{{selected.departments}}</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel panel-default" *ngIf="processes?.length > 0">
                                    <div [ngClass]="currentTab=='process' || openAll==true?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne" (click)="toggleTab('process')" #processTab>
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" href="#rmj3" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{'processes' | translate}} <span
                                                        class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span> </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div id="rmj3" class="drop-detail-sec panel-collapse collapse" role="tabpanel"
                                        aria-labelledby="headingOne" data-parent="#jrisk-journey-mapping-accordion"
                                        style="" #processShow>
                                        <div class="panel-body bg-white">
                                            <div class="no-fixed-table scrol-md-device">

                                                <p *ngIf="processes?.length==0">{{AppStore.noContentText}}</p>

                                                <table
                                                    class="table table-bordered ordinary-table word-break cmn-table-style mb-1"
                                                    *ngIf="processes?.length > 0">
                                                    <tr>
                                                        <th class="border-top-0" width="2%">#</th>
                                                        <th class="border-top-0" width="9%">{{'ref_id' | translate}}
                                                        </th>
                                                        <th class="border-top-0" width="24%">{{'departments'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="25%">{{'process_group'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="35%">{{'process' | translate}}
                                                        </th>
                                                        <th class="border-top-0" width="20%">{{'process_category'
                                                            |translate}}</th>
                                                        
                                                    </tr>
                                                    <tr *ngFor="let selected of processes; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td>#{{selected.reference_code}}</td>
                                                        <td>{{selected.department}}</td>
                                                        <td>{{selected.process_group_title}}</td>
                                                        <td>{{selected.title}}</td>
                                                        <td>{{selected.process_category?.title}}</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel panel-default"
                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.locations?.length >0">
                                    <div [ngClass]="currentTab=='location' || openAll==true?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne" (click)="toggleTab('location')" #locationTab>
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" href="#rmj4" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{'locations' | translate}} <span
                                                        class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span> </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div id="rmj4" class="drop-detail-sec panel-collapse collapse" role="tabpanel"
                                        aria-labelledby="headingOne" data-parent="#jrisk-journey-mapping-accordion"
                                        style="" #locationShow>
                                        <div class="panel-body bg-white">
                                            <div class="no-fixed-table scrol-md-device">

                                                <p
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.locations?.length==0">
                                                    {{AppStore.noContentText}}</p>

                                                <table
                                                    class="table table-bordered ordinary-table word-break cmn-table-style mb-4"
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.locations?.length >0">
                                                    <tr>
                                                        <th class="border-top-0" width="3%">#</th>
                                                        <th class="border-top-0" width="97%">{{'title' |translate}}</th>
                                                    </tr>
                                                    <tr
                                                        *ngFor="let loc of RiskJourneyStore?.individualRiskJourney?.locations; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td>{{loc.title}}</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel panel-default"
                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.projects?.length > 0">
                                    <div [ngClass]="currentTab=='project' || openAll==true?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne" (click)="toggleTab('project')" #projectTab>
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" href="#rmj5" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{'projects' | translate}} <span
                                                        class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span> </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div id="rmj5" class="drop-detail-sec panel-collapse collapse" role="tabpanel"
                                        aria-labelledby="headingOne" data-parent="#jrisk-journey-mapping-accordion"
                                        style="" #projectShow>
                                        <div class="panel-body bg-white">
                                            <div class="no-fixed-table scrol-md-device">

                                                <p *ngIf="RiskJourneyStore?.individualRiskJourney?.projects?.length==0">
                                                    {{AppStore.noContentText}}</p>

                                                <table
                                                    class="table table-bordered ordinary-table word-break cmn-table-style mb-1"
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.projects?.length > 0">
                                                    <tr>
                                                        <th class="border-top-0" width="3%">#</th>
                                                        <th class="border-top-0" width="31%">{{'title' |translate}}</th>
                                                        <th class="border-top-0" width="30%">{{'manager_name'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="11%">{{'member_count'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="9%">{{'location' | translate}}
                                                        </th>
                                                    </tr>
                                                    <tr
                                                        *ngFor="let proj of RiskJourneyStore?.individualRiskJourney?.projects; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td> {{proj.title}}</td>
                                                        <td>
                                                            <div class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg"
                                                                *ngIf="proj.project_manager_first_name">
                                                                <div>
                                                                    <h6>{{proj.project_manager_first_name}}
                                                                        {{proj.project_manager_last_name}}</h6>
                                                                    <span>{{proj.project_manager_designation?proj.project_manager_designation:AppStore.noContentText}}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            <p *ngIf="!proj.project_manager_first_name">
                                                                {{AppStore.noContentText}}</p>
                                                        </td>
                                                        <td>{{proj.member_count?proj.member_count:AppStore.noContentText}}
                                                        </td>
                                                        <td>{{proj.location_title?proj.location_title:AppStore.noContentText}}
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel panel-default"
                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.products?.length > 0">
                                    <div [ngClass]="currentTab=='product' || openAll==true?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne" (click)="toggleTab('product')" #productTab>
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" href="#rmj6" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{'products' | translate}} <span
                                                        class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span> </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div id="rmj6" class="drop-detail-sec panel-collapse collapse" role="tabpanel"
                                        aria-labelledby="headingOne" data-parent="#jrisk-journey-mapping-accordion"
                                        style="" #productShow>
                                        <div class="panel-body bg-white">
                                            <div class="no-fixed-table scrol-md-device">

                                                <p *ngIf="RiskJourneyStore?.individualRiskJourney?.products?.length==0">
                                                    {{AppStore.noContentText}}</p>

                                                <table
                                                    class="table table-bordered ordinary-table word-break cmn-table-style mb-4"
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.products?.length > 0">
                                                    <tr>
                                                        <th class="border-top-0" width="3%">#</th>
                                                        <th class="border-top-0" width="31%">{{'title' |translate}}</th>
                                                        <th class="border-top-0" width="32%">{{'description'
                                                            |translate}}</th>
                                                    </tr>
                                                    <tr
                                                        *ngFor="let prod of RiskJourneyStore?.individualRiskJourney?.products; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td> {{prod.title}}</td>
                                                        <td>{{prod.description?prod.description:AppStore.noContentText}}
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel panel-default"
                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.customers?.length > 0">
                                    <div [ngClass]="currentTab=='customer' || openAll==true?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne" (click)="toggleTab('customer')" #customerTab>
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" href="#rmj7" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{'customers' | translate}} <span
                                                        class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span> </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div id="rmj7" class="drop-detail-sec panel-collapse collapse" role="tabpanel"
                                        aria-labelledby="headingOne" data-parent="#jrisk-journey-mapping-accordion"
                                        style="" #customerShow>
                                        <div class="panel-body bg-white">
                                            <div class="no-fixed-table scrol-md-device">

                                                <p
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.customers?.length==0">
                                                    {{AppStore.noContentText}}</p>

                                                <table
                                                    class="table table-bordered ordinary-table word-break cmn-table-style mb-1"
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.customers?.length > 0">
                                                    <tr>
                                                        <th class="border-top-0" width="3%">#</th>
                                                        <th class="border-top-0" width="31%">{{'title' |translate}}</th>
                                                        <th class="border-top-0" width="32%">{{'contact_person'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="9%">{{'address' |translate}}
                                                        </th>
                                                    </tr>
                                                    <tr
                                                        *ngFor="let cust of RiskJourneyStore?.individualRiskJourney?.customers; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td> {{cust.title}}</td>
                                                        <td>{{cust.contact_person?cust.contact_person:AppStore.noContentText}}
                                                        </td>
                                                        <td>{{cust.address?cust.address:AppStore.noContentText}}</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel panel-default"
                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.strategic_objectives?.length > 0">
                                    <div [ngClass]="currentTab=='strategy' || openAll==true?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne" (click)="toggleTab('strategy')" #strategicTab>
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" href="#rmj10" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{'strategic_objectives' | translate}} <span
                                                        class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span> </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div id="rmj10" class="drop-detail-sec panel-collapse collapse" role="tabpanel"
                                        aria-labelledby="headingOne" data-parent="#jrisk-journey-mapping-accordion"
                                        style="" #strategicShow>
                                        <div class="panel-body bg-white">
                                            <div class="no-fixed-table scrol-md-device">

                                                <p
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.strategic_objectives?.length==0">
                                                    {{AppStore.noContentText}}</p>

                                                <table
                                                    class="table table-bordered ordinary-table word-break cmn-table-style mb-0"
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.strategic_objectives?.length > 0">
                                                    <tr>
                                                        <th class="border-top-0" width="10%">#</th>
                                                        <th class="border-top-0" width="90%">{{'title' |translate}}</th>
                                                    </tr>
                                                    <tr
                                                        *ngFor="let obj of RiskJourneyStore?.individualRiskJourney?.strategic_objectives; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td>{{obj.title}}</td>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <app-no-data-list [source]="emptyItem" [height]=false [border]=false *ngIf="RiskJourneyStore?.individualRiskJourney?.strategic_objectives?.length==0 &&
                        RiskJourneyStore?.individualRiskJourney?.customers?.length==0 && 
                        RiskJourneyStore?.individualRiskJourney?.products?.length==0 && 
                        RiskJourneyStore?.individualRiskJourney?.projects?.length==0 &&
                        RiskJourneyStore?.individualRiskJourney?.locations?.length==0 &&
                        processes?.length==0 &&
                        RiskJourneyStore?.individualRiskJourney?.controls?.length==0 &&
                        issues?.length==0"></app-no-data-list>

                    </div>
                </div>
            </div>
            <!-- one ends -->


            <!-- RCA Journey  Start-->
            <div class="stup-root-cause pb-3  risk-journey-block"
                *ngIf="OrganizationModulesStore.checkOrganizationSubModulesPermission(900,38001)">
                <!-- one starts -->
                <div class="clearfix">
                    <div class="journey-title-box">
                        <div class="journey-title-box-inner d-flex align-items-center">
                            <img src="/assets/images/rca-ico.png" width="40" />
                            <div class="ml-2">
                                {{'rca' | translate}}
                            </div>
                        </div>
                    </div>
                    <div class="risk-journey-details pb-2">
                        <div>
                            <div class="panel-group panel-drop-sections pt-0" id="jrisk-journey-rca-accordion"
                                role="tablist" aria-multiselectable="true">
                                <div class="panel panel-default"
                                    *ngFor="let rca of RiskJourneyStore?.individualRiskJourney?.risk_root_cause_analysis; let list=index"
                                    (click)="openProcess(list+1)">
                                    <div [ngClass]="list+1==activeProcess ?'panel-heading active':'panel-heading'"
                                        role="tab" id="headingOne">
                                        <div class="panel-title relative">
                                            <a role="button" data-toggle="collapse" aria-expanded="false"
                                                aria-controls="collapseOne" class="collapsed">
                                                <h5 class="width96pc mt-0"> {{rca.why}} <span
                                                        class="question-blue ">?</span>
                                                    <span class="drop-down-icone"><i
                                                            class="fas fa-chevron-down"></i></span>
                                                </h5>
                                            </a>
                                        </div>
                                    </div>
                                    <div [ngClass]="list+1==activeProcess ?'drop-detail-sec panel-collapse collapse show':'drop-detail-sec panel-collapse collapse'"
                                        role="tabpanel" aria-labelledby="headingOne"
                                        data-parent="#jrisk-journey-rca-accordion" style="">
                                        <div class="panel-body bg-white">
                                            <p>{{rca.description}}</p>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <h6>{{'root_cause_category' | translate}}</h6>
                                                    <p>{{rca.root_cause_category?.title}}</p>
                                                </div>

                                                <div class="col-md-4">
                                                    <h6>{{'root_cause_sub_category' | translate}}</h6>
                                                    <p>{{rca.root_cause_sub_category?.title}}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <app-no-data-list
                                *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_root_cause_analysis==0"
                                [source]="emptyItem" [height]=false [border]=false></app-no-data-list>
                        </div>

                    </div>
                </div>
            </div>
            <!-- one ends -->

            <!-- RCA Journey  Start-->
            <div class="stup-root-cause pb-3  risk-journey-block"
                *ngIf="OrganizationModulesStore.checkOrganizationSubModulesPermission(900,38401)">
                <!-- one starts -->
                <div class="clearfix">
                    <div class="journey-title-box">
                        <div class="journey-title-box-inner d-flex align-items-center">
                            <img src="/assets/images/kri-ico.png" width="40" />
                            <div class="ml-2">
                                {{'kri' | translate}}
                            </div>
                        </div>
                    </div>
                    <div class="risk-journey-details pb-3">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="full-width-table">
                                    <table
                                        class="table table-bordered ordinary-table audit-page-table mb-1 table-scroll"
                                        *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_key_risk_indicators?.length > 0">
                                        <thead>
                                            <tr>
                                                <th class="border-top-0 text-center" width="2%">#</th>
                                                <th class="border-top-0" width="37%">{{'kri' | translate}}</th>
                                                <th class="border-top-0" width="15%">{{'risk_category' | translate}}
                                                </th>
                                                <th class="border-top-0" width="15%">{{'predicted_exposure'|translate}}
                                                </th>
                                                <th class="border-top-0" width="15%">{{'unit'|translate}}</th>
                                                <th class="border-top-0" width="15%">{{'actual_exposure'|translate}}
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="edit-and-delete-main"
                                                *ngFor="let kri of RiskJourneyStore?.individualRiskJourney?.risk_key_risk_indicators;let i=index">
                                                <td class="text-center">{{i+1}}</td>
                                                <td>{{kri?.key_risk_indicator?.title}}</td>
                                                <td>{{kri?.risk_category?.title}}</td>
                                                <td>{{kri.predicted_exposure}}</td>
                                                <td>{{kri.unit?.title}}</td>
                                                <td>
                                                    {{kri.actual_exposure?kri.actual_exposure:AppStore.noContentText}}<span
                                                        *ngIf="kri.actual_exposure"
                                                        [ngClass]="(kri.predicted_exposure>kri.actual_exposure)?'table-up-and-down-icon ml-2 text-green':'table-up-and-down-icon ml-2 text-red'"><i
                                                            [ngClass]="(kri.predicted_exposure>kri.actual_exposure)?'fa fa-arrow-down':'fa fa-arrow-up'"
                                                            aria-hidden="true"></i></span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <app-no-data-list *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_key_risk_indicators== 0"
                            [source]="emptyItem" [height]=false [border]=false></app-no-data-list>

                    </div>
                </div>
            </div>
            <!-- one ends -->

            <!-- Impact analysis Journey  Start-->
            <div class="stup-root-cause pb-3  risk-journey-block"
                *ngIf="OrganizationModulesStore.checkOrganizationSubModulesPermission(900,42001)">
                <!-- one starts -->
                <div class="clearfix">
                    <div class="journey-title-box">
                        <div class="journey-title-box-inner d-flex align-items-center">
                            <img src="/assets/images/impact-analysis-ico.png" width="40" />

                            <div class="ml-2">
                                {{'impact' | translate}} <br> {{'analysis' | translate}}
                            </div>
                        </div>
                    </div>
                    <div class="risk-journey-details pb-3">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="full-width-table">
                                    <table
                                        class="table table-bordered ordinary-table audit-page-table mb-2 table-scroll"
                                        *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_impact_analysis?.length>0">
                                        <thead>
                                            <tr>
                                                <th class="border-top-0 text-center" width="5%">#</th>
                                                <th class="border-top-0 text-center" width="20%">{{'category' |
                                                    translate }}</th>
                                                <th class="border-top-0 text-center" width="15%">{{ 'qualitative_impact'
                                                    | translate }}</th>
                                                <th class="border-top-0 text-center" width="20%">{{'money' | translate
                                                    }}
                                                    ({{OrganizationGeneralSettingsStore?.organizationSettings?.currency}})
                                                </th>
                                                <th class="border-top-0 text-center" width="20%">{{'time' | translate }}
                                                    ({{'days'|translate}})</th>
                                                <th class="border-top-0 text-center" width="20%">{{'performance' |
                                                    translate }} (%)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <ng-container
                                                *ngFor="let impact of RiskJourneyStore?.individualRiskJourney?.risk_impact_analysis;let i=index;">
                                                <tr *ngIf="impact.risk_impact==1">
                                                    <td class="text-center">{{i+1}}</td>
                                                    <td class="text-center">
                                                        {{impact.risk_impact_analysis_category?.title}}</td>
                                                    <td class="text-center">
                                                        {{impact.risk_matrix_impact?impact.risk_matrix_impact?.language[0].pivot?.title:AppStore.noContentText}}
                                                    </td>
                                                    <td class="text-center">{{impact.money}}</td>
                                                    <td class="text-center">{{impact.time}}</td>
                                                    <td class="text-center">{{impact.performance}}</td>
                                                </tr>
                                            </ng-container>
                                            <tr>
                                                <th colspan="3">{{'total'|translate}}</th>
                                                <td class="text-center bold"
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.money_total"><span
                                                        [ngClass]="RiskJourneyStore?.individualRiskJourney?.risk_impact_analysis?.money_total>0?'text-green':'text-red'">{{RiskJourneyStore?.individualRiskJourney?.money_total}}</span>
                                                </td>
                                                <td class="text-center bold"
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.total_time"><span
                                                        [ngClass]="RiskJourneyStore?.individualRiskJourney?.risk_impact_analysis?.total_time>0?'text-green':'text-red'">{{RiskJourneyStore?.individualRiskJourney?.total_time}}</span>
                                                </td>
                                                <td class="text-center bold"
                                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.average_performance">
                                                    <span
                                                        [ngClass]="RiskJourneyStore?.individualRiskJourney?.risk_impact_analysis?.average_performance>0?'text-green':'text-red'">{{RiskJourneyStore?.individualRiskJourney?.average_performance}}%</span>
                                                </td>
                                            </tr>
                                            <!-- <tr>
                                            <th colspan="2">Total</th>
                                            <td class="text-center bold">Total Money: <span [ngClass]="RiskJourneyStore?.individualRiskJourney?.money_total>0?'text-green':'text-red'">{{RiskJourneyStore?.individualRiskJourney?.money_total}}</span></td>
                                            <td class="text-center bold">Total Time: <span [ngClass]="RiskJourneyStore?.individualRiskJourney?.total_time>0?'text-green':'text-red'">{{RiskJourneyStore?.individualRiskJourney?.total_time}}</span></td>
                                            <td class="text-center bold">Total Count: <span [ngClass]="RiskJourneyStore?.individualRiskJourney?.total_count>0?'text-green':'text-red'">{{RiskJourneyStore?.individualRiskJourney?.total_count}}</span></td>
                                        </tr> -->
                                        </tbody>
                                    </table>
                                </div>
                                <app-no-data-list
                                    *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_impact_analysis?.length== 0"
                                    [source]="emptyItem" [height]=false [border]=false></app-no-data-list>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- one ends -->

            <!-- Risk Assessment Journey  Start-->
            <div class="stup-root-cause pb-3  risk-journey-block">
                <!-- one starts -->
                <div class="clearfix">
                    <div class="journey-title-box">
                        <div class="journey-title-box-inner d-flex align-items-center">
                            <img src="/assets/images/risk-assessment-ico.png" width="40" />

                            <div class="ml-2">
                                {{'risk' | translate}} <br> {{'assessment' | translate}}
                            </div>
                        </div>
                    </div>
                    <div class="risk-journey-details">
                        <div *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_analysis != null">
                            <div class="bg-main cmn-bdr p-3 mb-3">
                                <div class="row">
                                    <div class="col-lg-4 col-sm-5">
                                        <h4 class="head-three relative pr-4">
                                            {{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.likelihood?.language[0].pivot.title}}
                                            ({{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.likelihood?.score}})<a
                                                class="close-text-box">{{RisksStore.calculationMethod?.is_addition?'+':RisksStore.calculationMethod?.is_multiplication?'x':RisksStore.calculationMethod?.is_substraction?'-':'/'}}</a>
                                        </h4>
                                        <h5>{{'likelihood' | translate}}</h5>
                                        <div class="small-text-p">
                                            <p>{{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.likelihood?.language[0]?.pivot?.timeframe}}{{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.likelihood?.probability}}
                                            </p>
                                        </div>

                                        <h5 style="font-size: 14px;" class="mt-2"
                                            *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_analysis?.likelihood_justification!=null">
                                            {{'justification'|translate}}
                                        </h5>
                                        <div class="small-text-p"
                                            *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_analysis?.likelihood_justification!=null">
                                            <p style="white-space: pre-line;">
                                                {{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.likelihood_justification}}
                                            </p>

                                        </div>
                                    </div>
                                    <div class="col-lg-4 col-sm-7">
                                        <h4 class="head-three relative pr-4">
                                            {{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.impact?.language[0]?.pivot?.title}}
                                            ({{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.impact?.score}})
                                        </h4>
                                        <h5> {{'impact' | translate}}</h5>
                                        <div class="small-text-p">
                                            <p class="text-editor-content bullet-point-list pt-1 small-text"
                                                [innerHTML]="RiskJourneyStore?.individualRiskJourney?.risk_analysis?.impact?.language[0]?.pivot?.description | safeHtml">
                                            </p>
                                        </div>

                                        <h5 style="font-size: 14px;" class="mt-2"
                                            *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_analysis?.impact_justification!=null">
                                            {{'justification'|translate}}
                                        </h5>
                                        <div class="small-text-p"
                                            *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_analysis?.impact_justification!=null">
                                            <p style="white-space: pre-line;">
                                                {{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.impact_justification}}
                                            </p>

                                        </div>
                                    </div>
                                    <div class="col-lg-4 col-sm-12">
                                        <div class="small-rate-box">
                                            <div
                                                [ngClass]="'risk-rating-box risk-rating-box-small risk-rating-box-color bg-'+RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_rating?.label">
                                                <h3 class="text-white">
                                                    {{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_rating?.language[0]?.pivot?.title}}
                                                    ({{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_score}})
                                                </h3>
                                                <p class="text-white mb-0">{{'risk_rating' | translate}}
                                                    ({{'risk_score'| translate}})</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <div class="bg-white cmn-bdr p-2 pb-4">
                                        <h6>{{'control_efficiency' | translate}}</h6>
                                        <hr class="mt-0 mb-3">
                                        <div
                                            [ngClass]="RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score>50?'progress-circle over50 p'+RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score:'progress-circle p'+RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score">
                                            <span>{{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score!=null?RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score:0}}%</span>
                                            <div class="left-half-clipper">
                                                <div class="first50-bar"></div>
                                                <div class="value-bar"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <app-no-data-list *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_analysis== null"
                            [source]="emptyItem" [height]=false [border]=false></app-no-data-list>
                    </div>
                </div>
            </div>
            <!-- one ends -->

            <!-- Risk Treatment Journey  Start-->
            <div class="stup-root-cause pb-3  risk-journey-block">
                <!-- one starts -->
                <div class="clearfix">
                    <div class="journey-title-box">
                        <div class="journey-title-box-inner d-flex align-items-center">
                            <img src="/assets/images/risk-treatment-ico.png" width="40" />

                            <div class="ml-2">
                                {{'risk' | translate}} <br> {{'treatment' | translate}}
                            </div>
                        </div>
                    </div>
                    <div class="risk-journey-details">
                        <div
                            *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_treatments?.length > 0 && RiskJourneyStore?.individualRiskJourney?.risk_control_plan">

                            <div class="bg-main cmn-bdr p-3 mb-3">
                                <div class="row align-items-center">
                                    <div class="col-lg-6 col-sm-12 border-right-tab-and-mbl-bottom">
                                        <div class="row sm-row">
                                            <div class="col-lg-6 col-sm-12 sm-col">
                                                <div class="form-group mb-0">
                                                    <label for="name"
                                                        class="mb-0">{{'risk_treatment_strategy'|translate}}</label>


                                                    <div class="clearfix d-flex align-items-center">

                                                        <div class="multiple-plain-ngselect w-100">
                                                            <ng-select [items]="RiskControlPlanMasterStore.allItems"
                                                                placeholder="Select Risk Control Plan"
                                                                [multiple]="false" bindValue="id" searchable="true"
                                                                bindLabel="risk_control_plan_language_title"
                                                                [(ngModel)]="RiskJourneyStore.individualRiskJourney.risk_control_plan.id"
                                                                [disabled]="true"
                                                                (search)="searchRiskControlPlan($event)"
                                                                (clear)="getRiskControlPlan()"
                                                                (open)="getRiskControlPlan()"
                                                                autocomplete="new-password">

                                                            </ng-select>
                                                        </div>
                                                        <div class="question-circle-inp d-inline-block relative"
                                                            style="vertical-align: middle; margin: -20px 0 0 15px;">
                                                            <i class="far fa-question-circle"></i>
                                                            <div class="message-password-inp bottom-show">
                                                                <p class="mb-0 font-normal">
                                                                    {{RiskJourneyStore?.individualRiskJourney?.risk_control_plan?.language[0]?.pivot?.description?RiskJourneyStore?.individualRiskJourney?.risk_control_plan?.language[0]?.pivot?.description:AppStore.noContentText}}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>



                                            </div>
                                            <div class="col-lg-6 col-sm-12 sm-col">
                                                <div class="pt-3 pb-3 text-center">
                                                    <h3 class="text-18 mb-0">
                                                        <span class="text-28">
                                                            {{RiskJourneyStore.individualRiskJourney?.closed_count}}/</span>{{RiskJourneyStore.individualRiskJourney?.total_count}}
                                                        <p class="mb-0">{{'closed'|translate}}</p>
                                                    </h3>

                                                </div>



                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-sm-12">
                                        <div class="d-flex align-items-center">
                                            <div class="text-center" style="width: 120px;">
                                                <h3 class="mb-0 text-light-blue big-text-three">
                                                    {{RiskJourneyStore.individualRiskJourney?.completed_percentage?RiskJourneyStore.individualRiskJourney?.completed_percentage:0}}%
                                                </h3>
                                                <p class="mb-0">{{'closed' | translate}}</p>
                                            </div>
                                            <div class="progress w-100 ml-4 radius-20" style="height: 16px;">
                                                <div class="progress-bar"
                                                    [style.width.%]="RiskJourneyStore.individualRiskJourney?.completed_percentage">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div class="row mt-3">
                                        <div class="col-sm-12">
                                           
                                            <p style="white-space: pre-line;">
                                                {{RisksStore?.individualRiskDetails?.risk_treatment_plan}}
                                            </p>
                                        </div>
                                    </div> -->

                            </div>

                            <div class="row">
                                <div class="col-md-12">
                                    <!-- <h6>{{'risk_treatment' | translate}}</h6> -->
                                    <div class="no-fixed-table">
                                        <div class="scrol-md-device">
                                            <table class="table table-bordered ordinary-table cmn-table-style mb-1">
                                                <tbody>
                                                    <tr>
                                                        <th class="border-top-0" width="2%">#</th>
                                                        <th class="border-top-0" width="8%">{{'ref_no' | translate}}
                                                        </th>
                                                        <th class="border-top-0" width="16%">{{'title' | translate}}
                                                        </th>
                                                        <th class="border-top-0" width="22%">{{'risk' | translate}}</th>
                                                        <th class="border-top-0" width="10%">{{'risk_rating'|translate}}
                                                        </th>
                                                        <th class="border-top-0" width="16%">{{'risk_owner'
                                                            |translate}}r</th>
                                                        <th class="border-top-0" width="16%">{{'responsible_user'
                                                            |translate}}</th>
                                                        <th class="border-top-0" width="10%">{{'status' | translate}}
                                                        </th>
                                                    </tr>
                                                    <tr
                                                        *ngFor="let treatment of RiskJourneyStore?.individualRiskJourney?.risk_treatments; let list=index">
                                                        <td>{{list+1}}</td>
                                                        <td>{{treatment.reference_code}}</td>
                                                        <td>{{treatment.title}}</td>
                                                        <td>{{RiskJourneyStore?.individualRiskJourney?.title}}</td>
                                                        <td>{{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_rating?.language[0]?.pivot?.title}}
                                                        </td>
                                                        <td>
                                                            <app-user-popup-box id="jd"
                                                                *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_owner"
                                                                [source]="getPopupDetails(RiskJourneyStore?.individualRiskJourney?.risk_owner)">
                                                            </app-user-popup-box>
                                                        </td>
                                                        <td>
                                                            <app-user-popup-box id="jd"
                                                                *ngIf="treatment?.responsible_user"
                                                                [source]="getPopupDetails(treatment?.responsible_user,'auth')">
                                                            </app-user-popup-box>
                                                        </td>
                                                        <td>
                                                            <div
                                                                [attr.class]="'dot-div '+treatment?.risk_treatment_status?.label+'-dot'">
                                                                {{treatment?.risk_treatment_status?.language[0]?.pivot?.title}}
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <app-no-data-list *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_treatments== 0"
                            [source]="emptyItem" [height]=false [border]=false></app-no-data-list>
                    </div>
                </div>
            </div>
            <!-- one ends -->

            <!-- Residual Risks Journey  Start-->
            <div class="stup-root-cause pb-3  risk-journey-block  no-line">
                <!-- one starts -->
                <div class="clearfix">
                    <div class="journey-title-box">
                        <div class="journey-title-box-inner d-flex align-items-center">
                            <img src="/assets/images/residual-risk-ico.png" width="35" />
                            <div class="ml-2">{{'residual' | translate}} <br> {{'risk' | translate}}</div>
                        </div>
                    </div>
                    <div class="risk-journey-details">
                        <div *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis != null">
                            <div class="bg-main cmn-bdr p-3 mb-3">
                                <div class="row">
                                    <div class="col-lg-4 col-sm-5">
                                        <h4 class="head-three relative pr-4">
                                            {{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.impact?.language[0]?.pivot?.title}}
                                            (<span
                                                [ngClass]="'big-text-current-value text-'+RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_rating?.label">{{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.impact?.score}}
                                            </span> <span
                                                [ngClass]="'big-text-current-value text-'+RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_rating?.label"><i
                                                    class="fas fa-long-arrow-alt-right ml-2"></i>
                                                {{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.impact.score}}</span>)
                                            <a href="#"
                                                class="close-text-box">{{RisksStore.calculationMethod?.is_addition?'+':RisksStore.calculationMethod?.is_multiplication?'x':RisksStore.calculationMethod?.is_substraction?'-':'/'}}</a>
                                        </h4>
                                        <h5>{{'impact' | translate}}</h5>
                                        <div class="small-text-p">
                                            <p
                                                [innerHTML]="RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.impact?.language[0]?.pivot?.description | safeHtml">
                                            </p>
                                        </div>
                                        <h5 style="font-size: 14px;" class="mt-2"
                                            *ngIf="ResidualRiskStore.residualRiskDetails?.risk_residual_analysis?.impact_justification!=null">
                                            {{'justification'|translate}}
                                        </h5>
                                        <div class="small-text-p">
                                            <p style="white-space: pre-line;"
                                                *ngIf="ResidualRiskStore.residualRiskDetails?.risk_residual_analysis?.impact_justification!=null">
                                                {{ResidualRiskStore.residualRiskDetails?.risk_residual_analysis?.impact_justification}}
                                            </p>
                                        </div>


                                    </div>
                                    <div class="col-lg-4 col-sm-7">
                                        <h4 class="head-three relative pr-4">
                                            {{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.likelihood?.language[0]?.pivot?.title}}
                                            (<span
                                                [ngClass]="'big-text-current-value text-'+RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_rating?.label">{{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.likelihood?.score}}
                                            </span> <span
                                                [ngClass]="'big-text-current-value text-'+RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_rating.label"><i
                                                    class="fas fa-long-arrow-alt-right ml-2"></i>
                                                {{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.likelihood?.score}}</span>)
                                        </h4>
                                        <h5>{{'likelihood' | translate}} </h5>
                                        <div class="small-text-p">
                                            <p>{{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.likelihood?.language[0]?.pivot?.timeframe}}
                                            </p>
                                        </div>
                                        <h5 style="font-size: 14px;" class="mt-2"
                                            *ngIf="ResidualRiskStore.residualRiskDetails?.risk_residual_analysis?.likelihood_justification!=null">
                                            {{'justification'|translate}}
                                        </h5>
                                        <div class="small-text-p">
                                            <p style="white-space: pre-line;"
                                                *ngIf="ResidualRiskStore.residualRiskDetails?.risk_residual_analysis?.likelihood_justification!=null">
                                                {{ResidualRiskStore.residualRiskDetails?.risk_residual_analysis?.likelihood_justification}}
                                            </p>
                                        </div>

                                    </div>
                                    <div class="col-lg-4 col-sm-12">
                                        <div class="small-rate-box d-flex">
                                            <div
                                                [ngClass]="'risk-rating-box risk-rating-box-small risk-rating-box-color bg-'+RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_rating?.label+' w-100'">
                                                <h3 class="text-white">
                                                    &nbsp;{{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_rating?.language[0]?.pivot?.title}}
                                                    ({{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_score}})&nbsp;
                                                </h3>
                                                <p class="text-white mb-0">Residual Risk Rating</p>
                                            </div>
                                            <div class="risk-rating-box-white bg-white text-center risk-rating-box-color border-left-none"
                                                style="width: 100px;">
                                                <p
                                                    [ngClass]="'text-'+RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_rating.label+' mb-0'">
                                                    &nbsp;{{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_rating?.language[0]?.pivot?.title}}
                                                    {{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_score}}
                                                </p>
                                                <span
                                                    [ngClass]="(RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_score>RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_score) || (RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_score==RiskJourneyStore?.individualRiskJourney?.risk_analysis?.risk_score)?'down-icon-risk-rating text-green':'down-icon-risk-rating text-red'"><i
                                                        class="fas fa-long-arrow-alt-down"></i></span>
                                                <p
                                                    [ngClass]="'text-'+RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_rating.label+' mb-0'">
                                                    &nbsp;{{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_rating?.language[0]?.pivot?.title}}
                                                    {{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.risk_score}}
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xl-4 col-lg-6 col-sm-6 resudal-common-box-main"
                                    *ngIf="RiskManagementSettingStore.loaded && RiskManagementSettingStore.riskManagementSettings.is_control_efficiency">
                                    <div class="bg-white cmn-bdr pt-2 pl-2 pr-2 pb-0 resudal-common-box">
                                        <h6>{{'control_efficiency' | translate}} - {{'old_vs_new' | translate}}</h6>
                                        <hr class="mt-0 mb-3">

                                        <!-- <div class="residual-risk-graph text-center"> -->
                                        <div class="attendance-chart-pic text-center cmn-bdr-bottom"
                                            *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score>0 || RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.total_control_efficiency_score>0">
                                            <div class="vertical-progress-main clearfix">


                                                <div class="vertical-progress">
                                                    <div class="progress animation-vertical-progress">
                                                        <div class="progress-bar bg-white" role="progressbar"
                                                            [style.height.%]="100-RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score"
                                                            aria-valuenow="80" aria-valuemin="0" aria-valuemax="100">
                                                            <span
                                                                class="vertical-progress-value">{{RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score?RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score:0}}%</span>
                                                        </div>
                                                        <div class="progress-color-blue bg-primary"></div>
                                                        <div class="progress-color-green bg-primary"></div>

                                                    </div>
                                                </div>
                                                <!-- <span>Old</span> -->

                                                <div class="vertical-progress">
                                                    <div class="progress animation-vertical-progress">
                                                        <div class="progress-bar bg-white" role="progressbar"
                                                            [style.height.%]="100-RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.total_control_efficiency_score"
                                                            aria-valuenow="80" aria-valuemin="0" aria-valuemax="100">
                                                            <span
                                                                class="vertical-progress-value">{{RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.total_control_efficiency_score?RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.total_control_efficiency_score:0}}%</span>
                                                        </div>
                                                        <div class="progress-color-blue bg-primary"></div>
                                                        <div class="progress-color-green bg-primary"></div>

                                                    </div>
                                                    <!-- <span>New</span> -->
                                                </div>
                                                <!-- <div id="controlChartdiv"></div> -->
                                            </div>
                                        </div>
                                        <ng-container *ngIf="!(RiskJourneyStore?.individualRiskJourney?.risk_analysis?.total_control_efficiency_score>0) && !(RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis?.total_control_efficiency_score>0)
                        ">

                                            <app-no-data-list [source]="emptyItem" [border]=false [height]=false>
                                            </app-no-data-list>

                                        </ng-container>



                                    </div>
                                </div>

                                <div class="col-xl-4 col-lg-6 col-sm-6 resudal-common-box-main"
                                    *ngIf="RiskManagementSettingStore.loaded && RiskManagementSettingStore.riskManagementSettings.is_budget">
                                    <div class="bg-white cmn-bdr p-2 pb-4 resudal-common-box">
                                        <h6>{{'budget_allocation_vs_used' | translate}}</h6>
                                        <hr class="mt-0 mb-3 pt-2">
                                        <div class="progress-round-small btm-top-pdg w-100">

                                            <div
                                                [ngClass]="RiskJourneyStore?.individualRiskJourney?.budget_vs_used_percentage>50?'progress-circle over50 p'+RiskJourneyStore?.individualRiskJourney?.budget_vs_used_percentage:'progress-circle p'+RiskJourneyStore?.individualRiskJourney?.budget_vs_used_percentage">
                                                <span>{{(RiskJourneyStore?.individualRiskJourney?.budget_vs_used_percentage)
                                                    &&
                                                    (RiskJourneyStore?.individualRiskJourney?.budget_vs_used_percentage>100)?100:RiskJourneyStore?.individualRiskJourney?.budget_vs_used_percentage}}%</span>
                                                <div class="left-half-clipper">
                                                    <div class="first50-bar"></div>
                                                    <div class="value-bar"></div>
                                                </div>
                                            </div>
                                            <!-- <p class="mb-0">{{document.assessment_count}} {{'assessments'|translate}}</p> -->
                                        </div>
                                        <h5 class="text-light-blue text-center pt-2">
                                            {{OrganizationGeneralSettingsStore?.organizationSettings?.currency}}
                                            {{RiskJourneyStore?.individualRiskJourney?.treatment_total_amount_used}}/
                                            {{OrganizationGeneralSettingsStore?.organizationSettings?.currency}}
                                            {{RiskJourneyStore?.individualRiskJourney?.treatment_total_budget}}</h5>
                                    </div>

                                </div>
                            </div>

                        </div>
                        <app-no-data-list *ngIf="RiskJourneyStore?.individualRiskJourney?.risk_residual_analysis==null"
                            [source]="emptyItem" [border]=false [height]=false></app-no-data-list>
                    </div>
                </div>
            </div>
            <!-- one ends -->
        </div>
    </div>
</div>
<ng-container *mobxAutorun>
    <div *ngIf="!RiskJourneyStore?._individualRiskJourneyLoaded">
        <app-risk-journey-loader></app-risk-journey-loader>
    </div>
</ng-container>


<div class="modal modal-style-1 popup-full-width fade" id="process-popup" data-keyboard="false" data-backdrop="static"
    #workflowModal *mobxAutorun>
    <app-risk-journey-workflow *ngIf="workflowModalOpened == true"></app-risk-journey-workflow>
</div>

<div class="modal modal-style-1 popup-full-width fade" id="process-popup" data-keyboard="false" data-backdrop="static"
    #workflowHistory *mobxAutorun>
    <app-risk-journey-workflow-history *ngIf="workflowHistoryOpened == true"></app-risk-journey-workflow-history>
</div>

<div class="modal modal-style-1 image-download-popup-new fade" id="loadMe" aria-labelledby="loadMeLabel" tabindex="-1"
    role="dialog" #loaderPopUp>
    <app-loader [source]="downloadMessage"></app-loader>
</div>
<ng-container>
    <div class="modal modal-style-1 popup-full-width fade" data-keyboard="false" data-backdrop="static" #commentModal>
        <app-workflow-journey-comment-popup *ngIf="RiskJourneyWorkflowStore.commentForm">
        </app-workflow-journey-comment-popup>
    </div>
</ng-container>