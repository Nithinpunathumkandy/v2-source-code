<nav class="edit-bar" data-toggle="affix">
    <div class="module-name-block module-name-block-space float-left">
        <a class="dropdown module-title"> {{'kpi_dashboard' | translate}} </a>
    </div>
    <!-- <ul class="nav nav-pills edit-icons float-right d-none d-xl-block" role="tablist">
        <li>
            <button (click)="goToKpiDetialsPage()" type="button" class="btn btn-small btn-header-db"> {{'kpi_detais' | translate}} 
                <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </li>
        <li>
            <button (click)="goToPendingReviewsPage()" type="button" class="btn btn-small btn-header-db"> {{'pending_reviews' | translate}}
                <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </li>
    </ul> -->
</nav>

<main class="mt-3 acl-page cpf-space-adjust db-small-space-boxes" *mobxAutorun>
    <div class="container-fluid widget" *ngIf="KPIDashboardStore.dashboardLoaded">
        <app-filter-menu></app-filter-menu>
        <div class="row sm-row">
            <div class="col-xl-6 col-lg-12 col-sm-12 sm-col">
            <div class="bg-white btm-space-10 db-shadow">
                <div *ngIf="AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_COUNTS')" class="row align-items-center kpi-db-box-one-height">
                    <div class="col-md-4 border-right">
                        <div class="text-center mt-1 mb-1 pointer" (click)="redirectToKPIListPage(KPIDashboardStore.kpiCounts?.total_count,'all')">
                            <h3 class="big-text-four">{{KPIDashboardStore.kpiCounts?.total_count ? KPIDashboardStore.kpiCounts?.total_count: 0}}</h3>
                            <p class="mb-0 text-black">{{'total_kpis' | translate}}</p>
                        </div>
                    </div>
                    <div class="col-md-8 text-center">
                        <div class="clearfix pl-3 clearfix d-flex flex-wrap justify-content-between">
                            <div class="text-left pointer" (click)="redirectToKPIListPage(KPIDashboardStore.kpiCounts?.draft_count,'draft')">
                                <h3 class="big-text-one">{{KPIDashboardStore.kpiCounts?.draft_count ? KPIDashboardStore.kpiCounts?.draft_count: 0}}</h3>
                                <p class="dot-div-new dot-blue mb-0 font-normal elips-1">{{'draft' | translate}}</p>
                            </div>
                            <div class="text-left pointer" (click)="redirectToKPIListPage(KPIDashboardStore.kpiCounts?.in_review_count,'in-review')">
                                <h3 class="big-text-one">{{KPIDashboardStore.kpiCounts?.in_review_count ? KPIDashboardStore.kpiCounts?.in_review_count: 0}}</h3>
                                <p class="dot-div-new dot-orange mb-0 font-normal elips-1">{{'in_review' | translate}}</p>
                            </div>
                            <div class="text-left pointer" (click)="redirectToKPIListPage(KPIDashboardStore.kpiCounts?.reject_count,'reject')">
                                <h3 class="big-text-one">{{KPIDashboardStore.kpiCounts?.reject_count ? KPIDashboardStore.kpiCounts?.reject_count: 0}}</h3>
                                <p class="dot-div-new dot-red mb-0 font-normal elips-1">{{'reject' | translate}}</p>
                            </div>
                            <div class="text-left pointer" (click)="redirectToKPIListPage(KPIDashboardStore.kpiCounts?.approve_count,'approved')">
                                <h3 class="big-text-one">{{KPIDashboardStore.kpiCounts?.approve_count ? KPIDashboardStore.kpiCounts?.approve_count: 0}}</h3>
                                <p class="dot-div-new dot-green mb-0 font-normal elips-1">{{'approved' | translate}}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
            <div class="col-xl-6 col-lg-9 col-sm-12 sm-col" *ngIf="AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_IMPROVEMENT_PLAN_COUNTS')">
                <div class="bg-white btm-space-10 db-shadow">
                    <div class="row sm-row align-items-center kpi-db-box-one-height">
                        <div class="col-md-4 sm-col border-right">
                            <div class="text-center pointer" (click)="redirectToImprovementListPage(KPIDashboardStore.kpiImprovementPlanCounts?.total_count,'all')">
                                <h3 class="big-text-four">{{KPIDashboardStore.kpiImprovementPlanCounts?.total_count ? KPIDashboardStore.kpiImprovementPlanCounts?.total_count: 0}}</h3>
                                <p class="mb-0 text-black elips-1">{{'improvement_plans' | translate}}</p>
                            </div>
                        </div>
                        <div class="col-md-6 sm-col text-center">
                            <div class="clearfix round-type-status-main-bg">
                                <div class="round-type-status-main">
                                    <div class="open-close-status-db d-flex align-items-center status-open">
                                        <div class="round-type-status-value">
                                            <h6 class="mb-0">{{KPIDashboardStore.kpiImprovementPlanCounts?.open_percentage ? KPIDashboardStore.kpiImprovementPlanCounts?.open_percentage: '0%'}}</h6>
                                        </div>
                                        <div class="round-type-status-bg rounded-circle">
                                            <div class="round-type-status rounded-circle pointer" (click)="redirectToImprovementListPage(KPIDashboardStore.kpiImprovementPlanCounts?.open_count,'open')">
                                                <h5>{{'open' | translate}}</h5>
                                                <h6 class="mb-0">{{KPIDashboardStore.kpiImprovementPlanCounts?.open_count ? KPIDashboardStore.kpiImprovementPlanCounts?.open_count: 0}}</h6>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="round-type-status-main">
                                    <div class="open-close-status-db open-close-status-db-right d-flex align-items-center status-closed">
                                        <div class="round-type-status-bg rounded-circle">
                                            <div class="round-type-status rounded-circle pointer" (click)="redirectToImprovementListPage(KPIDashboardStore.kpiImprovementPlanCounts?.closed_count,'closed')">
                                                <h5>{{'closed' | translate}}</h5>
                                                <h6 class="mb-0">{{KPIDashboardStore.kpiImprovementPlanCounts?.closed_count ? KPIDashboardStore.kpiImprovementPlanCounts?.closed_count: 0}}</h6>
                                            </div>
                                        </div>
                                        <div class="round-type-status-value">
                                            <h6 class="mb-0">{{KPIDashboardStore.kpiImprovementPlanCounts?.closed_percentage ? KPIDashboardStore.kpiImprovementPlanCounts?.closed_percentage: '0%'}}</h6>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2 sm-col">
                        <div class="text-left pointer" (click)="redirectToImprovementListPage(KPIDashboardStore.kpiImprovementPlanCounts?.over_due_count,'overdue')">
                            <h3 class="big-text-one">{{KPIDashboardStore.kpiImprovementPlanCounts?.over_due_count ? KPIDashboardStore.kpiImprovementPlanCounts?.over_due_count: 0}}</h3>
                            <p class="dot-div-new dot-red mb-0 font-normal elips-1">{{'overdue' | translate}}</p>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="col-xl-2 col-lg-3 col-sm-12 sm-col"  *ngIf="AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_IMPROVEMENT_PLAN_COUNTS')">
                <div class="bg-white btm-space-10 db-shadow">
                    <div class="db-md-screen-center kpi-db-box-one-height">
                        <div class="text-center">
                            <h3 class="big-text-three">{{KPIDashboardStore.kpiImprovementPlanCounts?.resolved_percentage ? KPIDashboardStore.kpiImprovementPlanCounts?.resolved_percentage: "0%"}}</h3>
                            <p class="mb-0 text-black">{{'solved' | translate}}</p>
                        </div>
                        <span class="top-arow-db ml-2 text-dark-green"><i class="fas fa-long-arrow-alt-up"></i></span>
                    </div>        
                </div>
            </div>  -->
        </div>

                
        <div class="row sm-row">
            <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'KPI_performance' | translate}}</h5>
                    <hr>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="!KPIDashboardStore.kpiByPerformanceCounts">
                        <app-no-chart-data [source]="'pie'" style="height: 100%;"></app-no-chart-data>
                    </div>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="KPIDashboardStore.kpiByPerformanceCounts && AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_BY_PERFORMANCE_COUNTS')">
                        <div id="kpiPerformanceDountChart" style="height: 100%;">{{ chart1?kpiPerformanceDountChart(true) : ''}}</div>
                    </div>

                </div>
            </div>
            <div class="col-lg-8 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'kpi_performance_by_department' | translate}}</h5>
                    <hr>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                    *ngIf="KPIDashboardStore.KpiPerformanceByDepartmentCounts?.length==0">
                        <app-no-chart-data [source]="'bar'" style="height: 100%;"></app-no-chart-data>
                    </div>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                    *ngIf="KPIDashboardStore.KpiPerformanceByDepartmentCounts?.length>0 && AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_PERFORMANCE_BY_DEPARTMENT_COUNTS')">
                        <div id="kpiPerformanceByDepartmentCountsDiv" style="height: 100%;">{{ chart2?kpiPerformanceByDepartmentCounts(true):''}}</div>
                    </div>
                </div>
            </div>
        </div> 
        <div class="row sm-row">
            
            <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'kpi_status' | translate}}</h5>
                    <hr>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                    *ngIf="KPIDetialsDashboardStore.kpiCountByStatus.length>0  && AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_BY_STATUS_COUNTS')">
                        <div id="kpiStatusDountChart" style="height: 100%;">{{ chart1?kpiStatusDonutChart(true):''}}</div>
                    </div>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="KPIDetialsDashboardStore.kpiCountByStatus.length==0">
                        <app-no-chart-data [source]="'pie'" style="height: 100%;"></app-no-chart-data>
                    </div>

                </div>
            </div>
            <div class="col-lg-8 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'kip_by_departments' | translate}}</h5>
                    <hr>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="KPIDetialsDashboardStore.KpiCountByDepartment.length>0 && AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_BY_DEPARTMENT_COUNTS')">
                            <div id="kpiByDepartmentBardiv" style="height: 100%;">{{ chart4?kpiByDepartment(true):''}}</div>
                    </div>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="KPIDetialsDashboardStore.KpiCountByDepartment.length==0">
                            <app-no-chart-data [source]="'bar'" style="height: 100%;"></app-no-chart-data>
                    </div>
                </div>
            </div>
            <!-- <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'kpi_by_type' | translate}}</h5>
                    <hr>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="KPIDetialsDashboardStore.KpiPerformancebyTypeCounts.length>0  && AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_PERFORMANCE_BY_TYPE_COUNTS')">
                        <div id="kpiByTypeStackedBarChartDiv" style="height: 100%;">{{ chart2?kpiByTypeStackedBarChart(true):''}}</div>
                    </div>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="KPIDetialsDashboardStore.KpiPerformancebyTypeCounts.length==0">
                        <app-no-chart-data [source]="'bar'" style="height: 100%;"></app-no-chart-data>
                    </div>

                </div>
            </div> -->

            <!-- <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'kpi_by_category' | translate}}</h5>
                    <hr>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="KPIDetialsDashboardStore.kpiCountByCategory.length>0 && AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_BY_CATEGORY_COUNTS')">
                            <div id="kpiByCategoryPiechart" style="height: 100%;">{{ chart3?kpiBycategoryPieChart(true):''}}</div>
                    </div>
                    <div class="dpt-pic-ceo w-100" style="width: 100%; height: 200px"
                        *ngIf="KPIDetialsDashboardStore.kpiCountByCategory.length==0">
                            <app-no-chart-data [source]="'pie'" style="height: 100%;"></app-no-chart-data>
                    </div>

                </div>
            </div> -->


        </div>
         


        <!-- <div class="row sm-row">
            <div class="col-lg-7 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 box-shadow">
                    <h5 class="cmn-head-style m-0">{{'kpis' | translate}}</h5>
                    <hr>
                    
                    <div>

                    <div class="common-tab-md clearfix active-right-border-none hc-report-tab-style">
                            <div class="tab-common-left-md">
                                <div class=" issues-tab">
                                <ul class="nav nav-tabs nav-tabs--vertical nav-tabs--left vertical-tab" role="navigation">
                                
                                    <li class="nav-item" *ngFor="let item of KpiTypesMasterStore?.allItems;let num=index">
                                        <a (click)="getKpiType(num, item.id)"
                                            [ngClass]="selectedSection == num ? 'nav-link border-right-none-sm active' : 'nav-link border-right-none-sm'"
                                            data-toggle="tab" role="tab" aria-controls="lorem" aria-selected="false">{{item.title}}</a>
                                    </li>
                                </ul>
                                </div>
                            </div>
                    
                    
                            <div class="tab-common-left-content-m cmn-bdr padding-bottom-none kpi-db-sec-three-height">
                                <div class="tab-content">
                                    <div class="tab-pane fade active show" id="jan2" role="tabpanel">


                                        <div class="audit-form-table w-100 not-fixed-table mb-3">
                                            <table class="table table-bordered ordinary-table audit-page-table mb-1 table-scroll" *ngIf = "KPIDashboardStore.totalItems > 0 && KPIDashboardStore.kpiByTypesloaded">
                                                <thead>
                                                <tr >
                                                    <th class="border-top-0" width="4%">#</th>
                                                    <th class="border-top-0" width="80%">{{'kpi' | translate}}</th>
                                                    <th class="border-top-0" width="16%">{{'achievement' | translate}}</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                    <ng-container *mobxAutorun>
                                                        <tr  class="cursor-pointer edit-and-delete-main"   *ngFor="
                                                            let row of KPIDashboardStore?.allItemsKpiByTypes
                                                                | paginate
                                                                : {
                                                                    currentPage: KPIDashboardStore?.currentPage,
                                                                    itemsPerPage: KPIDashboardStore?.itemsPerPage,
                                                                    totalItems: KPIDashboardStore?.totalItems
                                                                    };
                                                            let num = index
                                                            " >
                                                            <td style="text-align: center;" style="padding:0.75rem" >
                                                                {{
                                                                    (KPIDashboardStore?.currentPage - 1) *
                                                                    KPIDashboardStore?.itemsPerPage +
                                                                    (num + 1)
                                                                }}
                                                            </td>
                                                            <td style="padding:0.75rem">{{row.title}}</td>
                                                            <td class="text-center">
                                                                <div>
                                                                <h6 class="mb-0 text-right text-14">{{row?.achieved_percentage}}</h6>
                                                                    <div class="progress" style="height: 8px;">
                                                                        <div class="progress-bar progress-bar-animation bg-{{row?.color}}" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" [style.max-width]="prgressSorting(row?.achieved_percentage)" ></div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </ng-container>
                                                </tbody>
                                            </table>

                                            <ng-container *mobxAutorun>
                                                <div *ngIf="!KPIDashboardStore?.kpiByTypesloaded">
                                                    <app-kpi-list-loader></app-kpi-list-loader>
                                                </div>
                                            </ng-container>
                                            <app-no-data *ngIf = "KPIDashboardStore.totalItems == 0 && KPIDashboardStore.kpiByTypesloaded" [height]='true' [border]='false'></app-no-data>
                                            <div *ngIf="KPIDashboardStore.totalItems > KPIDashboardStore.itemsPerPage" class="col-sm-12">
                                                <ul class="pagination justify-content-center mt-3">
                                                    <div class="list">
                                                        <pagination-controls [previousLabel]="'previous' | translate"  [nextLabel]="'next' | translate" (pageChange)="getKpiByTypeTableDetials(selectedSection,$event)" class="my-pagination"></pagination-controls>
                                                    </div>
                                                </ul>
                                            </div>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                    </div>

                    </div>

                </div>
            </div>
            <div class="col-lg-5 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 box-shadow">
                    <h5 class="cmn-head-style m-0">{{'kpi_performance_by_type' | translate}}</h5>
                    <hr>
                    <div class="attendance-chart-pic text-center" *ngIf="KPIDashboardStore.kpiPerformanceByTypeCounts?.length>0 && AuthStore.getActivityPermission(100,'KPI_MANAGEMENT_DASHBOARD_KPI_BY_TYPE')">
                        <div id="kpiPerformanceByTypeCountsChartDiv" class="kpi-db-sec-three-height">{{ chart3?kpiPerformanceByTypeCounts(true):''}}</div>
                    </div>
                    <div class="attendance-chart-pic text-center kpi-db-sec-three-height" *ngIf="KPIDashboardStore.kpiPerformanceByTypeCounts?.length==0">
                        <app-no-chart-data [source]="'bar'" >
                        </app-no-chart-data>
                    </div>  
                </div>
            </div>
        </div> -->
    </div>

    <div class="container-fluid widget" *ngIf="!KPIDashboardStore.dashboardLoaded">
        <app-dashboard-main></app-dashboard-main>
    </div>
</main>

