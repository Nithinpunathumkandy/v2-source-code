<ng-container *mobxAutorun>
    <div class="tab-pane tab-edit-class" id="teamwise" *ngIf="RiskTreatmentStore.loaded">

        <div class="bg-white widg-padding-cmn-small cmn-bdr mb-3"
        *ngIf="RiskTreatmentStore.riskTreatmentList.length>0 && RisksStore.individualRiskDetails?.risk_control_plan!=null && RisksStore.individualRiskDetails?.risk_control_plan?.is_treatment==1">
            <div class="row align-items-center" *ngIf="RiskTreatmentStore.summaryLoaded">
                <div class="col-lg-6 col-sm-12 border-right-tab-and-mbl-bottom">
                    <div class="row sm-row">
                        <div class="col-lg-6 col-sm-12 sm-col">
                            <div class="form-group mb-0">
                                <label for="name" class="mb-0">{{'risk_treatment_strategy'|translate}}</label>
        
        
                                <div class="clearfix d-flex align-items-center">
                                    <div class="multiple-plain-ngselect w-100">
                                        <ng-select [items]="RiskControlPlanMasterStore.allItems"
                                            [attr.placeholder]="'select_risk_control_plan' | translate" [multiple]="false"
                                            bindValue="id" searchable="true"
                                            bindLabel="risk_control_plan_language_title"
                                            [(ngModel)]="controlPlan"
                                            [disabled]="RiskTreatmentStore.riskTreatmentList?.length>0 && controlPlan!=null"
                                            (search)="searchRiskControlPlan($event)"
                                            (clear)="getRiskControlPlan()" (open)="getRiskControlPlan()"
                                            (change)="saveControlPlan()" autocomplete="new-password">

                                        </ng-select>
                                    </div>
                                    <!-- <div class="plain-select w-100">
                                        <select class="form-control" name="test">
                                            <option value="a1">Enter Field Name</option>
                                            <option value="a2">Select item 2</option>
                                            <option value="a3">Select item 3</option>
                                        </select>
                                    </div> -->
                                    <div class="question-circle-inp d-inline-block relative" *ngIf="controlData"
                                        style="vertical-align: middle; margin: -20px 0 0 15px;">
                                        <i class="far fa-question-circle"></i>
                                        <div class="message-password-inp bottom-show">
                                            <p class="mb-0 font-normal">
                                                {{controlData.risk_control_plan_language_title?controlData.risk_control_plan_language_title:controlData?.language[0]?.pivot?.description}}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
        
        
        
                        </div>
                        <div class="col-lg-6 col-sm-12 sm-col">
                            <div class="pt-3 pb-3 text-center">
                                <h3 class="text-18 mb-0"><span class="text-28">{{RiskTreatmentStore.summaryDetails.closed_count}}/</span>
                                    {{RiskTreatmentStore.summaryDetails.total_count}}</h3>
                                <p class="mb-0">{{'closed'|translate}}</p>
                            </div>
        
        
        
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-sm-12">
                    <div class="d-flex align-items-center">
                        <div class="text-center" style="width: 120px;">
                            <h3 class="mb-0 text-light-blue big-text-three">{{RiskTreatmentStore.summaryDetails?.completed_percentage?RiskTreatmentStore.summaryDetails?.completed_percentage:0}}%</h3>
                            <p class="mb-0">{{'closed' | translate}}</p>
                        </div>
                        <div class="progress w-100 ml-4 radius-20" style="height: 16px;">
                            <div class="progress-bar" 
                            [style.width.%]="RiskTreatmentStore.summaryDetails?.completed_percentage"></div>
                        </div>
                    </div>
                </div>
            </div>
        
        
        
            <div class="row sm-row mt-2"
            *ngIf="RisksStore?.individualRiskDetails?.risk_treatment_plan">
                <div class="col-sm-12 sm-col">
                    <h6>{{'risk_treatment_plan'|translate}}</h6>
                    <p class="mb-0">
                        {{RisksStore?.individualRiskDetails?.risk_treatment_plan}}
                    </p>
                </div>
            </div>
        
        
        
        </div>


        <div class="mt-3"
            *ngIf="RiskTreatmentStore.riskTreatmentList.length>0 && RisksStore.individualRiskDetails?.risk_control_plan!=null && RisksStore.individualRiskDetails?.risk_control_plan?.is_treatment==1">
         <!-- common-tab-md starts -->
         <div class="common-tab-md clearfix">
            <div class="tab-common-left-md">
              <div class=" issues-tab"><!-- tab menu start -->
                <ul class="nav nav-tabs nav-tabs--vertical nav-tabs--left vertical-tab" role="navigation">
                  <li class="nav-item"
                  *ngFor="let treatment of RiskTreatmentStore.riskTreatmentList| paginate: {currentPage:RiskTreatmentStore?.currentPage, itemsPerPage:RiskTreatmentStore?.itemsPerPage,totalItems:RiskTreatmentStore?.totalItems};let num = index"
                  (click)="getRiskTreatment(treatment.id)"> 
                  <a href="#tab-two-box-one" [ngClass]="treatment.id==activeTreatment?'nav-link active':'nav-link'"
                  data-toggle="tab" role="tab" aria-controls="lorem" aria-selected="false">
                    
                    <span [ngClass]="treatment.id==activeTreatment?'elips-1 w-100':'elips-1 w-100'" [title]="treatment.title">
                        #{{treatment.reference_code?treatment.reference_code:'XXXXX'}}- {{treatment.title?.length>10?treatment.title.substring(0,10)+'...' :
                        treatment.title}}</span>
                    <span [ngClass]="'draft-tag draft-tag-'+treatment.label+' label-tag-style-tag label-left-arow-tag mt-1'"
                    style="margin-left: 0 !important;">
                        {{treatment.risk_treatment_status_title}}</span>
                    </a>
                  </li>
                 
                </ul>
              </div><!-- tab menu end -->
            </div>
    
    
            <div class="tab-common-left-content-m"
            *ngIf="RiskTreatmentStore.individualTreatmentLoaded">
           
              <div class="tab-content">
                 <div class="tab-pane fade active show" id="tab-two-box-one" role="tabpanel">
                    <div class="row">
                       <div class="col-lg-8 col-sm-12 padding-right-0">
                          
                             <div class="widg-padding-cmn bg-white cmn-bdr">
                                 <div class="min-height-64 edit-and-delete-main">
                                    <div class="edit-option-show" style="margin: 20px -18px 0 0;">
                      
                                        <a class="pointer" [attr.title]="'Close Treatment'|translate" *ngIf="RiskTreatmentStore?.riskTreatmentDetails.risk_treatment_status.type=='resolved' && AuthStore.getActivityPermission(900,'CLOSE_RISK_TREATMENT')
                                            && RisksStore.individualRiskDetails?.risk_status?.type!='closed' && this.getResponsiblePresent(AuthStore.user.id)"
                                            (click)="closeRiskTreatment(RiskTreatmentStore.riskTreatmentDetails.id)"><i
                                                class="fas fa-times"></i></a>
                                        <a class="pointer" [attr.title]="'history'|translate" (click)="openHistoryModal()"
                                            *ngIf="AuthStore.getActivityPermission(900,'RISK_TREATMENT_UPDATE_LIST')"><i
                                                class="fas fa-history"></i></a>
                                        <a class="pointer" [attr.title]="'update'|translate" (click)="openUpdateModal()" *ngIf="RiskTreatmentStore?.riskTreatmentDetails.risk_treatment_status.type!='closed' && AuthStore.getActivityPermission(900,'CREATE_RISK_TREATMENT_UPDATE') && OrganizationModulesStore.checkIndividualSubModule(900,34301)
                                            &&RisksStore.individualRiskDetails?.risk_status?.type!='closed' && RisksStore.isProperEditUser()"><i
                                                class="fas fa-pen-alt"></i></a>
                                        <a class="pointer" [attr.title]="'edit'|translate" (click)="editTreatment()"
                                            *ngIf="AuthStore.getActivityPermission(900,'UPDATE_RISK_TREATMENT') && RiskTreatmentStore?.riskTreatmentDetails.risk_treatment_status.type!='closed' && RisksStore.individualRiskDetails?.risk_status?.type!='closed' && RisksStore.isProperEditUser()"><i
                                                class="fas fa-pen"></i></a>
                                        <a class="pointer" [attr.title]="'delete'|translate"
                                            (click)="deleteRiskTreatment(RiskTreatmentStore.riskTreatmentDetails.id)" *ngIf="getResponsiblePresent(AuthStore.user?.id) && AuthStore.getActivityPermission(900,'DELETE_RISK_TREATMENT') && RiskTreatmentStore?.riskTreatmentDetails.risk_treatment_status.type!='closed' && RiskTreatmentStore?.riskTreatmentDetails?.risk_treatment_status.type!='resolved'
                                            && RisksStore.individualRiskDetails?.risk_status?.type!='closed' && RisksStore.isProperEditUser() && RisksStore.individualRiskDetails.is_residual_analysis_performed!=1"><i
                                                class="fas fa-trash"></i></a>
                        
                                    </div>
                                <!-- <div class="col-lg-8 col-sm-12"> -->
                                    <div class="issue-top-sec">
                                        <div class="clearfix">

                                            <h5 class="d-inline-block cmn-head-style label-tag-style mr-2"><span
                                                    class="issue-smoal-head-text">#{{RiskTreatmentStore.riskTreatmentDetails.reference_code?RiskTreatmentStore.riskTreatmentDetails.reference_code:'XXXXX'}}</span>
                                                {{RiskTreatmentStore.riskTreatmentDetails.title}}
                                                <span
                                                    [ngClass]="'draft-tag draft-tag-'+RiskTreatmentStore?.riskTreatmentDetails?.risk_treatment_status?.label+' label-tag-style-tag label-left-arow-tag d-inline-block status-tag-new-one ml-3'">
                                                    {{RiskTreatmentStore.riskTreatmentDetails.risk_treatment_status.language[0].pivot.title}}</span>
                                            </h5>
                                            
                                        </div>
                                        <div class="clearfix mb-2">
                                            <label
                                                class="indication-label indication-label-red ml-0" *ngIf="RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='resolved' && RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='closed'">{{createDaysString(RiskTreatmentStore.riskTreatmentDetails.days_remaining)}}
                                                {{'remaining' | translate}}</label>
                                                <!-- <label
                                                class="blinking mb-0 pr-2" *ngIf="RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='resolved' && RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='closed'">( {{createDaysString(RiskTreatmentStore.riskTreatmentDetails.days_remaining)}}
                                                {{'remaining' | translate}} )</label> -->
                                                <span
                                                class="small-text pt-1">{{RiskTreatmentStore.riskTreatmentDetails?.percentage?RiskTreatmentStore.riskTreatmentDetails?.percentage:0}}%
                                                {{'completed' | translate}}</span>
                                                <span class="ml-2 mr-2" *ngIf="RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='resolved'&&RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='closed'">|</span>
                                                <span
                                                *ngIf="RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='resolved'&&RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='closed' && RiskTreatmentStore.riskTreatmentDetails?.latest_risk_treatment_update?.revised_target_date!=null"
                                                [ngClass]="getDays(RiskTreatmentStore.riskTreatmentDetails?.latest_risk_treatment_update?.revised_target_date) < 0?'bold text-red':'bold text-green'">
                                                {{getDays(RiskTreatmentStore.riskTreatmentDetails?.latest_risk_treatment_update?.revised_target_date) < 0?'Overdue':'Due'}}</span>
                                            <span
                                                *ngIf="RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='resolved'&&RiskTreatmentStore.riskTreatmentDetails?.risk_treatment_status?.type!='closed' && RiskTreatmentStore.riskTreatmentDetails?.latest_risk_treatment_update?.revised_target_date==null"
                                                [ngClass]="getDays(RiskTreatmentStore.riskTreatmentDetails?.start_date) > 0? 'bold text-green' : getDays(RiskTreatmentStore.riskTreatmentDetails?.target_date) < 0?'bold text-red':'bold text-green'">
                                                {{getDays(RiskTreatmentStore.riskTreatmentDetails?.start_date) > 0? 'Yet To Start': getDays(RiskTreatmentStore.riskTreatmentDetails?.target_date) < 0?'Overdue':'Due'}}</span>
                                        </div>
                                        <div class="clearfix mb-3">
                                            <!-- <h6>{{'treatment_description'|translate}}</h6> -->
                                            <p class="mb-1" style="white-space: pre-line;" *ngIf="RiskTreatmentStore.riskTreatmentDetails.description">
                                                {{RiskTreatmentStore.riskTreatmentDetails.description}}
                                            </p>
                                        </div>




                                    </div>

                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="label-and-user-pic">
                                                <h6>{{'risk_treatment_owner'|translate}}</h6>
                                                <app-user-popup-box id="jd"
                                                    *ngIf="RiskTreatmentStore.riskTreatmentDetails?.responsible_user"
                                                    [source]="getPopupDetails(RiskTreatmentStore.riskTreatmentDetails?.responsible_user)">
                                                </app-user-popup-box>
                                            </div>
                                            <div *ngIf="!RiskTreatmentStore.riskTreatmentDetails?.responsible_user">
                                                {{AppStore.noContentText}}</div>

                                        </div>
                                        <div class="col-md-4">
                                            <div class="label-and-user-pic">
                                                <h6>{{'risk_owner'|translate}}</h6>
                                                <app-user-popup-box id="jd"
                                                    *ngIf="RiskTreatmentStore.riskTreatmentDetails?.risk?.risk_owner"
                                                    [source]="getRiskPopupDetails(RiskTreatmentStore.riskTreatmentDetails.risk?.risk_owner)">
                                                </app-user-popup-box>
                                            </div>
                                            <div *ngIf="!RiskTreatmentStore.riskTreatmentDetails.risk?.risk_owner">
                                                {{AppStore.noContentText}}</div>

                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-12">
                                            <h6>{{'treatment_dependency'|translate}}</h6>
                                            <p style="white-space: pre-line;">
                                                {{RiskTreatmentStore.riskTreatmentDetails.treatment_dependency?RiskTreatmentStore.riskTreatmentDetails.treatment_dependency:AppStore.noContentText}}
                                            </p>
                                        </div>
                                    </div>



                                    <div class="row">
                                        <div class="col-md-4"
                                            *ngIf="RiskManagementSettingStore.loaded && RiskManagementSettingStore.riskManagementSettings.is_budget">
                                            <h6>{{'budget' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails.budget?RiskTreatmentStore.riskTreatmentDetails.budget:AppStore.noContentText}}
                                            </p>

                                        </div>

                                        <div class="col-md-4">
                                            <h6>{{'start_date' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails.start_date|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}
                                            </p>
                                        </div>
                                        <div class="col-md-4">
                                            <h6>{{'target_date' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails.target_date|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}
                                            </p>
                                        </div>


                                    </div>


                                    <div class="row" *ngIf="RiskTreatmentStore?.riskTreatmentDetails?.latest_risk_treatment_update">
                                        <div class="col-md-4" *ngIf="RiskTreatmentStore.riskTreatmentDetails.latest_risk_treatment_update?.actual_start_date">
                                            <h6>{{'actual_start_date' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails.latest_risk_treatment_update?.actual_start_date|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}
                                            </p>
                                        </div>
                                        <div class="col-md-4" *ngIf="RiskTreatmentStore.riskTreatmentDetails.latest_risk_treatment_update?.revised_target_date">
                                            <h6>{{'revised_due_date' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails.latest_risk_treatment_update?.revised_target_date|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}
                                            </p>
                                        </div>

                                    </div>

                                   


                                    <div class="row">
                                        <div class="col-md-12">
                                            <h6>{{risk_title|translate}}</h6>
                                            <p>#{{RiskTreatmentStore.riskTreatmentDetails?.risk?.reference_code}}
                                                {{RiskTreatmentStore.riskTreatmentDetails?.risk?.title?RiskTreatmentStore.riskTreatmentDetails?.risk?.title:AppStore.noContentText}}
                                            </p>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-12">
                                            <h6>{{rm_risk_description|translate}}</h6>
                                            <p style="white-space: pre-line;"
                                                >{{RiskTreatmentStore.riskTreatmentDetails?.risk?.description?RiskTreatmentStore.riskTreatmentDetails?.risk?.description:AppStore.noContentText}}
                                        </p>
                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-md-4"
                                            *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_subsidiary">
                                            <h6>{{'organizations' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails?.risk?.organizations?.length>0?getArrayFormatedString('title',RiskTreatmentStore.riskTreatmentDetails?.risk?.organizations):AppStore.noContentText}}
                                            </p>
                                        </div>

                                        <div class="col-md-4"
                                            *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_division">
                                            <h6>{{'divisions' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails?.risk?.divisions.length>0?getArrayFormatedString('title',RiskTreatmentStore.riskTreatmentDetails?.risk?.divisions):AppStore.noContentText}}
                                            </p>
                                        </div>
                                        <div class="col-md-4"
                                            *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_department">
                                            <h6>{{'departments' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails?.risk?.departments.length>0?getArrayFormatedString('title',RiskTreatmentStore.riskTreatmentDetails?.risk?.departments):AppStore.noContentText}}
                                            </p>
                                        </div>

                                    </div>

                                    <div class="row">

                                        <div class="col-md-4"
                                            *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_section">
                                            <h6>{{'sections' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails?.risk?.sections.length>0?getArrayFormatedString('title',RiskTreatmentStore.riskTreatmentDetails?.risk?.sections):AppStore.noContentText}}
                                            </p>
                                        </div>

                                        <div class="col-md-4"
                                            *ngIf="OrganizationLevelSettingsStore.organizationLevelSettings?.is_sub_section">
                                            <h6>{{'sub_sections' | translate}}</h6>
                                            <p>{{RiskTreatmentStore.riskTreatmentDetails?.risk?.sub_sections.length>0?getArrayFormatedString('title',RiskTreatmentStore.riskTreatmentDetails?.risk?.sub_sections):AppStore.noContentText}}
                                            </p>
                                        </div>

                                    </div>


                                    <!-- <div class="row">
                                        <div class="col-md-12">
                                            <div class="label-and-user-pic user-big-pic">
                                                <h6>Risk Owner</h6>
                                                <app-user-popup-box id="jd"
                                                    *ngIf="RiskTreatmentStore.riskTreatmentDetails.responsible_user"
                                                    [source]="getPopupDetails(RiskTreatmentStore.riskTreatmentDetails.responsible_user)">
                                                </app-user-popup-box>
                                            </div>
                                            <div *ngIf="!RiskTreatmentStore.riskTreatmentDetails.responsible_user">
                                                {{AppStore.noContentText}}</div>

                                        </div>
                                    </div> -->
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="label-and-user-pic">
                                                <h6>{{'watchers' | translate}}</h6>


                                                <div class="row">
                                                    <div class="col-sm-3 animation-pulse"
                                                        *ngFor=" let watcher of RiskTreatmentStore.riskTreatmentDetails.watchers">

                                                        <app-user-popup-box id="jd"
                                                            [source]="getWatcherPopupDetails(watcher)"
                                                           ></app-user-popup-box>

                                                    </div>
                                                </div>
                                                <p
                                                    *ngIf="RiskTreatmentStore?.riskTreatmentDetails?.watchers.length==0">
                                                    {{AppStore.noContentText}}</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mt-1">
                                        <div class="col-sm-12">
                                            <h6 *ngIf="RiskTreatmentStore.treatmentUpdateDataLoaded && RiskTreatmentStore.historyData.length>0">
                                                {{'treatment_updates' | translate}}
                                            </h6>
                            <div class="audit-form-table w-100 table-align-top not-fixed-table mb-3"
                                *ngIf="RiskTreatmentStore.treatmentUpdateDataLoaded && RiskTreatmentStore.historyData.length>0">
                                <table
                                    class="table table-bordered ordinary-table audit-page-table mb-1 table-scroll">
                                    <thead>
                                        <tr>
                                            <th class="border-top-0 text-center" style="width: 4%;">#</th>
                                            <th class="border-top-0" style="width: 35%;">{{'risk_treatment_actions'|translate}}</th>

                                            <!-- <th class="border-top-0" style="width: 8%;">Responsibility</th> -->
                                            <th class="border-top-0" style="width: 15%;">%{{'completed'|translate}}</th>
                                            <!-- <th class="border-top-0" style="width: 13%;">Proposed Start Date</th> -->
                                            <th class="border-top-0" style="width: 15%;">{{'actual_start_date'|translate}}</th>
                                            <!-- <th class="border-top-0" style="width: 8%;">Baseline Due Date</th> -->
                                            <th class="border-top-0" style="width: 15%;">{{'revised_due_date'|translate}}</th>
                                            <th class="border-top-0 text-center" style="width: 16%;" colspan="2">{{'status'|translate}}</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr
                                            *ngFor="let history of RiskTreatmentStore.historyData| paginate: {id:'historyTreatmentUpdate',currentPage:RiskTreatmentStore?.historyCurrentPage, itemsPerPage:RiskTreatmentStore?.historyItemsPerPage,totalItems:RiskTreatmentStore?.historyTotalItems};let num = index">
                                            <td class="text-center">{{(RiskTreatmentStore?.historyCurrentPage - 1) * RiskTreatmentStore?.historyItemsPerPage + (num +1)}}</td>
                                            <td>{{history.comment?history.comment:AppStore.noContentText}}</td>
                                            <!-- <td></td> -->
                                            <td>{{history.percentage?history.percentage:AppStore.noContentText}}
                                            </td>
                                            <td>{{history.actual_start_date?history.actual_start_date:AppStore.noContentText}}
                                            </td>
                                            <!-- <td></td> -->
                                            <td>{{history.revised_target_date?history.revised_target_date:AppStore.noContentText}}
                                            </td>
                                            <!-- <td></td> -->

                                            <td class="text-center">
                                                <div [ngClass]="'dot-div '+history.label+'-dot'">
                                                    {{history.risk_treatment_status_title}}
                                                </div>
                                                <!-- <span
                                                    [ngClass]="'dot-div '+history.label+'-dot'"></span>{{history.risk_treatment_status_title}} -->
                                            </td>
                                            <!-- <td></td> -->

                                        </tr>

                                    </tbody>
                                </table>
                                <ul class="pagination justify-content-center mt-3"
                                    *ngIf="RiskTreatmentStore?.historyTotalItems>RiskTreatmentStore?.historyItemsPerPage">
                                    <pagination-controls (pageChange)="historyPageChange($event)"
                                        class="my-pagination" id="historyTreatmentUpdate"></pagination-controls>
                                </ul>

                            </div>
                        </div>
                                    </div>


                                    <div class="row">

                                        <div class="col-md-12">
                                            <h6>{{'controls' | translate}}</h6>

                                            <div class="row process-form-tab">
                                                <div class="col-sm-12">

                                                    <div class="panel-group panel-drop-sections" id="jd"
                                                        role="tablist" aria-multiselectable="true">
                                                        <div class="panel panel-default"
                                                            *ngFor="let process of RiskTreatmentStore.riskTreatmentDetails.process_details"
                                                            (click)="openProcess(process.process.id)">
                                                            <div [ngClass]="process.process.id==activeProcess?'panel-heading active':'panel-heading'"
                                                                role="tab" id="headingOne">
                                                                <div class="panel-title">
                                                                    <a role="button" data-toggle="collapse"
                                                                        [attr.href]="'#ceo'+process.process.id"
                                                                        aria-expanded="false"
                                                                        aria-controls="collapseOne"
                                                                        class="collapsed">
                                                                        <h5 class="width96pc mt-0"
                                                                            [attr.title]="process.process.title?.length>50?process.process.title:''">
                                                                            {{process.process.reference_code}} -
                                                                            {{process.process.title.length>50?process.process.title.substring(0,50)+'...'
                                                                            :
                                                                            process.process.title}}
                                                                            <!-- <span
                                                                                class="indication-text indication-text-lg color-blue">{{'process'
                                                                                | translate}}</span> -->
                                                                            <span class="drop-down-icone"><i
                                                                                    class="fas fa-chevron-down"></i></span>
                                                                        </h5>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                            <div [attr.id]="'ceo'+process.process.id"
                                                                [ngClass]="process.process.id==activeProcess?'drop-detail-sec panel-collapse collapse show':'drop-detail-sec panel-collapse collapse'"
                                                                role="tabpanel" aria-labelledby="headingOne"
                                                                data-parent="#ceo01">
                                                                <div class="panel-body bg-white">
                                                                    <h6 class="mb-1"
                                                                        *ngIf="process.existing_controls && process.existing_controls?.length>0">
                                                                        {{'existing_controls'|translate}}</h6>
                                                                    <ul class="banking-issue"
                                                                        *ngIf="getControlLength(process.existing_controls)">
                                                                        <li class="clearfix"
                                                                            *ngFor="let exControls of process.existing_controls">
                                                                            <a>{{exControls?.control?.title}}</a>
                                                                        </li>

                                                                        <!-- <li class="clearfix"><a href="#">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt.</a></li> -->
                                                                    </ul>
                                                                    <ng-container
                                                                        *ngIf="process.existing_controls?.length==0 || !getControlLength(process.existing_controls)">
                                                                        <p>{{AppStore.noContentText}}</p>
                                                                    </ng-container>



                                                                    <h6 class="mb-1 mt-2">{{'new_controls' |
                                                                        translate}}</h6>
                                                                    <ul class="banking-issue"
                                                                        *ngIf="getControlLength(process.new_controls)">
                                                                        <li class="clearfix"
                                                                            *ngFor="let newControls of process.new_controls">
                                                                            <a>{{newControls.control.title}}</a>
                                                                        </li>
                                                                        <!-- <li class="clearfix"><a href="#">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt.</a></li> -->
                                                                    </ul>
                                                                    <ng-container
                                                                        *ngIf="process.new_controls?.length==0 || !getControlLength(process.new_controls)">
                                                                        <p>{{AppStore.noContentText}}</p>
                                                                    </ng-container>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <!-- Mapped Controls start -->

                                                        <div class="panel panel-default"
                                                            (click)="openProcess('control')">
                                                            <div [ngClass]="activeProcess=='control'?'panel-heading active':'panel-heading'"
                                                                role="tab" id="headingOne">
                                                                <div class="panel-title">
                                                                    <a role="button" data-toggle="collapse"
                                                                        [attr.href]="'#ceocontrol'"
                                                                        aria-expanded="false"
                                                                        aria-controls="collapseOne"
                                                                        class="collapsed">
                                                                        <h5 class="width96pc mt-0">
                                                                            {{'other_controls'|translate}}
                                                                            <!-- <span
                                                                                class="indication-text indication-text-lg color-blue">{{'process'
                                                                                | translate}}</span> -->
                                                                            <span class="drop-down-icone"><i
                                                                                    class="fas fa-chevron-down"></i></span>
                                                                        </h5>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                            <div [attr.id]="'ceocontrol'"
                                                                [ngClass]="activeProcess=='control'?'drop-detail-sec panel-collapse collapse show':'drop-detail-sec panel-collapse collapse'"
                                                                role="tabpanel" aria-labelledby="headingOne"
                                                                data-parent="#ceo01">
                                                                <div class="panel-body bg-white">
                                                                    <h6 class="mb-1"
                                                                       >
                                                                        {{'existing_controls'|translate}}</h6>
                                                                    <ul class="banking-issue">
                                                                        <li class="clearfix"
                                                                            *ngFor="let cntrl of RiskTreatmentStore?.riskTreatmentDetails?.other_controls?.existing_controls">
                                                                            <a>{{cntrl?.title}}</a>
                                                                        </li>

                                                                        <!-- <li class="clearfix"><a href="#">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt.</a></li> -->
                                                                    </ul>
                                                                    <ng-container
                                                                    *ngIf="RiskTreatmentStore?.riskTreatmentDetails?.other_controls?.existing_controls?.length==0 || (!RiskTreatmentStore?.riskTreatmentDetails?.other_controls?.existing_controls)">
                                                                    <div>{{AppStore.noContentText}}</div>
                                                                </ng-container>



                                                                <h6 class="mb-1 mt-2">{{'new_controls' |
                                                                    translate}}</h6>
                                                                <ul class="banking-issue"
                                                                    >
                                                                    <li class="clearfix"
                                                                        *ngFor="let newControls of RiskTreatmentStore?.riskTreatmentDetails?.other_controls?.new_controls">
                                                                        <a>{{newControls.title}}</a>
                                                                    </li>
                                                                    <!-- <li class="clearfix"><a href="#">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt.</a></li> -->
                                                                </ul>
                                                                <ng-container
                                                                    *ngIf="RiskTreatmentStore?.riskTreatmentDetails?.other_controls?.new_controls?.length==0 || !RiskTreatmentStore?.riskTreatmentDetails?.other_controls?.new_controls">
                                                                    <div>{{AppStore.noContentText}}</div>
                                                                </ng-container>

                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- Mapped Controls end -->
                                                        <ng-container
                                                            *ngIf="RiskTreatmentStore.riskTreatmentDetails.process_details.length==0 && RisksStore?.individualRiskDetails?.risk_controls?.length==0">
                                                            {{AppStore.noContentText}}
                                                        </ng-container>



                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="row">


                                        <div class="col-sm-12"
                                            *ngIf="RiskTreatmentStore?.totalItems>RiskTreatmentStore?.itemsPerPage">
                                            <ul class="pagination justify-content-center mt-3">
                                                <pagination-controls (pageChange)="pageChange($event)"
                                                    class="my-pagination"></pagination-controls>
                                            </ul>

                                        </div>
                                    </div>
                                <!-- </div> -->
                            </div>
                            <div class="row">
                                <div class="col-xl-12">
                                    <hr class="mb-2">
                                    <!-- <div class="d-flex flex-row user-list-sm">
                                                            <img [attr.src]="createRiskTreatmentStore.riskTreatmentDetails.created_by.image.token" class="rounded-circle" width="30px" height="30px">
                                                            <div>
                                                                <h6>{{RiskTreatmentStore.riskTreatmentDetails.created_by.first_name}} {{RiskTreatmentStore.riskTreatmentDetails.created_by.last_name}}</h6>
                                                                <span>{{RiskTreatmentStore.riskTreatmentDetails.created_by.designation}} | Created on {{RiskTreatmentStore.riskTreatmentDetails.created_at|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</span>
                                                            </div>
                                                        </div> -->
                                    <app-user-popup-box id="cb"
                                        [source]="getCreatedPopupDetails(RiskTreatmentStore.riskTreatmentDetails.created_by)">
                                    </app-user-popup-box>

                                </div>
                            </div>
                             </div>
                             
                       </div>
                       
                       <div class="col-lg-4 col-sm-12">
                        <div class="cmn-bdr bg-white widg-padding-cmn-small mb-3">
                            <h6>{{'risk_treatment'|translate}} % {{'completed' | translate}}</h6>
                            <hr class="mt-0 mb-3">
                            <div class="residual-risk-graph text-center">
                                <div class="progress-circle-big-one btm-top-pdg w-100">
                        
                                    <div
                                        [ngClass]="RiskTreatmentStore?.riskTreatmentDetails?.percentage>50?'progress-circle progress-circle-big-one over50 p'+RiskTreatmentStore?.riskTreatmentDetails?.percentage:'progress-circle progress-circle-big-one p'+RiskTreatmentStore?.riskTreatmentDetails?.percentage">
                                        <span>{{RiskTreatmentStore?.riskTreatmentDetails?.percentage>0?RiskTreatmentStore?.riskTreatmentDetails?.percentage:0}}%</span>
                                        <div class="left-half-clipper">
                                            <div class="first50-bar"></div>
                                            <div class="value-bar"></div>
                                        </div>
                                    </div>
                        
                                </div>
                        
                            </div>
                        </div>
                        <div class="cmn-bdr bg-white widg-padding-cmn-small mb-3"
                        *ngIf="RiskManagementSettingStore.loaded && RiskManagementSettingStore.riskManagementSettings.is_budget">
                            <h6>{{'budget_allocation_vs_used' | translate}}</h6>
                            <hr class="mt-0 mb-3">

                            <div class="progress-circle-big-one btm-top-pdg w-100">

                                <div
                                    [ngClass]="RiskTreatmentStore?.riskTreatmentDetails?.budget_vs_used_percentage>50?'progress-circle progress-circle-big-one over50 p'+RiskTreatmentStore?.riskTreatmentDetails?.budget_vs_used_percentage:'progress-circle progress-circle-big-one p'+RiskTreatmentStore?.riskTreatmentDetails?.budget_vs_used_percentage">
                                    <span>{{RiskTreatmentStore?.riskTreatmentDetails?.budget_vs_used_percentage>0?RiskTreatmentStore?.riskTreatmentDetails?.budget_vs_used_percentage:0}}%</span>
                                    <div class="left-half-clipper">
                                        <div class="first50-bar"></div>
                                        <div class="value-bar"></div>
                                    </div>
                                </div>
                                <!-- <p class="mb-0">{{document.assessment_count}} {{'assessments'|translate}}</p> -->
                            </div>
                            <h5 class="text-light-blue text-center pt-2">
                                {{OrganizationGeneralSettingsStore?.organizationSettings?.currency}}
                                {{RiskTreatmentStore?.riskTreatmentDetails?.amount_used?RiskTreatmentStore?.riskTreatmentDetails?.amount_used:0}}/
                                {{OrganizationGeneralSettingsStore?.organizationSettings?.currency}}
                                {{RiskTreatmentStore?.riskTreatmentDetails?.budget>0?RiskTreatmentStore?.riskTreatmentDetails?.budget:0}}
                            </h5>
                        </div>
                        <div class="cmn-bdr bg-white widg-padding-cmn-small mb-3">
                            <h6>
                                {{'days_remaining' | translate}}</h6>
                            <!-- <hr class="mt-0 mb-3"> -->
                            <!-- <div id="chartdiv" style="width: 100%; height: 200px"></div> -->
                            <!-- <div class="attendance-chart-pic text-center">
                                <div id="dayChartdiv"></div>
                            </div> -->
                            <!-- <div class="bg-white cmn-bdr mt-3 p-2 pb-3"> -->
                            <!-- <h6>15 Days Remaining</h6> -->
                            <hr class="mt-0 mb-3">
                            <div class="clearfix">
                                <div class="mb-3">
                                    <p class="dot-div-new font-normal mb-0 dot-green d-block">
                                        {{'remaining_days'|translate}}
                                        ({{createDaysString(RiskTreatmentStore.riskTreatmentDetails.days_remaining)}})
                                    </p>
                                    <p class="dot-div-new font-normal mb-0 dot-red d-block">
                                        {{'total_days'|translate}}({{createDaysString(RiskTreatmentStore.riskTreatmentDetails.total_days)}})
                                    </p>
                                </div>
                                <!-- <div class="dot-and-text mt-4">
                                    <span class="dot-div green-dot d-block">{{'remaining_days'|translate}}
                                        ({{createDaysString(RiskTreatmentStore.riskTreatmentDetails.days_remaining)}})</span><span
                                        class="dot-div red-dot d-block">{{'total_days'|translate}}({{createDaysString(RiskTreatmentStore.riskTreatmentDetails.total_days)}})</span>
                                </div> -->
                            </div>
                            <!-- <img src="images/risk-chart-3.png" class="img-fluid d-block mx-auto"> -->

                            <div class="vertical-progress-v2">
                                <div class="progress-bg-sec">
                                    <div class="progress-inner-color"
                                        [style.height.%]="(RiskTreatmentStore.riskTreatmentDetails.days_remaining/RiskTreatmentStore.riskTreatmentDetails.total_days)*100">
                                    </div>
                                </div>
                            </div>



                            <!-- </div> -->

                            <!-- <img src="/assets/images/risk-chart-3.png" class="img-fluid d-block mx-auto"> -->
                        </div>
                       </div>
                       <!-- <div class="col-lg-4 col-sm-12"
                       >
                        
                     </div>
                     <div class="col-lg-4 col-sm-12">
                        
                     </div> -->
                    </div>
                 </div>
                
 
              </div>
            </div>
          </div>
        <!-- common-tab-md end -->
    </div>

       
        <div class="bg-white widg-padding-cmn mb-3 box-height-risk-question manage-risk-box-hide"
            *ngIf="RisksStore.individual_risk_loaded && RisksStore.individualRiskDetails?.is_analysis_performed && RiskTreatmentStore.loaded && ((RisksStore.individualRiskDetails?.risk_control_plan==null&&changePlan==false) || changePlan==true)">
            <div class="row">
                <div class="col-md-12">
                    <div class="text-center">
                        <span class="risk-treatment-icones">
                            <img [attr.src]="'/assets/images/'+controlData.type+'.svg'" class="img-fluid">
                        </span>
                        <!-- <span class="risk-exclamation-icon"><i class="fas fa-exclamation-circle"></i></span> -->
                        <p>{{'risk_has_been_open_for'|translate}}
                            {{getDays(RisksStore?.individualRiskDetails?.risk_date)}}
                            {{'days'|translate}}, <br>{{'how_do_you_want_manage_risk' | translate}}?</p>
                        <div class="loop-btns">
                            <span [ngClass]="controlPlan==plan.id?'risk-treatment-btn active':'risk-treatment-btn'"
                            *ngFor="let plan of RiskControlPlanMasterStore.allItems;let p=index"
                            (click)="setControlPlan(plan)">{{plan.risk_control_plan_language_title}}</span>

                        </div>
                        <div class="mt-3 control-plan-des">
                            <p>
                                {{controlData?.risk_control_plan_language_description?controlData.risk_control_plan_language_description:controlData?.language[0]?.pivot?.description}}
                            </p>
                            <h6>{{'risk_treatment_strategy'|translate}}</h6>
                            <textarea rows="3" id="impactComment" class="form-control" [(ngModel)]="strategy"
                                placeholder="Enter your strategic plan here" name="impactJustification"></textarea>
                        </div>
                        <div class="mt-4">
                            <button type="button" class="btn btn-active show-risk-box-btn" *ngIf="RisksStore.isProperEditUser()"
                                (click)="saveControlPlan()">{{AppStore.loading?getButtonText('loading'):getButtonText('save')}}</button>
                            <button *ngIf="controlPlan" type="button" class="btn show-risk-box-btn"
                                (click)="exitControlSelection()">{{AppStore.loading?getButtonText('loading'):getButtonText('cancel')}}</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="bg-white widg-padding-cmn mb-3 box-height-risk-question show-risk-box" style="display: block;"
            *ngIf="RisksStore.individual_risk_loaded && RisksStore.individualRiskDetails?.is_analysis_performed && RiskTreatmentStore.loaded && ((((RiskTreatmentStore.riskTreatmentList.length==0 && controlData?.is_treatment==1)|| controlData?.is_treatment!=1) && RisksStore.individualRiskDetails?.risk_control_plan!=null && changePlan==false)|| (RiskTreatmentStore.riskTreatmentList.length==0 && RisksStore.individualRiskDetails?.risk_control_plan!=null && changePlan==false))">
            <div class="row">
                <div class="col-md-12">
                    <div class="text-center">

                        <p>{{'now_that_you_have_decided_to'|translate}} <span
                                class="text-blue">'{{RisksStore.individualRiskDetails.risk_control_plan?.language[0].pivot.title}}
                                '</span>{{'the_risk'|translate}} {{controlData?.is_treatment==1?getButtonText('lets_go_ahead_to_add_treatment_plan'):''}}</p>

                        <div class="mt-3 control-plan-des">
                            <p>
                                {{controlData?.risk_control_plan_language_description?controlData.risk_control_plan_language_description:controlData?.language[0]?.pivot?.description}}
                            </p>

                            <h6 *ngIf="strategy">{{'risk_treatment_strategy'|translate}}</h6>
                            <p>{{strategy}}</p>
                        </div>
                        <button type="button" data-toggle="modal" (click)="openFormModal()" class="btn btn-active"
                            *ngIf="controlData?.is_treatment==1 && RisksStore.individualRiskDetails?.risk_status?.type!='closed' && RisksStore.isProperEditUser()">{{'add_treatment_plan'
                            | translate}}</button>
                        <button type="button" data-toggle="modal" (click)="changeControlPlan()"
                            *ngIf="RisksStore.individualRiskDetails?.risk_status?.type!='closed' && RisksStore.isProperEditUser()" class="btn">{{'change_treatment_strategy'|translate}}</button>
                        <button
                            *ngIf="controlData?.is_treatment!=1 && properCloseUser(AuthStore.user?.id) && RisksStore.individualRiskDetails?.risk_status?.type!='closed'"
                            type="button" data-toggle="modal" (click)="closeRisk()" class="btn">{{'close_risk'|translate}}
                        </button>

                    </div>
                </div>
            </div>
        </div>

    </div>

    <ng-container *mobxAutorun>
        <div *ngIf="!RisksStore.individual_risk_loaded && !RiskTreatmentStore.loaded">
            <app-risk-treatment-detail-loader></app-risk-treatment-detail-loader>
        </div>
    </ng-container>


    <!-- risk-update-popup Start -->
    <div class="modal modal-style-1 fade popup-full-width" id="risk-update-popup" data-keyboard="false"
        data-backdrop="static" #updatePopup>
        <button type="button" class="close" (click)="closeUpdateModal()"><i class="lni-close"></i><span>{{'esc' |
                translate}}</span></button>
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">{{'update_risk_treatment_progress' | translate}}</h4>
                </div>
                <div class="modal-body form-body">
                    <p class="head-details">{{'treatment_update_form_description' | translate}}</p>

                    <form *ngIf="updateForm" [formGroup]="updateForm" id="updateForm">

                        <div class="row">
                            <div class="col-sm-12" *ngIf="RisksStore.individual_risk_loaded">
                                <div class="form-group">
                                    <div class="cmn-bdr border-radius p-3">
                                        <div class="issue-top-sec">
                                            <div class="clearfix">
                                                <h5 class="d-inline-block cmn-head-style label-tag-style"><span
                                                        class="issue-smoal-head-text">#{{RisksStore.individualRiskDetails?.reference_code}}</span>
                                                    {{RisksStore.individualRiskDetails?.title}}</h5>
                                            </div>
                                            <!--style="white-space: pre-line;" {{RisksStore.individualRiskDetails?.description ? RisksStore.individualRiskDetails?.description : AppStore.noContentText}} -->
                                            <p *ngIf="RisksStore.individualRiskDetails?.description"
                                                [innerHTML]="RisksStore.individualRiskDetails?.description | safeHtml"></p>
                                            <p *ngIf="!RisksStore.individualRiskDetails?.description">
                                                {{AppStore.noContentText}}</p>


                                        </div>

                                        <div class="row">
                                            <div class="col-xl-3 col-lg-4 col-sm-6"
                                                [ngStyle]="{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_subsidiary ? 'none':'block'}">
                                                <h6>{{'organizations'|translate}}</h6>
                                                <p>{{RisksStore.individualRiskDetails?.organizations.length>0?getArrayFormatedString('title',RisksStore.individualRiskDetails?.organizations):AppStore.noContentText}}
                                                </p>
                                                <!-- <p>{{RisksStore.individualRiskDetails?.organizations ? RisksStore.individualRiskDetails?.organizations.title : AppStore.noContentText}}</p> -->
                                            </div>
                                            <div class="col-xl-3 col-lg-4 col-sm-6"
                                                [ngStyle]="{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_division ? 'none':'block'}">
                                                <h6>{{'divisions'|translate}}</h6>
                                                <p>{{RisksStore.individualRiskDetails?.divisions.length>0?getArrayFormatedString('title',RisksStore.individualRiskDetails?.divisions):AppStore.noContentText}}
                                                </p>
                                                <!-- <p>{{RisksStore.individualRiskDetails?.divisions ? RisksStore.individualRiskDetails?.divisions.title : AppStore.noContentText}}</p> -->
                                            </div>
                                            <div class="col-xl-3 col-lg-4 col-sm-6"
                                                [ngStyle]="{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_department ? 'none':'block'}">
                                                <h6>{{'departments'|translate}}</h6>
                                                <p>{{RisksStore.individualRiskDetails?.departments.length>0?getArrayFormatedString('title',RisksStore.individualRiskDetails?.departments):AppStore.noContentText}}
                                                </p>
                                                <!-- <p>{{RisksStore.individualRiskDetails?.departments ? RisksStore.individualRiskDetails?.departments.title : AppStore.noContentText}}</p> -->
                                            </div>
                                            <div class="col-xl-3 col-lg-4 col-sm-6"
                                                [ngStyle]="{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_section ? 'none':'block'}">
                                                <h6>{{'sections'|translate}}</h6>
                                                <p>{{RisksStore.individualRiskDetails?.sections.length>0?getArrayFormatedString('title',RisksStore.individualRiskDetails?.sections):AppStore.noContentText}}
                                                </p>
                                                <!-- <p>{{RisksStore.individualRiskDetails?.sections ? RisksStore.individualRiskDetails?.sections.title : AppStore.noContentText}}</p> -->
                                            </div>
                                            <div class="col-xl-3 col-lg-4 col-sm-6"
                                                [ngStyle]="{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_sub_section ? 'none':'block'}">
                                                <h6>{{'sub_sections'|translate}}</h6>
                                                <p>{{RisksStore.individualRiskDetails?.sub_sections.length>0?getArrayFormatedString('title',RisksStore.individualRiskDetails?.sub_sections):AppStore.noContentText}}
                                                </p>
                                                <!-- <p>{{RisksStore.individualRiskDetails?.sub_sections ? RisksStore.individualRiskDetails?.sub_sections.title : AppStore.noContentText}}</p> -->
                                            </div>
                                            <div class="col-xl-3 col-lg-4 col-sm-6"
                                                *ngIf="RisksStore?.contextChartLoaded">
                                                <h6>{{'risk_rating'|translate}}</h6>
                                                <p>{{RisksStore.contextChartDetails.risk_analysis.risk_rating.language[0].pivot.title}}
                                                </p>
                                            </div>
                                            <div class="col-xl-3 col-lg-4 col-sm-6">
                                                <h6>{{'frequency_of_report'|translate}}</h6>
                                                <p>{{RisksStore?.individualRiskDetails.risk_review_frequency?RisksStore?.individualRiskDetails.risk_review_frequency.language[0]?.pivot?.title:AppStore.noContentText}}
                                                </p>
                                            </div>
                                            <div class="col-sm-12">
                                                <div class="label-and-user-pic mb-0">
                                                    <h6>{{'risk_owner'|translate}}</h6>
                                                    <app-user-popup-box id="jd"
                                                        *ngIf="RisksStore.individualRiskDetails?.risk_owner"
                                                        [source]="getRiskPopupDetails(RisksStore.individualRiskDetails?.risk_owner)">
                                                    </app-user-popup-box>
                                                    <div *ngIf="!RisksStore.individualRiskDetails?.risk_owner">
                                                        {{AppStore.noContentText}}</div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="issue-top-sec">
                                            <div class="clearfix">
                                                <h5 class="d-inline-block cmn-head-style label-tag-style"><span
                                                        class="issue-smoal-head-text">#{{RiskTreatmentStore.riskTreatmentDetails?.reference_code}}</span>
                                                    {{RiskTreatmentStore.riskTreatmentDetails?.title}}</h5>
                                            </div>
                                            <!--style="white-space: pre-line;" {{RisksStore.individualRiskDetails?.description ? RisksStore.individualRiskDetails?.description : AppStore.noContentText}} -->
                                            <!-- <p *ngIf="RisksStore.individualRiskDetails?.description"
                                            [innerHTML]="RisksStore.individualRiskDetails?.description"></p>
                                        <p *ngIf="!RisksStore.individualRiskDetails?.description">
                                            {{AppStore.noContentText}}</p> -->



                                            <label>{{'risk_treatment_action_plan'|translate}}</label>
                                            <p style="white-space: pre-line;">{{RiskTreatmentStore.riskTreatmentDetails?.description?RiskTreatmentStore.riskTreatmentDetails?.description:AppStore.noContentText}}
                                            </p>
                                        </div>
                                        <div class="row">
                                            <div class="col-xl-3 col-lg-4 col-sm-6">
                                                <h6>{{'start_date'|translate}}</h6>
                                                <p>{{RiskTreatmentStore?.riskTreatmentDetails?.start_date}}
                                                </p>
                                            </div>
                                            <div class="col-xl-3 col-lg-4 col-sm-6">
                                                <h6>{{'target_date'|translate}}</h6>
                                                <p>{{RiskTreatmentStore?.riskTreatmentDetails?.target_date}}
                                                </p>
                                            </div>
                                            <div class="col-xl-6 col-lg-12 col-sm-12">
                                                <div class="label-and-user-pic mb-0">
                                                    <!-- <div class="label-and-user-pic user-big-pic"> -->
                                                    <h6>{{'risk_treatment_owner'|translate}}</h6>
                                                    <app-user-popup-box id="jd"
                                                        *ngIf="RiskTreatmentStore.riskTreatmentDetails?.responsible_user"
                                                        [source]="getPopupDetails(RiskTreatmentStore.riskTreatmentDetails?.responsible_user)">
                                                    </app-user-popup-box>
                                                    <!-- </div> -->
                                                    <div
                                                        *ngIf="!RiskTreatmentStore.riskTreatmentDetails?.responsible_user">
                                                        {{AppStore.noContentText}}</div>
                                                </div>
                                            </div>




                                        </div>



                                    </div>
                                </div>

                            </div>
                            <div class="col-sm-12">

                                <div class="audit-form-table w-100 table-align-top not-fixed-table mb-3"
                                    *ngIf="RiskTreatmentStore.treatmentUpdateDataLoaded && RiskTreatmentStore.historyData.length>0">
                                    <table
                                        class="table table-bordered ordinary-table audit-page-table mb-1 table-scroll">
                                        <thead>
                                            <tr>
                                                <th class="border-top-0 text-center" style="width: 4%;">#</th>
                                                <th class="border-top-0" style="width: 35%;">{{'risk_treatment_actions'|translate}}</th>

                                                <!-- <th class="border-top-0" style="width: 8%;">Responsibility</th> -->
                                                <th class="border-top-0 text-center" style="width: 15%;">%{{'completed'|translate}}</th>
                                                <!-- <th class="border-top-0" style="width: 13%;">Proposed Start Date</th> -->
                                                <th class="border-top-0" style="width: 15%;">{{'actual_start_date'|translate}}</th>
                                                <!-- <th class="border-top-0" style="width: 8%;">Baseline Due Date</th> -->
                                                <th class="border-top-0" style="width: 15%;">{{'revised_due_date'|translate}}</th>
                                                <th class="border-top-0 text-center" style="width: 16%;" colspan="2">{{'status'|translate}}</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr
                                                *ngFor="let history of RiskTreatmentStore.historyData| paginate: {id:'historyUpdate',currentPage:RiskTreatmentStore?.historyCurrentPage, itemsPerPage:RiskTreatmentStore?.historyItemsPerPage,totalItems:RiskTreatmentStore?.historyTotalItems};let num = index">
                                                <td class="text-center">{{num+1}}</td>
                                                <td>{{history.comment?history.comment:AppStore.noContentText}}</td>
                                                <!-- <td></td> -->
                                                <td class="text-center">{{history.percentage?history.percentage:AppStore.noContentText}}
                                                </td>
                                                <td>{{history.actual_start_date?history.actual_start_date:AppStore.noContentText}}
                                                </td>
                                                <!-- <td></td> -->
                                                <td>{{history.revised_target_date?history.revised_target_date:AppStore.noContentText}}
                                                </td>
                                                <!-- <td></td> -->

                                                <td class="text-center">
                                                    <div [ngClass]="'dot-div '+history.label+'-dot'">
                                                        {{history.risk_treatment_status_title}}
                                                    </div>
                                                    <!-- <span
                                                        [ngClass]="'dot-div '+history.label+'-dot'"></span>{{history.risk_treatment_status_title}} -->
                                                </td>
                                                <!-- <td></td> -->

                                            </tr>

                                        </tbody>
                                    </table>
                                    <ul class="pagination justify-content-center mt-3"
                                        *ngIf="RiskTreatmentStore?.historyTotalItems>RiskTreatmentStore?.historyItemsPerPage">
                                        <pagination-controls (pageChange)="historyPageChange($event)"
                                            class="my-pagination" id="historyUpdate"></pagination-controls>
                                    </ul>

                                </div>
                            </div>
                        </div>




                        <div class="row">

                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label for="name">{{'status' | translate}}<sup>*</sup></label>
                                    <!-- <div class="plain-select">
                                    
                                    <select class="form-control" name="test" formControlName="risk_treatment_status_id">
                         <option *ngFor="let status of RiskTreatmentStatusStore.allItems" [value]="status.id">{{status.risk_treatment_status_language_title}}</option>
                      
                       </select>
                                </div> -->
                                    <div class="clearfix">
                                        <div class="multiple-plain-ngselect">

                                            <ng-select [multiple]="false" [attr.placeholder]="'status' | translate"
                                                searchable="false" formControlName="risk_treatment_status_id"
                                                (search)="searchStatus($event)" (clear)="getStatus()"
                                                (open)="getStatus()" (change)="checkForStatus($event)">
                                                <ng-option [value]="status.id" *ngFor="let status of statuses">
                                                    {{status.risk_treatment_status_language_title}}
                                                </ng-option>
                                            </ng-select>
                                            <!-- setValuesToShow('subsidiary',type) -->
                                            <!-- <ng-select [placeholder]="'subsidiaries'|translate" [multiple]="false"
                                                    searchable="true" (search)="searchCountry($event)"
                                                    formControlName="country_id" (clear)="getCountry()"
                                                    (open)="getCountry()">
                                                    <ng-option [value]="type.id"
                                                        *ngFor="let type of SubsidiaryStore.subsidiaryList">
                                                        {{type.title}}
                                                    </ng-option>
                                                </ng-select> -->
                                        </div>
                                        <p class="form-error pt-1"
                                            *ngIf="formErrors&&formErrors.risk_treatment_status_id">
                                            {{formErrors.risk_treatment_status_id[0]}}</p>

                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label for="name">{{'completion_percentage' | translate}}<sup>*</sup></label>
                                    <div class="plain-select">
                                        <select class="form-control" name="test" formControlName="percentage">
                                            <option
                                                [disabled]="(updateForm.value.risk_treatment_status_id==1 || updateForm.value.risk_treatment_status_id==3 || (updateForm.value.risk_treatment_status_id==2 && (i==0 || i==100)))?true:false"
                                                *ngFor="let i of percentage" (change)="checkForPercentage(i)"
                                                [value]="i">{{i}}</option>
                                        </select>
                                        <p class="form-error pt-1" *ngIf="formErrors&&formErrors.percentage">
                                            {{formErrors.percentage[0]}}</p>

                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4"
                            *ngIf="RiskManagementSettingStore.loaded && RiskManagementSettingStore.riskManagementSettings.is_budget">
                            <div class="form-group">
                                <label for="name">{{'amount_used' | translate}}
                                    ({{OrganizationGeneralSettingsStore?.organizationSettings?.currency}})</label>
                                <div class="plain-select input-add-report">
                                    <input type="text" formControlName="amount_used" class="form-control"
                                        [attr.placeholder]="'amount_used'|translate"/>
                                </div>
                                <p class="form-error pt-1"
                                    *ngIf="updateForm?.get('amount_used').invalid && updateForm.value.amount_used">
                                    {{'permit_number_decimals_only'|translate}}</p>
                                <p class="form-error pt-1" *ngIf="formErrors&&formErrors.amount_used">
                                    {{formErrors.amount_used[0]}}</p>
                               
                            </div>
                        </div>
                            <div class="col-sm-12" *ngIf="OrganizationModulesStore.checkIndividualSubModule(900,33101)">
                                <div class="form-group">
                                    <label for="name">{{'risk_treatment_actions'|translate}}</label>
                                    <textarea class="form-control " rows="3" id="comment" formControlName="comment"
                                        [placeholder]="'enter_risk_treatment_actions'|translate"></textarea>
                                    <p class="form-error pt-1" *ngIf="formErrors&&formErrors.comment">
                                        {{formErrors.comment[0]}}</p>
                                </div>

                            </div>

                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="name">{{'actual_start_date'|translate}}</label>
                                    <div class="input-group date-picker input-clear-btn-main">
                                        <input formControlName="actual_start_date" class="form-control bg-white"
                                            placeholder="yyyy-mm-dd" id="start_date" [readonly]="true"
                                            [maxDate]="{year: updateForm.value.revised_target_date?.year?this.updateForm.value.revised_target_date?.year:null, month: updateForm.value.revised_target_date?.month?this.updateForm.value.revised_target_date?.month:null, day: updateForm.value.revised_target_date?.day?this.updateForm.value.revised_target_date?.day-1:null}"
                                            ngbDatepicker #startInput="ngbDatepicker"><span
                                            *ngIf="updateForm.value.actual_start_date" aria-hidden="true"
                                            (click)="clear('start_date')" style="border:none;"
                                            class="input-clear-btn">×</span>

                                        <div class="input-group-append">
                                            <button class="btn btn-outline-secondary calendar"
                                                (click)="startInput.toggle()" type="button"><i
                                                    class="fas fa-calendar-alt"></i></button>
                                        </div>
                                        <!-- <input formControlName="start_date" class="form-control cal3" placeholder="Enter Field Name"> -->
                                    </div>
                                    <p class="form-error pt-1" *ngIf="formErrors&&formErrors.actual_start_date">
                                        {{formErrors.actual_start_date[0]}}</p>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="name">{{'revised_due_date'|translate}}</label>
                                    <div class="input-group date-picker input-clear-btn-main">
                                        <!-- <input formControlName="target_date" class="form-control cal4"
                                        placeholder="Enter Field Name"> -->
                                        <input formControlName="revised_target_date" class="form-control bg-white"
                                            placeholder="yyyy-mm-dd" id="target_date" ngbDatepicker [readonly]="true"
                                            [minDate]="{year: this.updateForm.value.actual_start_date?.year, month: this.updateForm.value.actual_start_date?.month, day: this.updateForm.value.actual_start_date?.day+1}"
                                            #endInput="ngbDatepicker"><span aria-hidden="true"
                                            *ngIf="updateForm.value.revised_target_date" (click)="clear('target_date')"
                                            style="border:none;" class="input-clear-btn">×</span>
                                        <div class="input-group-append">
                                            <button class="btn btn-outline-secondary calendar"
                                                (click)="endInput.toggle()" type="button"><i
                                                    class="fas fa-calendar-alt"></i></button>
                                        </div>
                                    </div>
                                    <p class="form-error pt-1" *ngIf="formErrors&&formErrors.revised_target_date">
                                        {{formErrors.revised_target_date[0]}}</p>
                                </div>
                            </div>

                        </div>

                        <label class="label-style mb-0">{{'evidences'|translate}}</label>
                        <div class="scroll-documents" #uploadArea>
                            <div class="row m-0 upload-section" style="padding-top: 0">
                                <div class="col-lg-3 col-sm-4 costmz-logo-new mt-2">
                                    <div class="question-circle-inp"
                                        *ngIf="OrganizationGeneralSettingsStore.organizationSettings?.support_file_allowed_types.length > 0"
                                        style="margin-right: 7px;">
                                        <i class="far fa-question-circle"></i>
                                        <div class="message-password-inp">
                                            <p class="mb-0">{{'allowed_file_types' | translate}}
                                                {{OrganizationGeneralSettingsStore.organizationSettings?.support_file_allowed_types.toString()}}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="form-group form-group-upload">
                                        <div class="darag-dropifile-upload">
                                            <div class="d-flex justify-content-center align-items-center text-center">
                                                <div>
                                                    <img src="assets/images/drag-pic.png" alt="image"
                                                        class="drag-pic-files">
                                                    <div class="drag-file-name"> {{'drag_drop_file_here'|translate}}
                                                    </div>
                                                    <div class="upload-btn-wrapper">
                                                        <input type="file" multiple name="myfile"
                                                            (change)="onFileChange($event,'support-file')"
                                                            accept="application/msword, application/pdf, image/* " />
                                                        <button class="btn">{{'browse_files'|translate}}</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div [ngClass]="files.success? 'col-lg-3 col-sm-4 up-pic-cf mt-2 hide_loader' : 'col-lg-3 col-sm-4 up-pic-cf mt-2'"
                                    *ngFor="let files of fileUploadsArray">
                                    <div class="upload-pics edit-option file-upload-loader">
                                        <circle-progress class="browse-form-pic" [percent]=fileUploadProgress
                                            [title]=fileUploadProgress>
                                        </circle-progress>
                                    </div>
                                </div>


                                <div [ngClass]="doc.is_deleted ? 'col-lg-3 col-sm-4 up-pic-cf mt-2 image_deleted':'col-lg-3 col-sm-4 up-pic-cf mt-2'"
                                    *ngFor="let doc of RiskTreatmentStore.getDocumentDetails">
                                    <div class="upload-pics edit-option">
                                        <div *ngIf="doc.preview" class="browse-form-pic"
                                            [ngStyle]="{'background': 'url(' + doc.preview + ') no-repeat 0 0 / cover'}">
                                        </div>
                                        <div class="browse-form-name clearfix">
                                            <div class="float-left">
                                                <h6 [attr.title]="doc.name.length>15?doc.name:''">
                                                    {{doc.name.length>15?doc.name.substring(0,15)+' ...':doc.name}}
                                                </h6>
                                                <span>{{doc.size/1048576 | number:'0.2-2'}}MB</span>
                                            </div>
                                            <div class="browse-logo">
                                                <img *ngIf="checkExtension(doc.ext,'excel') != -1"
                                                    src="/assets/images/md-xl.png">
                                                <img *ngIf="checkExtension(doc.ext,'image') != -1"
                                                    src="/assets/images/md-jpg.png">
                                                <img *ngIf="checkExtension(doc.ext,'doc') != -1"
                                                    src="/assets/images/md-doc.png">
                                                <img *ngIf="checkExtension(doc.ext,'pdf') != -1"
                                                    src="/assets/images/md-pdf.png">
                                                <img *ngIf="checkExtension(doc.ext,'video') != -1"
                                                    src="/assets/images/md-video.png">
                                                <img *ngIf="checkExtension(doc.ext,'audio') != -1"
                                                    src="/assets/images/md-audio.png">
                                                <img *ngIf="checkExtension(doc.ext,'ppt') != -1"
                                                    src="/assets/images/md-ppt.png">

                                            </div>
                                        </div>
                                        <div class="edit-option-show">
                                            <a (click)="removeDocument(doc.token)"><i class="fas fa-trash"></i></a>
                                        </div>

                                    </div>

                                </div>

                            </div>
                        </div>
                        <p style="color: red;" *ngIf="formErrors&&formErrors.documents">
                            {{formErrors.documents[0]}}</p>


                        <div class="row">
                            <div class="col-sm-12">
                                <div class="d-block justify-content-left border-0 mt-3">
                                    <button type="button" data-toggle="modal" (click)="updateTreatment()"
                                        class="btn ordinary-btn mr-3 btn-active">{{AppStore.loading?getButtonText('loading'):getButtonText('save')}}</button>
                                    <button type="button" data-toggle="modal" (click)="updateTreatment(true)"
                                        class="btn ordinary-btn mr-3">{{AppStore.loading?getButtonText('loading'):getButtonText('save_close')}}</button>
                                    <button type="button" data-toggle="modal" (click)="closeUpdateModal()"
                                        class="btn ordinary-btn mr-2">{{AppStore.loading?getButtonText('loading'):getButtonText('cancel')}}</button>
                                </div>
                            </div>
                        </div>

                    </form>

                </div>

            </div>
        </div>
    </div>



    <!-- risk-update-popup End -->
</ng-container>
<ng-container *ngIf="RisksStore.individual_risk_loaded && !(RisksStore.individualRiskDetails?.is_analysis_performed)">
    <app-no-data [border]=false></app-no-data>
</ng-container>

<div class="modal modal-style-1 fade popup-full-width small-step-form-popup" id="perform-now-popup"
    data-keyboard="false" data-backdrop="static" *ngIf="treatmentPopupOpened" #treatmentPopup>
    <button type="button" class="close" data-dismiss="modal"><i class="lni-close"></i><span>{{'esc' |
            translate}}</span></button>
    <app-add-risk-treatment></app-add-risk-treatment>
</div>

<!------------------- Delete Confirmation Modal Start --------------------------->

<div class="modal modal-style-1 fade" id="delete-popup" data-backdrop="static" data-keyboard="false" #deletePopup>
    <app-delete-popup [source]="deleteObject"></app-delete-popup>
</div>

<!------------------- Delete Confirmation Modal End --------------------------->

<div class="modal modal-style-1 fade popup-full-width" id="risk-update-treatment-popup" data-keyboard="false"
    data-backdrop="static" #historyPopup *mobxAutorun>
    <button type="button" class="close" (click)="closeHistoryModal()"><i class="lni-close"></i><span>{{'esc' |
            translate}}</span></button>
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h4
                    [ngClass]="RiskTreatmentStore.treatmentUpdateDataLoaded && RiskTreatmentStore.historyData.length>0?'modal-title text-center':'modal-title'">
                    {{'risk_treatment_update_history' | translate}}</h4>
            </div>

            <div class="modal-body form-body">

                <div class="row">
                    <div class="col-sm-12"
                        *ngIf="RiskTreatmentStore.treatmentUpdateDataLoaded && RiskTreatmentStore.historyData.length>0">
                        <div class="cmn-bdr risk-treatment-update-history mb-3"
                            *ngFor="let history of RiskTreatmentStore.historyData| paginate: {id:'history',currentPage:RiskTreatmentStore?.historyCurrentPage, itemsPerPage:RiskTreatmentStore?.historyItemsPerPage,totalItems:RiskTreatmentStore?.historyTotalItems};let num = index">
                            <div class="row mb-3 align-items-center">
                                <div class="col-lg-6 col-sm-12">
                                    <div class="d-flex flex-row user-list-sm p-0">
                                        <img [attr.src]="history.created_by_image_token?createImageUrl('user',history.created_by_image_token):getDefaultImage('user-logo')"
                                            class="rounded-circle" width="30px" height="30px">
                                        <div>
                                            <h6>{{history.created_by_first_name}} {{history.created_by_last_name}}</h6>
                                            <span>{{history.created_by_designation}} | {{'updated_at'|translate}}
                                                {{history.created_at|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-12">
                                    
                                    <div [ngClass]="'dot-div '+history.label+'-dot'">
                                        {{history.risk_treatment_status_title}}
                                    </div>
                                    <!-- <p class="dot-color-p mb-0 d-inline-block"><span
                                            [ngClass]="history.label?'dot-div '+history.label+'-dot':'dot-div green-dot'"
                                            [ngClass]="'dot-div '+history.label+'-dot'"></span>{{history.risk_treatment_status_title}}
                                    </p> -->
                                    <h6 class="d-inline-block text-light-blue bold mb-0 cmn-head-style ml-3">
                                        {{history.percentage?history.percentage:0}}%</h6>
                                </div>
                                <div class="col-lg-3 col-sm-12"
                                    *ngIf="RiskManagementSettingStore.loaded && RiskManagementSettingStore.riskManagementSettings.is_budget">
                                    <h3 class="price-text-cmn mb-0">
                                        {{OrganizationGeneralSettingsStore?.organizationSettings?.currency}}
                                        {{history.amount_used?history.amount_used:0}}</h3>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-lg-6 col-sm-12">
                                    <h6>{{'actual_start_date'|translate}}</h6>
                                    <p *ngIf="history.actual_start_date">{{history.actual_start_date|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
                                    <p *ngIf="!history.actual_start_date">{{AppStore.noContentText}}</p>
                                
                                </div>
                                <div class="col-lg-6 col-sm-12">
                                    <h6>{{'revised_due_date'|translate}}</h6>
                                    <p *ngIf="history.revised_target_date">{{history.revised_target_date|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
                                    <p *ngIf="!history.revised_target_date">{{AppStore.noContentText}}</p>
                             
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-12">
                                    <p>{{history.comment?history.comment:''}}</p>
                                </div>
                            </div>
                            <div class="row" *ngIf="history.documents.length>0">
                                <div class="col-sm-12">
                                    <h6>{{'attachments' | translate}}</h6>
                                    <div class="thumb-pics-bg thumb-pics-col-3 clearfix">
                                        <div class="thumb-pics" *ngFor="let document of history.documents">
                                            <div class="upload-pics upload-pics-small edit-option">
                                                <div class="browse-form-pic"
                                                    [ngStyle]="{'background': 'url(' + createImageUrl('document',document.token) + '), url(' + getDefaultImage('no-preview') + ') no-repeat 0 0 / cover'}"
                                                    (click)="viewDocument(document,history.id)">
                                                </div>
                                                <div class="browse-form-name clearfix">
                                                    <div class="float-left">
                                                        <h6
                                                            [attr.title]="document.title.length > 10 ? document.title:''">
                                                            {{document.title.length > 10 ?
                                                            document.title.substring(0,10)+' ...': document.title}}
                                                        </h6>
                                                        <span>{{document.size/1048576 | number:'0.2-2'}}MB</span>
                                                    </div>
                                                    <div class="browse-logo">
                                                        <img *ngIf="checkExtension(document.ext,'image') != -1"
                                                            src="/assets/images/md-jpg.png">
                                                        <img *ngIf="checkExtension(document.ext,'doc') != -1"
                                                            src="/assets/images/md-doc.png">
                                                        <img *ngIf="checkExtension(document.ext,'pdf') != -1"
                                                            src="/assets/images/pdf-icone.png">
                                                        <img *ngIf="checkExtension(document.ext,'excel') != -1"
                                                            src="/assets/images/md-xl.png">
                                                        <img *ngIf="checkExtension(document.ext,'video') != -1"
                                                            src="/assets/images/md-video.png">
                                                        <img *ngIf="checkExtension(document.ext,'audio') != -1"
                                                            src="/assets/images/md-audio.png">
                                                        <img *ngIf="checkExtension(document.ext,'ppt') != -1"
                                                            src="/assets/images/md-ppt.png">

                                                    </div>
                                                </div>
                                                <div class="edit-option-show-inner">
                                                    <a [attr.title]="'download'|translate"
                                                        (click)="downloadDocument(document.risk_treatment_update_id,document.title,document.id,document)"><i
                                                            class="fas fa-download"></i></a>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- <div class="col-xl-2" *ngFor="let document of row.jd?.documents">
                        <div class="upload-pics upload-pics-small edit-option">
                          <div class="browse-form-pic"
                            [ngStyle]="{'background': 'url(' + createImagePreview('user-jobs',document.token) + '), url(' + getDefaultImage('no-preview') + ') no-repeat 0 0 / cover'}"
                            (click)="viewDocument(document)">
                          </div>
                          <div class="browse-form-name clearfix">
                            <div class="float-left">
                              <h6 [attr.title]="document.title.length > 10 ? document.title:''">
                                {{document.title.length > 10 ? document.title.substring(0,10)+' ...': document.title}}
                              </h6>
                              <span>{{document.size/1048576 | number:'0.2-2'}}MB</span>
                            </div>
                            <div class="browse-logo">

                              <img *ngIf="checkExtension(document.ext,'image') != -1" src="/assets/images/md-jpg.png">
                              <img *ngIf="checkExtension(document.ext,'doc') != -1" src="/assets/images/md-doc.png">
                              <img *ngIf="checkExtension(document.ext,'pdf') != -1" src="/assets/images/pdf-icone.png">
                              <img *ngIf="checkExtension(document.ext,'excel') != -1" src="/assets/images/md-xl.png">
                              <img *ngIf="checkExtension(document.ext,'video') != -1" src="/assets/images/md-video.png">
                              <img *ngIf="checkExtension(document.ext,'audio') != -1" src="/assets/images/md-audio.png">
                              <img *ngIf="checkExtension(document.ext,'ppt') != -1" src="/assets/images/md-ppt.png">

                            </div>
                          </div>
                          <div class="edit-option-show-inner">
                            <a class="pointer" [attr.title]="'download'|translate"><i class="fas fa-download"
                                (click)="downloadDocument(document.jd_id,document.title,document.id,document)"></i></a>

                          </div>
                        </div>
                      </div> -->

                                    </div>
                                    <!-- <div class="thumb-pics-bg thumb-pics-col-3 clearfix">
                                       <div class="thumb-pics">
                                          <div class="upload-pics upload-pics-small edit-option">
                                             <div class="browse-form-pic" style="background: url(images/mba.jpg) no-repeat;">
                                             </div>
                                              <div class="browse-form-name clearfix">
                                               <div class="float-left">
                                                <h6>Certificate.png</h6>
                                                <span>96KB</span>
                                               </div>
                                               <div class="browse-logo">
                                                 <img src="images/md-xl.png">
                                               </div>
                                              </div>
                                              <div class="edit-option-show-inner">
                                               <a href="#"><i class="fas fa-download"></i></a>
                                             </div>
                                           </div>
                                        </div>
                                       <div class="thumb-pics">
                                          <div class="upload-pics upload-pics-small edit-option">
                                             <div class="browse-form-pic" style="background: url(images/mba.jpg) no-repeat;">
                                             </div>
                                              <div class="browse-form-name clearfix">
                                               <div class="float-left">
                                                <h6>Certificate.png</h6>
                                                <span>96KB</span>
                                               </div>
                                               <div class="browse-logo">
                                                 <img src="images/md-xl.png">
                                               </div>
                                              </div>
                                              <div class="edit-option-show-inner">
                                               <a href="#"><i class="fas fa-download"></i></a>
                                             </div>
                                           </div>
                                        </div>
                                       </div> -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- <div class="col-sm-12" *ngIf="RisksStore?.totalItems>RisksStore?.itemsPerPage"> -->
                        <ul class="pagination justify-content-center mt-3"
                            *ngIf="RiskTreatmentStore?.historyTotalItems>RiskTreatmentStore?.historyItemsPerPage">
                            <pagination-controls (pageChange)="historyPageChange($event)" class="my-pagination"
                                id="history"></pagination-controls>
                        </ul>

                        <!-- </div> -->
                    </div>
                    <div class="col-sm-12"
                        *ngIf="RiskTreatmentStore.treatmentUpdateDataLoaded && RiskTreatmentStore.historyData.length==0">
                        <app-no-data-list [source]="historyEmptyList" [border]=false>

                        </app-no-data-list>
                    </div>
                </div>









                <!-- <div class="row">
                        <div class="col-sm-12">
                            <div class="d-block justify-content-left border-0 mt-3">
                                <button type="button" data-toggle="modal" data-target="#signal-lost" class="btn ordinary-btn mr-3 btn-active">Save</button>
                                <button type="button" data-toggle="modal" data-target="#signal-lost" class="btn ordinary-btn mr-3">Save & Close</button>
                                <button type="button" data-toggle="modal" data-target="#error-message" class="btn ordinary-btn mr-2">Cancel</button>
                            </div>
                        </div>
                    </div> -->
            </div>

        </div>
    </div>
</div>
<!-- risk-update-treatment-popup End -->


<!-- preview component for image preview -->
<div class="modal modal-style-1 popup-full-width fade popup-new-type" id="add-three-popup" data-keyboard="false"
    data-backdrop="static" #filePreviewModal *mobxAutorun>
    <button type="button" class="close" data-dismiss="modal" (click)="closePreviewModal($event)"><i
            class="lni-close"></i><span>{{'esc'|translate}}</span></button>
    <app-risk-preview-modal *ngIf="previewObject" [source]="previewObject" (close)="closePreviewModal($event)">
    </app-risk-preview-modal>
</div>
<!-- preview modal end -->