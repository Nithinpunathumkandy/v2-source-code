
<ng-container *mobxAutorun>
    <div *ngIf="!EADashboardStore?.dashboardLoaded">
        <app-ea-dashboard-loader></app-ea-dashboard-loader>
    </div>
</ng-container>
  <nav class="edit-bar" data-toggle="affix">
    <div class="module-name-block module-name-block-space float-left">
        <a class="dropdown module-title">
            {{'external_audit_dashboard' | translate}}
        </a>
    </div>
    


    <ul class="nav nav-pills edit-icons float-right d-none d-xl-block" role="tablist">
        <li>
            <button type="button" (click)="goToFindingDetails()"  class="btn btn-small btn-header-db mr-2">{{'finding_details' | translate}}</button>
        </li>
        <li>
            <button type="button" (click)="goToPendingCA()" class="btn btn-small btn-header-db">{{'pending_ca' | translate}}</button>
        </li>
    </ul>
</nav>

<main class="mt-3 acl-page cpf-space-adjust db-small-space-boxes db-layout-150" *mobxAutorun>
    <div class="container-fluid" *ngIf="EADashboardStore.dashboardLoaded">
        <app-filter-menu></app-filter-menu>
        <div class="row sm-row">
            <div class="col-xl-2 col-lg-3 col-sm-12 sm-col">
                <div style="cursor: pointer;" (click)="goToExternalAudit()" class="bg-white btm-space-10 db-shadow">
                  <div class="db-md-screen-center kpi-db-box-one-height">
                       <div class="text-center">
                           <h3 style="cursor: pointer;"  class="big-text-three">{{EADashboardStore.EACounts?.ea_count}}</h3>
                           <p style="cursor: pointer;" class="mb-0 text-black">{{'audits' | translate}}</p>
                       </div>
                   </div>        
                </div>
              </div>
              <div class="col-xl-10 col-lg-9 col-sm-12 sm-col">
                <div class="bg-white btm-space-10 db-shadow">
                 <div class="row sm-row align-items-center kpi-db-box-one-height">
                      <div class="col-md-2 sm-col border-right">
                          <div class="text-center">
                              <h3 style="cursor: pointer;" (click)="goToFindings()" class="big-text-four">{{EADashboardStore.EACounts?.ea_finding_count}}</h3>
                              <p style="cursor: pointer;" class="mb-0 text-black elips-1">{{'findings' | translate}}</p>
                          </div>
                      </div>
                      <div class="col-md-7 sm-col text-center">
                        <div class="" style="height: 50px;">
                            <div id="mCSB_1" class="mCustomScrollBox mCS-light mCSB_vertical mCSB_inside" style="max-height: none;" tabindex="0">
                          <div id="mCSB_1_container" class="mCSB_container" style="position: relative; top: -27px; left: 0px;" dir="ltr" >
                            
                                <div class="row sm-row left-space-ea-db-one-40">
                            <div style="cursor: pointer;" (click)="goToFindingcategory(cat.id)" class="col-sm-4" *ngFor=" let cat of EADashboardStore.EACountsByCategory">
                                <div class="text-left">
                                    <h3 class="big-text-one">{{cat.count}}</h3>
                                    <p [ngClass]="'dot-div-new dot-'+cat.label+' mb-0 font-normal elips-1'">{{cat.title}}</p>
                                </div>
                            </div>
                            <!-- <div class="col-sm-4">
                                <div class="text-left">
                                    <h3 class="big-text-one">50</h3>
                                    <p class="dot-div-new dot-yellow mb-0 font-normal elips-1">Minor NC</p>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="text-left">
                                    <h3 class="big-text-one">50</h3>
                                    <p class="dot-div-new dot-green mb-0 font-normal elips-1">OFI</p>
                                </div>
                            </div> -->
                        </div>  
                        </div>
                        <div id="mCSB_1_scrollbar_vertical" class="mCSB_scrollTools mCSB_1_scrollbar mCS-light mCSB_scrollTools_vertical" style="display: block;"><div class="mCSB_draggerContainer"><div id="mCSB_1_dragger_vertical" class="mCSB_dragger" style="position: absolute; min-height: 30px; display: block; height: 17px; max-height: 40px; top: 6px;"><div class="mCSB_dragger_bar" style="line-height: 30px;"></div></div><div class="mCSB_draggerRail"></div></div></div>
                        </div>
                          </div>
                      </div>
                      <div class="col-md-3 sm-col">
                        <div class="clearfix round-type-status-main-bg">
                              <div class="round-type-status-main"
                              >
                                  <div class="open-close-status-db open-close-status-db-left d-flex align-items-center status-closed">
                                      <div class="round-type-status-value">
                                          <h6 class="mb-0">{{EADashboardStore.EACountsByStatus[0]?.percentage}}%</h6>
                                      </div>
                                      <div class="round-type-status-bg rounded-circle">
                                          <div style="cursor: pointer" (click)="gotFindingStatus(EADashboardStore.EACountsByStatus[0]?.id)" class="round-type-status rounded-circle">
                                              <h5  >{{'open' | translate}}</h5>
                                              <h6 style="cursor: pointer" class="mb-0">{{EADashboardStore.EACountsByStatus[0]?.count?EADashboardStore.EACountsByStatus[0]?.count:'0'}}</h6>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              <div class="round-type-status-main">
                                  <div class="open-close-status-db open-close-status-db-right d-flex align-items-center status-open">
                                      <div class="round-type-status-bg rounded-circle">
                                          <div style="cursor: pointer" (click)="gotFindingStatus(EADashboardStore.EACountsByStatus[1]?.id)" class="round-type-status rounded-circle">
                                              <h5 style="cursor: pointer" >{{'closed' | translate}}</h5>
                                              <h6 style="cursor: pointer" class="mb-0">{{EADashboardStore.EACountsByStatus[1]?.count?EADashboardStore.EACountsByStatus[1]?.count:'0'}}</h6>
                                          </div>
                                      </div>
                                      <div class="round-type-status-value">
                                          <h6 class="mb-0">{{EADashboardStore.EACountsByStatus[1]?.percentage}}%</h6>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
           </div>
        </div>

        <div class="row sm-row">
            <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'audit_by_type' | translate}}</h5>
                    <hr>
                    <div class="text-center ia-db-finding-division db-md-screen-center finding-sec-height-ia-db"
                    *ngIf="EADashboardStore.EACountsByType.length!=0">
                        <div id="AuditTypePieChart" style="height: 250px; width: 100%;"></div>
                    </div>
                    <div class="text-center ia-db-finding-division db-md-screen-center finding-sec-height-ia-db"
                    *ngIf="EADashboardStore.EACountsByType.length==0">
                        <app-no-chart-data [source]="'pie'" style="height: 250px; width: 100%;"></app-no-chart-data>
                    </div>

                </div>
            </div>
            <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'corrective_action_by_status' | translate}}</h5>
                    <hr>
                    <div class="text-center ia-db-finding-department db-md-screen-center finding-sec-height-ia-db"
                    *ngIf="EADashboardStore.FindingCACountByStatus.length!=0">
                        <div id="FindingCAStatusPieChart" style="height: 200px; width: 100%;"></div>
                    </div>
                    <div class="text-center ia-db-finding-department db-md-screen-center finding-sec-height-ia-db"
                    *ngIf="EADashboardStore.FindingCACountByStatus.length==0">
                        <app-no-chart-data [source]="'bar'" style="height: 200px; width: 100%;"></app-no-chart-data>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{'ea_db_audit_by_ms_types' | translate}}</h5>
                    <hr>
                    <div class="text-center ia-db-finding-department db-md-screen-center finding-sec-height-ia-db"
                    *ngIf="EADashboardStore.EACountByMsType.length != 0">
                        <div id="msTypePieChart" style="height: 250px; width: 100%;"></div>
                    </div>
                    <div class="text-center ia-db-finding-department db-md-screen-center finding-sec-height-ia-db"
                    *ngIf="EADashboardStore.EACountByMsType.length == 0">
                        <app-no-chart-data [source]="'pie'" style="height: 250px; width: 100%;"></app-no-chart-data>
                    </div>
                </div>
            </div>
        </div>  




    </div>
</main>