<div #plainDev></div>
<div class="widget">
    <nav class="edit-bar" data-toggle="affix" #navBar>
        <app-sub-menu>-</app-sub-menu>
        <!-- <app-sub-menu-drop-down></app-sub-menu-drop-down> -->
        <div class="module-name-block module-name-block-space float-left">
            <a style="cursor: default;" class="dropdown module-title">{{'auditable_items'|translate}}</a>
          </div>
        <!-- <ul class="nav nav-pills float-left d-none d-lg-block" role="tablist">
            <li class="nav-item">
                <a class="nav-link nav-link-show" [routerLink]="['/internal-audit/auditable-items']"
                    routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">{{'auditable_items' | translate}}</a>
        </ul> -->
    </nav>
    <main class="mt-3 control-list-page">
        <div class="container-fluid">
            <app-filter-menu></app-filter-menu>
            <div class="control-program-box control-page-table-main">
               
                <div class="row">
                   
                    <div class="col-sm-12">
                        <div class="full-width-table">
                        
                        <table class="table table-bordered ordinary-table table-hover mb-1 issue-list-table-org" *ngIf="AuditableItemMasterStore?.loaded">


                            <tr *ngIf="AuditableItemMasterStore.allItems.length>0">
                                <th style="width: 3%; text-align: center;">{{'sl' | translate}}</th> 
                                <th (click)="sortTitle('auditable_items.reference_code')" class="border-top-0 issue-list-org-tab-three pointer" style="width: 8%;">
                                    <span>{{'ref_no' | translate}}</span>  
                                    <img _ngcontent-twv-c17="" *ngIf="AuditableItemMasterStore.orderItem=='auditable_items.reference_code'"
                                    [attr.src]="AuditableItemMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'" 
                                    class="sort-down-pics">
                                </th>
                                <th (click)="sortTitle('auditable_items.title')"
                                    class="border-top-0 issue-list-org-tab-three pointer" style="width: 37%;">
                                    <span>{{'auditable_items' | translate}}</span>  
                                    <img _ngcontent-twv-c17="" *ngIf="AuditableItemMasterStore.orderItem=='auditable_items.title'"
                                    [attr.src]="AuditableItemMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'" 
                                    class="sort-down-pics">
                                </th>
                                <th (click)="sortTitle('auditable_items.auditable_item_category')"
                                    class="border-top-0 issue-list-org-tab-three pointer" style="width: 15%;">
                                    {{'auditable_item_categories' | translate}}
                                    <img _ngcontent-twv-c17="" *ngIf="AuditableItemMasterStore.orderItem=='auditable_items.auditable_item_category'"
                                    [attr.src]="AuditableItemMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'" 
                                    class="sort-down-pics">
                                </th>
                                <th (click)="sortTitle('auditable_items.auditable_item_type')"
                                    class="border-top-0 issue-list-org-tab-three pointer" style="width: 13%;">
                                    {{'auditable_item_types' | translate}}
                                    <img _ngcontent-twv-c17="" *ngIf="AuditableItemMasterStore.orderItem=='auditable_items.auditable_item_type'"
                                    [attr.src]="AuditableItemMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'" 
                                    class="sort-down-pics">
                                </th>


                                <th style="width: 10%;"
                                (click)="sortTitle('auditable_items.risk_rating')"
                                    class="border-top-0 issue-list-org-tab-three pointer"
                            
                                > <span>{{'risk_rating' | translate}}</span>
                            
                                <img _ngcontent-twv-c17="" *ngIf="AuditableItemMasterStore.orderItem=='auditable_items.risk_rating'"
                                [attr.src]="AuditableItemMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'" 
                                class="sort-down-pics">
                            
                            </th>
                                <th style="width: 11%;" class="text-center">{{'status' | translate}}</th>

                            </tr>
                            <ng-container *mobxAutorun>
                                <tr 
                                    *ngFor="let row of AuditableItemMasterStore.allItems| paginate: {currentPage:AuditableItemMasterStore.currentPage, itemsPerPage:AuditableItemMasterStore.itemsPerPage,totalItems:AuditableItemMasterStore.totalItems};let num=index "
                                    class="cursor-pointer tr-action edit-and-delete-main"
                                    >
                                    <td style="text-align: center;" class="cursor-pointer" (click)="getAuditableItem(row.id)" >
                                        {{(AuditableItemMasterStore.currentPage - 1) * AuditableItemMasterStore.itemsPerPage + (num + 1)}}
                                    </td>

                                    <td class="cursor-pointer" (click)="getAuditableItem(row.id)" >#{{row.reference_code}}</td>
                                    <td class="cursor-pointer" (click)="getAuditableItem(row.id)" >{{row.title}}
                                    </td>
                                    <td class="cursor-pointer" (click)="getAuditableItem(row.id)" >
                                        {{row.auditable_item_category ? row.auditable_item_category : AppStore.noContentText}}
                                    </td>

                                    <td class="cursor-pointer" (click)="getAuditableItem(row.id)" > {{row.auditable_item_type ? row.auditable_item_type : AppStore.noContentText}}</td>
                                    <td class="cursor-pointer" (click)="getAuditableItem(row.id)" *ngIf="row.risk_rating!=null">

                                        <div>{{row.risk_rating}}</div>
                                          <!-- <div *ngIf="row.risk_rating=='Medium'" class="dot-div yellow-dot">{{row.risk_rating}} </div>
                                          <div *ngIf="row.risk_rating=='Low'" class="dot-div green-dot">{{row.risk_rating}} </div>
                                          <div *ngIf="row.risk_rating=='Very High'" class="dot-div red-dot">{{row.risk_rating}} </div> -->
                                       </td>
                                       <td class="cursor-pointer" (click)="getAuditableItem(row.id)" *ngIf="row.risk_rating==null">

                                        {{ AppStore.noContentText}}
                                       </td>

                                    <td style="padding:0.75rem;" class="text-center">
                                        <div *ngIf="row.status_id==1" class="dot-div green-dot">{{row.status}} </div>
                                        <div *ngIf="row.status_id==2" class="dot-div red-dot">{{row.status}}</div> 
                                        <div class="edit-option-show">
                                            <a title="Edit" *ngIf = "AuthStore.getActivityPermission(1000,'UPDATE_AUDITABLE_ITEM')" (click)="editAuditableItem(row.id)"><i
                                                    class="fas fa-pen pointer"></i></a>
                                            <a (click)="delete(row.id)" title="Delete" *ngIf = "AuthStore.getActivityPermission(1000,'DELETE_AUDITABLE_ITEM')"><i
                                                    class="fas fa-trash pointer"></i></a>
                                            <a *ngIf="row.status_id == AppStore.inActiveStatusId && AuthStore.getActivityPermission(1000,'ACTIVATE_AUDITABLE_ITEM')"  (click)="activate(row.id)"
                                                title="Activate" ><i class="fas fa-check pointer"></i></a>
                                            <a *ngIf="row.status_id == AppStore.activeStatusId && AuthStore.getActivityPermission(1000,'DEACTIVATE_AUDITABLE_ITEM')" (click)="deactivate(row.id)"
                                                title="Deactivate"><i class="fas fa-ban pointer"></i></a>
                                        </div>
                                    </td>
                                </tr>
                            </ng-container>
                        </table>
                        </div>
                        <p class="float-right bold" *ngIf="AuditableItemMasterStore?.loaded && AuditableItemMasterStore.totalItems > 0">Total Items:{{AuditableItemMasterStore?.totalItems}}</p>
                       
                        <ng-container *mobxAutorun>
                            <div *ngIf="!AuditableItemMasterStore.loaded">
                                <app-auditable-item-loader></app-auditable-item-loader>
                            </div>

                            <app-no-data *ngIf="AuditableItemMasterStore.totalItems == 0 && AuditableItemMasterStore.loaded == true"></app-no-data>
                        </ng-container>

                        <div *ngIf="AuditableItemMasterStore.totalItems>AuditableItemMasterStore.itemsPerPage"
                            class="col-sm-12">
                            <ul class="pagination justify-content-center mt-3">
                                <div class="list">
                                    <pagination-controls (pageChange)="pageChange($event)" class="my-pagination">
                                    </pagination-controls>
                                </div>
                            </ul>
                        </div>
                       
                    </div>
                </div>
            </div>
        </div>
    </main>



</div>


<!-- Modal part -->

<!-- <div class="modal modal-style-1 popup-full-width fade" data-keyboard="false" data-backdrop="static" #formModal>
    <app-auditable-item-modal *ngIf="auditableItemObject.type" [source]="auditableItemObject">
    </app-auditable-item-modal>
</div> -->

<!------------------- Delete Confirmation Modal Start --------------------------->

<div class="modal modal-style-1 fade" id="delete-popup" #confirmationPopUp data-backdrop="static" data-keyboard="false">
    <app-delete-popup [source]="popupObject"></app-delete-popup>
</div>


<!-- calling import Risk modal -->

<div class="modal modal-style-1 popup-full-width fade" data-keyboard="false" data-backdrop="static" #importRiskPopup>
    <app-import-risk-modal *ngIf="importRiskObject.type" [source]="importRiskObject">

    </app-import-risk-modal>

</div>

<!-- calling import Process modal -->

<div class="modal modal-style-1 popup-full-width fade" data-keyboard="false" data-backdrop="static" #importProcessPopup>
    <app-import-process-modal  *ngIf="importProcessObject.type" [source]="importProcessObject">

    </app-import-process-modal>

</div>
