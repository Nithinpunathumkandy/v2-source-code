<nav class="edit-bar" data-toggle="affix" scrollPoint #navigationBar *mobxAutorun>
   <app-breadcrumb-menu></app-breadcrumb-menu>

   <app-sub-menu></app-sub-menu>
   <!-- <app-sub-menu-drop-down></app-sub-menu-drop-down> -->
</nav>
<main class="audit-program-details-page mt-3">
   <div class="container-fluid" *ngIf="AuditPlanScheduleMasterStore.individualLoaded">
      <div class="row" *mobxAutorun>
         <div class="col-sm-12">

            <!-- Profille -->

            <div class="widget">
               <div class="widget-body-light issuue-new-style p-0">
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="row">
                           <div class="col-sm-12 col-lg-8 padding-right-0">
                              <div class="widg-padding-cmn bg-white">
                                 <div class="issue-top-sec">
                                    <div class="clearfix">
                                       <h5 class="d-inline-block cmn-head-style label-tag-style"><span
                                             class="issue-smoal-head-text">#{{AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.reference_code}}</span>
                                          {{AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.department?.title}}
                                          <span class="draft-tag label-tag-style-tag label-left-arow-tag"
                                             style="line-height: 16px; vertical-align: middle; margin-top: -4px; display: inline-block;"
                                             *ngIf="AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.is_audited==false">
                                             Not Audited</span>
                                          
                                             <span class="draft-tag label-tag-style-tag label-left-arow-tag"
                                             style="line-height: 16px; vertical-align: middle; margin-top: -4px; display: inline-block;"
                                             *ngIf="AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.is_audited==true">
                                             Audited</span>
                                          </h5>
                                    </div>
                                    <div class="clearfix">
                                       <p class="label-tag-style"><i
                                             class="fas fa-calendar-alt date-pics-two"></i>{{getTimezoneFormatted(AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.start_date) | date: OrganizationGeneralSettingsStore.organizationSettings?.date_time_format }}
                                          To
                                          {{getTimezoneFormatted(AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.end_date) | date: OrganizationGeneralSettingsStore.organizationSettings?.date_time_format }}
                                       </p>
                                    </div>
                                 </div>

                                 <div class="row">
                                    <div class="col-lg-4 col-sm-6">
                                       <h6>{{ 'audit_plans' | translate }}</h6>
                                       <p>{{AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.audit_plan?.title}}
                                       </p>
                                    </div>
                                    <div class="col-lg-4 col-sm-6" *ngIf = "OrganizationLevelSettingsStore.organizationLevelSettings?.is_subsidiary">
                                       <h6>{{ 'subsidiaries' | translate }}</h6>
                                       <p>{{AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.organization?.title}}
                                       </p>
                                    </div>
                                    <div class="col-lg-4 col-sm-6" [ngStyle] = "{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_division ? 'none':'block'}">
                                       <h6>{{'divisions' | translate}}</h6>
                                       <p>{{AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.division?.title}}</p>
                                    </div>
                                    <div class="col-lg-4 col-sm-6" [ngStyle] = "{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_section ? 'none':'block'}">
                                       <h6>{{'sections' | translate}}</h6>
                                       <p>{{AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.section?.title}}</p>
                                    </div>
                                    <div class="col-lg-4 col-sm-6" [ngStyle] = "{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_sub_section ? 'none':'block'}">
                                       <h6>{{'sub_sections' | translate}}</h6>
                                       <p>{{AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.sub_section?.title}}
                                       </p>
                                    </div>
                                    <div class="col-lg-4 col-sm-6" [ngStyle] = "{display: !OrganizationLevelSettingsStore.organizationLevelSettings?.is_department ? 'none':'block'}">
                                       <h6>{{'departments' | translate}}</h6>
                                       <p>{{AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.department?.title}}
                                       </p>
                                    </div>
                                 </div>

               
                                 <h6>{{'checklist' | translate}}</h6>
                                 <div class="drop-detail-sec">
                                    <ul class="banking-issue">
                                       <li class="clearfix"
                                          *ngFor="let checklist of AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.checklists">
                                          <a>{{checklist.title}}</a></li>

                                    </ul>
                                 </div>



                                 <div class="audit-form-table w-100 mt-3">
                                    <h6>{{'auditable_items' | translate}}</h6>
                                    <table
                                       class="table table-bordered ordinary-table audit-page-table mb-4 table-scroll">
                                       <thead>
                                          <tr>
                                             <th class="border-top-0 text text-center" width="3%">
             
                                                 #
                                             </th>
                                             <th class="border-top-0" width="8%">{{'ref_no' | translate}}</th>
                                             <th class="border-top-0" width="30%">{{'title' | translate}}</th>
                                            
                                             <th class="border-top-0" width="15%">{{'auditable_item_types' | translate}}</th>
                                             <th class="border-top-0" width="12%">{{'auditable_item_categories' | translate}}</th>
                                             <th class="border-top-0" width="15%">{{'risk_rating' | translate}}</th>
             
                                             <th class="border-top-0" width="12%">{{'status' | translate}}</th>
                                         </tr>
                                       </thead>
                                       <tbody>
                                          <tr
                                             *ngFor="let item of AuditPlanScheduleMasterStore?.auditPlanScheduleDetails?.auditable_items;let num=index">
                                             <td class="text-center">

                                                {{num+1}}</td>
                                            <td>#{{item.reference_code}}</td>
                                            <td>{{item.title}}</td>
                                            <td>{{item.auditable_item_type ? item.auditable_item_type.title : AppStore.noContentText}}</td>
                                            <td> {{item.auditable_item_category ? item.auditable_item_category.title : AppStore.noContentText}}</td>
            
                                            <td *ngIf="item.risk_rating!=null"> <div  [ngClass]="item.risk_rating.language[0].pivot.title=='High'?'dot-div red-dot': item.risk_rating.language[0].pivot.title=='Medium'?'dot-div yellow-dot':item.risk_rating.language[0].pivot.title=='Low'?'dot-div green-dot':'dot-div red-dot'">{{item.risk_rating?.language[0]?.pivot?.title}}</div></td>
                                            <td class="cursor-pointer"  *ngIf="item.risk_rating==null">
            
                                                {{ AppStore.noContentText}}
                                               </td>  
                                            <td>
                                               
                                                <div *ngIf="item.status_id==1" class="dot-div green-dot"> {{'active' | translate}} </div>
                                                <div *ngIf="item.status_id==2" class="dot-div red-dot">{{'inactive' | translate}}</div> 
                                            </td>
                                          </tr>


                                       </tbody>
                                    </table>

                                   

                                 </div>
                                 <div class="row">
                                    <div class="col-xl-12">
                                       <hr>
                                       <div class="d-flex flex-row user-list-sm">
                                          <app-user-popup-box [source]=" getCreatedByPopupDetails(AuditPlanScheduleMasterStore?.auditPlanScheduleDetails.created_by, AuditPlanScheduleMasterStore?.auditPlanScheduleDetails.created_at)"></app-user-popup-box>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-12 col-lg-4"  *mobxAutorun>

                              <div class="risk-rating-box bg-white p-3 mb-3 edit-option text-left">
                                 
                                 <h6 class="text-left">{{'audit_leader' | translate}}</h6>
                                 <hr class="mt-0 mb-3">
                                 <app-user-popup-box [source]="assignUserValues(AuditPlanScheduleMasterStore.individualAuditSchedule?.audit_plan?.audit_leader)"></app-user-popup-box>

                              </div>
                              <div class="risk-rating-box bg-white p-3 mb-3 edit-option text-left">
                                 <div class="edit-option-show-inner" style="margin: -3px 0 0 0;">
                                    <a *ngIf = "AuthStore.getActivityPermission(1000,'AUDIT_PLAN_SCHEDULE_ADD_AUDITOR')" (click)="openAuditorAdddModal()"><i class="fas fa-plus"></i></a>
                                 </div> 
                                 <h6 class="text-left">{{'auditor' | translate}}</h6>
                                 <hr class="mt-0 mb-3">
                                 <ul class="arci-user-tab-dtl workflow-lst-pics-loop clearfix user-pic-mr-remove">
                                    <li class="rounde-hov-bg" *ngFor = "let auditor of AuditPlanScheduleMasterStore.individualAuditSchedule?.auditors; let i = index">
                                     <app-user-popup-box [source]="assignUserValues(auditor)" [showName] = "false" ></app-user-popup-box>
                                    </li>
                                </ul>

                              </div>

                              <div class="risk-rating-box bg-white p-3 mb-3 edit-option text-left">
                                 <div class="edit-option-show-inner" style="margin: -3px 0 0 0;">
                                    <a *ngIf = "AuthStore.getActivityPermission(1000,'AUDIT_PLAN_SCHEDULE_ADD_AUDITEE')" (click)="openAuditeeAddModal()"><i class="fas fa-plus"></i></a>
                                 </div> 
                                 <h6 class="text-left">{{'auditees' | translate}}</h6>
                                 <hr class="mt-0 mb-3">
                                 <ul class="arci-user-tab-dtl workflow-lst-pics-loop clearfix user-pic-mr-remove">
                                    <li class="rounde-hov-bg" *ngFor = "let auditee of AuditPlanScheduleMasterStore.individualAuditSchedule?.auditees; let i = index">
                                     <app-user-popup-box [source]="assignUserValues(auditee)" [showName] = "false" ></app-user-popup-box>
                                    </li>
                                </ul>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</main>
<!-- auditor auditee add modal -->


<div class="modal modal-style-1 popup-full-width fade" data-keyboard="false" data-backdrop="static" #chooseAuditors>
   <app-auditor-auditee-add-modal *ngIf="auditorsObject.type" [source]="auditorsObject">

   </app-auditor-auditee-add-modal>

</div>
