<nav class="edit-bar" data-toggle="affix">
    <div class="module-name-block module-name-block-space float-left">
        <a class="dropdown module-title">{{'user_reports'|translate}}</a>
    </div>
    <app-sub-menu></app-sub-menu>
    <!-- <app-sub-menu-drop-down></app-sub-menu-drop-down> -->
    <!-- <div class="dropdown edit-dropdown d-lg-none">
        <a class="btn btn-primary float-left three-dots-dropdown dropdown-toggle" data-toggle="dropdown"><i
            class="fas fa-ellipsis-v"></i></a>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
          <a class="dropdown-item" data-toggle="pill" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" [routerLink]="['/human-capital/user-reports']">{{'user_reports'|translate}}</a>
        </div>
      </div>
      <ul class="nav nav-pills float-left d-none d-lg-block" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="pill" routerLinkActive = "active" [routerLinkActiveOptions]="{exact: true}" [routerLink]="['/human-capital/user-reports']">{{'user_reports'|translate}}</a>
        </li>
      </ul> -->
</nav>
<main class="mt-3 organization-page">
    <div class="container-fluid" *ngIf="!reportLoader">
        <div class="bg-white human-capital-report-main widg-padding-cmn min-height-83" *mobxAutorun>
            <div class="human-report-form">
                <div class="row">
                    <div class="col-lg-4 col-sm-6">
                        <div class="form-group">
                            <label for="name">{{'user'|translate}}</label>
                            
                            <!-- <div class="clearfix">
                                <div class="pointer" class="multiple-plain-ngselect">
                                    <ng-select [items]="UsersStore.users" [placeholder]="'user'|translate"
                                        (clear)="getUsers()" (search)="searchUers($event)" (open)="getUsers()"
                                        (change)="setSelectedUser($event)" [(ngModel)]="selectedUser" bindLabel="id"
                                        bindValue="id">
                                        <ng-template ng-label-tmp let-item="item" let-clear="clear">
                                            <img class="ng-select-user-display" *ngIf="item.image_token" height="15" width="15"
                                                [attr.src]="createImagePreview('user-profile-picture',item.image_token)" />
                                            <img class="ng-select-user-display" *ngIf="!item.image_token" height="15" width="15"
                                                [attr.src]="getDefaultImage('user-logo')" />
                                            <b style="padding-left: 3px;">{{item.first_name?item.first_name:item.name | titlecase}}
                                                {{item.last_name | titlecase}}</b><span aria-hidden="true"
                                                (click)="clear(item)" style="border:none;"
                                                class="ng-value-icon left">×</span>
                                        </ng-template>
                                        <ng-template ng-option-tmp let-item="item" let-index="index">
                                            <div class="user-post-department-pic">
                                                <img class="ng-select-user-display" *ngIf="item.image_token" height="25" width="25"
                                                    [attr.src]="createImagePreview('user-profile-picture',item.image_token)" />
                                                <img class="ng-select-user-display" *ngIf="!item.image_token" height="25" width="25"
                                                    [attr.src]="getDefaultImage('user-logo')" />
                                            </div>
                                            <div class="user-post-department-div">
                                                <b>{{item.first_name | titlecase}}
                                                    {{item.last_name | titlecase}}</b>
                                                <p class="user-post-department-multiple">
                                                    {{item.designation_title}}<span
                                                        *ngIf="item.department">,{{item.department}}</span></p>
                                            </div>
                                        </ng-template>
                                    </ng-select>
                                </div>
                            </div> -->

                            <div class="clearfix">
                                <div class="multiple-plain-ngselect">
                                  <ng-select [items]="UsersStore.usersList" bindLabel="email" [placeholder]="'select_user'|translate"
                                  (change)="setSelectedUser($event)" [(ngModel)]="selectedUser"
                                  bindValue="id" searchable="true" (search)="searchUers($event)"
                                    (clear)="getUsers()" (open)="getUsers()" [searchFn]="customSearchFn">
                                    <ng-template ng-label-tmp let-item="item" let-clear="clear">
                                      <img class="ng-select-user-display" *ngIf="item.image_token" height="15" width="15"
                                        [attr.src]="createImagePreview('user-profile-picture',item.image_token)" 
                                        onerror = "this.src='/assets/images/user-demo2.png'"/>
                                      <img class="ng-select-user-display" *ngIf="!item.image_token" height="15" width="15"
                                        [attr.src]="getDefaultImage('user-logo')" 
                                        onerror = "this.src='/assets/images/user-demo2.png'"/>
                                      <b style="padding-left: 3px;">{{getStringsFormatted([item.first_name,item.last_name],45,' ') | titlecase}}</b>
                                      <span aria-hidden="true" (click)="clear(item)"
                                        style="border:none;" class="ng-value-icon left">×</span>
                                    </ng-template>
                                    <ng-template ng-option-tmp let-item="item" let-index="index">
                                      <div class="user-post-department-pic">
                                        <img class="ng-select-user-display" *ngIf="item.image_token" height="25" width="25"
                                          [attr.src]="createImagePreview('user-profile-picture',item.image_token)" 
                                          onerror = "this.src='/assets/images/user-demo2.png'"/>
                                        <img class="ng-select-user-display" *ngIf="!item.image_token" height="25" width="25"
                                          [attr.src]="getDefaultImage('user-logo')" 
                                          onerror = "this.src='/assets/images/user-demo2.png'"/>
                                      </div>
                                      <div class="user-post-department-div">
                                        <b>{{getStringsFormatted([item.first_name,item.last_name],45,' ') | titlecase}}</b> 
                                        <p class="user-post-department-multiple">{{getStringsFormatted([item.designation_title,' '+item.department],45,',')}}</p>
                                      </div>
                                    </ng-template>
                                  </ng-select>
                                </div>
                              </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-sm-6" *ngIf="selectedUser">
                        <div class="form-group">
                            <label for="name">{{'choose_report'|translate}}</label>
                            <div class="clearfix">
                                <div class="pointer" class="multiple-plain-ngselect">
                                    <ng-select [searchable]="true" [placeholder]="'select_report'|translate"
                                        (clear)="getReports()" (search)="searchReport($event)" (open)="getReports()"
                                        (change)="setSelectedReport($event)" [(ngModel)]="selectedReport">
                                        <ng-template ngFor let-item [ngForOf]="UserReportStore?.reportDetails">
                                            <ng-option [disabled]="true" value="item">
                                                <h5>-- {{ item.report_frequency|titlecase }} --</h5>
                                            </ng-option>
                                            <ng-option *ngFor="let child of item.reports" [value]="child">
                                                {{ child.user_report.title }}</ng-option>
                                        </ng-template>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-sm-12" *ngIf="selectedUser && selectedReport">
                        <div class="form-group">
                            <label for="name">{{'report_frequency'|translate}}</label>
                            <div class="year-inp-label">
                                <label class="pointer" *ngFor="let i of frequencyArray"
                                    [ngClass]="i==selectedFrequency.year?'outline-tag active':'outline-tag'"
                                    (click)="setFrequency(i,'year')">{{i}}</label>
                            </div>
                        </div>
                    </div>
                </div>
                <ng-container *mobxAutorun>
                    <app-no-data *ngIf = "selectedUser==null"></app-no-data>
                  </ng-container>
                  <ng-container *mobxAutorun>
                    <app-no-data *ngIf = "selectedUser!=null && selectedReport==null"></app-no-data>
                  </ng-container>
                <div class="user-report-top-box-sec widg-padding-cmn"
                    *ngIf="selectedReport&&selectedUser && AuthStore.getActivityPermission(200,'USER_ACTUAL_REPORT_LIST')">
                    <div class="row">
                        <div class="col-md-7">
                            <div class="clearfix d-flex">


                                <div class="issue-top-sec issuue-new-style p-0 w-100">
                                    <div class="clearfix pt-0">
                                        <h5 class="d-inline-block cmn-head-style label-tag-style bold">
                                            {{'procedure_user_report'|translate}}</h5>                                           
                                    </div>
                                    <div *ngIf="!UserActualReportStore.view_more &&selectedReport.user_report?.description?.length > 0 ">
                                        <!-- <p class="mb-1">
                                        {{selectedReport.user_report.description?.length > 150?selectedReport.user_report.description?.substring(0,150)+'...':selectedReport.user_report.description}}
                                        </p> -->
                                        <p *ngIf="!UserActualReportStore.view_more &&selectedReport.user_report?.description?.length > 0" class="text-editor-content bullet-point-list" [innerHTML] = "selectedReport.user_report.description?.length > 150?selectedReport.user_report.description?.substring(0,150)+'...':selectedReport.user_report.description"></p>
                     
                                        <a *ngIf="selectedReport.user_report.description?.length > 150"
                                            (click)="viewMore('more')" class="view-more-pestel-box pointer view-more-doted">{{'view_more'|translate}}</a>
                                    </div>

                                    <div class="mb-3" *ngIf="selectedReport.user_report?.description==null">
                                        <!-- <app-no-data-list [source] = "emptyList" [height]=false [border]=false>
                                        </app-no-data-list> -->
                                        <app-context-no-data [sourceData] = "getNoDataSource('left')"></app-context-no-data>
                                       <!-- {{AppStore.noContentText}} -->
                                    </div>
                                    <div *ngIf="UserActualReportStore.view_more">
                                        <!-- <p class="mb-1">
                                        {{selectedReport.user_report.description}}
                                        </p> -->
                                        <div class="text-editor-content bullet-point-list" [innerHTML] = "selectedReport.user_report.description | safeHtml"></div>
                     
                                        <a *ngIf="selectedReport.user_report.description.length > 150"
                                            (click)="viewMore('less')" class="view-more-pestel-box pointer view-more-doted">...{{'view_less'|translate}}</a>
                                    </div>
                                    <!-- <p>{{selectedReport.user_report.description?.length>70?selectedReport.user_report.description?.substring(0,70)+'..':selectedReport.user_report.description}}
                                        <a *ngIf="selectedReport.user_report.description?.length>70"
                                            (click)="viewMore()" class="view-more-pestel-box pl-2"
                                            style="display: inline-block;">View More</a> </p> -->
                                </div>
                            </div>

                            <div class="clearfix mt-3">
                                <h6>{{'reporting_to'|translate}} <label
                                        class="outline-tag outline-tag-small">{{selectedReport.user_report.report_frequency.type|titlecase}}</label>
                                </h6>
                                <!-- <div class="user-next-icon float-right">
                                    <a class="pointer" *ngIf="reportingIndex>0" (click)="addIndex(-1)"><i
                                            class="fas fa-chevron-left"></i></a>
                                    <a class="pointer"
                                        *ngIf="reportingIndex<(selectedReport.submitted_to_users.length-1)"
                                        (click)="addIndex(+1)"><i class="fas fa-chevron-right"></i></a>
                                </div> -->
                                <div class="pb-3" *ngIf="selectedReport.submitted_to_users.length > 4">
                                    <ul class="arci-user-tab-dtl workflow-lst-pics-loop clearfix" 
                                        >
                                        <li class="rounde-hov-bg"
                                        *ngFor="let user of selectedReport.submitted_to_users;let i=index">
                                        <app-user-popup-box [showName]="false" [source]="getPopupDetails(user)"></app-user-popup-box>
                                        </li>
                                    </ul>
                                </div>
                    
                    <div class="row" *ngIf="!(selectedReport.submitted_to_users.length > 4)" >
                        <div class="col-xl-3 col-lg-4 col-sm-6 animation-pulse"
                        *ngFor="let user of selectedReport.submitted_to_users;let i=index">
                            <div class="label-and-user-pic">
                                <app-user-popup-box  [source]="getPopupDetails(user)"></app-user-popup-box>
                        </div>
                        </div>
    
                    </div>
                            </div>
                            <!-- <app-user-popup-box [source]="getPopupDetails(selectedReport.submitted_to_users[reportingIndex])"></app-user-popup-box> -->
                            <!-- <div class="d-flex flex-row user-list-sm">
                                <img [attr.src]="selectedReport.submitted_to_users[reportingIndex]?.image.token?createImagePreview('user-profile-picture',selectedReport.submitted_to_users[reportingIndex].image.token):getDefaultImage('user-logo')"
                                    width="30px" height="30px" class="rounded-circle">
                                <div>
                                    <h6>{{selectedReport.submitted_to_users[reportingIndex]?.first_name}}
                                        {{selectedReport.submitted_to_users[reportingIndex]?.last_name}}</h6>
                                    <span>{{selectedReport.submitted_to_users[reportingIndex]?.designation}} |
                                        {{'created_at'|translate}}
                                        {{selectedReport.created_at|date : OrganizationGeneralSettingsStore.organizationSettings.date_format}}</span>
                                </div>
                            </div> -->



                        </div>
                        <!-- <div class="col-md-3" *ngIf="selectedReport.submitted_to_users.length>0">
                            
                        </div> -->
                        <div class="col-lg-5 col-sm-12">
                            <h6>{{'Documents'|translate}}</h6>
                            <div class="scroll-documents-small" #uploadArea>
                                <div class="thumb-view-three-row clearfix thumb-pics-fix-text">
                                    <div class="thumb-view-3" *ngFor="let doc of selectedReport.user_report.documents">
                                        <div class="upload-pics upload-pics-small edit-option">
                                            <div class="browse-form-pic"
                                                [ngStyle]="{'background': 'url('+createImagePreview('user-reports',doc.token)+') no-repeat'}"
                                                (click)="viewDocument(doc)">
                                            </div>
                                            <div class="browse-form-name clearfix">
                                                <div class="float-left">
                                                    <h6>{{doc.title.length>10?doc.title.substring(0,10)+' ...':doc.title}}
                                                    </h6>
                                                    <span>{{doc.size/1048576 | number:'0.2-2'}}MB</span>
                                                </div>
                                                <div class="browse-logo">
                                                    <img *ngIf="checkExtension(doc.ext,'excel') != -1"
                                                        src="/assets/images/md-xl.png" width="30px" height="30px">
                                                    <img *ngIf="checkExtension(doc.ext,'image') != -1"
                                                        src="/assets/images/md-jpg.png" width="30px" height="30px">
                                                    <img *ngIf="checkExtension(doc.ext,'doc') != -1"
                                                        src="/assets/images/md-doc.png" width="30px" height="30px">
                                                    <img *ngIf="checkExtension(doc.ext,'pdf') != -1"
                                                        src="/assets/images/md-pdf.png" width="30px" height="30px">
                                                    <img *ngIf="checkExtension(doc.ext,'video') != -1"
                                                        src="/assets/images/md-video.png" width="30px" height="30px">
                                                    <img *ngIf="checkExtension(doc.ext,'audio') != -1"
                                                        src="/assets/images/md-audio.png" width="30px" height="30px">
                                                    <img *ngIf="checkExtension(doc.ext,'ppt') != -1"
                                                        src="/assets/images/md-ppt.png" width="30px" height="30px">
                                                </div>
                                            </div>
                                            <div class="edit-option-show-inner" style="margin: 0 -8px 0 0;">
                                                <a (click)="downloadReport(doc)" *ngIf="AuthStore.getActivityPermission(200,'DOWNLOAD_USER_ACTUAL_REPORT_DOCUMENT_FILE')"><i class="fas fa-download"></i></a>
                                                <!-- <a href="#"><i class="fas fa-eye"></i></a> -->
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="thumb-view-3" *ngIf="selectedReport.user_report.documents.length==0">
                                        <!-- <p class="mb-3">{{'no_records_found'|translate}}!!!</p> -->
                                        <app-no-data-list [source] = "emptyList" [height]=false [border]=false>
                                        </app-no-data-list>
                                    </div>



                                </div>
                            </div>

                        </div>
                        <!-- <div class="col-lg-5 col-sm-12">
                            <h6>Support Files</h6>
                            <div class="thumb-view-left-side clearfix">
                                <div class="thumb-view-left-side-box"
                                    *ngFor="let doc of selectedReport.user_report.documents">
                                    <div class="upload-pics upload-pics-small edit-option">
                                        <div class="browse-form-pic"
                                            [ngStyle]="{'background': 'url('+createImagePreview('user-reports',doc.token)+') no-repeat'}">
                                        </div>
                                        <div class="browse-form-name clearfix">
                                            <div class="float-left">
                                                <h6>{{doc.title.length>10?doc.title.substring(0,10)+' ...':doc.title}}
                                                </h6>
                                                <span>{{doc.size/1048576 | number:'0.2-2'}}MB</span>
                                            </div>
                                            <div class="browse-logo">
                                                <img *ngIf="checkExtension(doc.ext,'excel') != -1"
                                                    src="/assets/images/md-xl.png" width="30px" height="30px">
                                                <img *ngIf="checkExtension(doc.ext,'image') != -1"
                                                    src="/assets/images/md-jpg.png" width="30px" height="30px">
                                                <img *ngIf="checkExtension(doc.ext,'doc') != -1"
                                                    src="/assets/images/md-doc.png" width="30px" height="30px">
                                                <img *ngIf="checkExtension(doc.ext,'pdf') != -1"
                                                    src="/assets/images/md-pdf.png" width="30px" height="30px">
                                                <img *ngIf="checkExtension(doc.ext,'video') != -1"
                                                    src="/assets/images/md-video.png" width="30px" height="30px">
                                                <img *ngIf="checkExtension(doc.ext,'audio') != -1"
                                                    src="/assets/images/md-audio.png" width="30px" height="30px">
                                                <img *ngIf="checkExtension(doc.ext,'ppt') != -1"
                                                    src="/assets/images/md-ppt.png" width="30px" height="30px">
                                            </div>
                                        </div>
                                        <div class="edit-option-show-inner">
                                            <a (click)="downloadReport(doc)" ><i class="fas fa-download"></i></a>
                  

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> -->

                    </div>
                </div>
                <div class="row" *ngIf="selectedReport&&selectedUser">
                    <div class="col-md-12">
                        <div [ngClass]="selectedReport.user_report.report_frequency_id==1?'bg-main padding-bottom-none':''">
                            <div class="common-tab-md tab-same-height clearfix report-small-tab active-right-border-none hc-report-tab-style">
                                <div class="tab-common-left-md"
                                    *ngIf="selectedReport&&(selectedReport.user_report.report_frequency_id==3||selectedReport.user_report.report_frequency_id==4||selectedReport.user_report.report_frequency_id==5)">
                                    <div class=" issues-tab">
                                        <!-- tab menu start -->
                                        <ul class="nav nav-tabs nav-tabs--vertical nav-tabs--left vertical-tab"
                                            role="navigation">
                                            <li class="pointer" class="nav-item"
                                                *ngFor="let month of monthArray;let m=index"> <a
                                                    (click)="setFrequency(m+1,'month')"
                                                    [ngClass]="m+1==selectedFrequency.month?'nav-link active':'nav-link'"
                                                    data-toggle="tab" role="tab" aria-controls="lorem"
                                                    aria-selected="false">{{month.title}}</a>
                                            </li>
                                        </ul>
                                    </div><!-- tab menu end -->
                                </div>
                                <div class="tab-common-left-md"
                                    *ngIf="selectedReport&&selectedReport.user_report.report_frequency_id==2">
                                    
                                    <div class=" issues-tab">
                                        <!-- tab menu start -->
                                        <ul class="nav nav-tabs nav-tabs--vertical nav-tabs--left vertical-tab"
                                            role="navigation">
                                            <li class="pointer" class="nav-item"
                                                *ngFor="let quarter of QuarterArray;let q=index"> <a
                                                    (click)="setFrequency(q+1,'quarter')"
                                                    [ngClass]="q+1==selectedFrequency.quarter?'nav-link active':'nav-link'"
                                                    data-toggle="tab" role="tab" aria-controls="lorem"
                                                    aria-selected="false">{{quarter}}</a>
                                            </li>
                                        </ul>
                                    </div><!-- tab menu end -->
                                </div>
                                <div [ngClass]="selectedReport.user_report.report_frequency_id==1?'':'tab-common-left-content-m cmn-bdr  padding-bottom-none'">
                                <div class="tab-content"
                                    *ngIf="selectedReport&&(selectedReport.user_report.report_frequency_id==1||selectedReport.user_report.report_frequency_id==2||selectedReport.user_report.report_frequency_id==3)">
                                    <div class="tab-pane fade active show" id="jan2" role="tabpanel">
                                        <div [ngClass]="selectedReport.user_report.report_frequency_id==1?'':'bg-white'">
                                            <div class="panel panel-default">
                                               

                                                <div id="ceo01" class="drop-detail-sec panel-collapse collapse show"
                                                    role="tabpanel" aria-labelledby="headingOne" data-parent="#ceo01"
                                                    >

                                                    <div [ngClass]="selectedReport.user_report.report_frequency_id==1?'panel-body':'panel-body bg-white pb-0'">
                                                        <div class="edit-and-delete-main">
                                                            <div class="edit-option-show" style="margin:11px -29px 0 0;">
                                                                <!-- edit-and-delete starts -->
                                                                <a data-toggle="modal" (click)="openFormModal(frequencyIndex,frequencyType)"><i
                                                                        class="fas fa-plus"></i></a>
                                                            </div>
                                                            <div *ngIf="UserActualReportStore.loaded && (!UserActualReportStore.reportDetails ||UserActualReportStore.reportDetails.length==0)" [ngClass]="selectedReport.user_report.report_frequency_id==1?'text-center p-5':'text-center db-md-screen-center min-height-83'">
                                                                <!-- <p class="mb-0">{{'no_records_found'|translate}}!!!</p> -->
                                                                <app-no-data-list [source] = "emptyList" [height]=false [border]=false>
                                                                </app-no-data-list>
                                                            </div>
                                                        <div class="row" *ngIf="UserActualReportStore.loaded">
                                                            <div [ngClass]="selectedReport.user_report.report_frequency_id==1?'col-xl-3 col-lg-4 col-md-6':'col-xl-4 col-lg-4 col-md-4 col-sm-6'"
                                                                *ngFor="let document of UserActualReportStore.reportDetails">
                                                                <div class="license-box-bg-main edit-option">
                                                                    <div class="edit-option-show-inner">
                                                                        <a class="pointer"
                                                                            (click)="downloadAllDocument(document)"
                                                                            *ngIf="AuthStore.getActivityPermission(200,'DOWNLOAD_USER_ACTUAL_REPORT_DOCUMENT')"><i
                                                                                class="fas fa-download"></i></a>
                                                                        <a [attr.title]="'edit'|translate"
                                                                            class="pointer"
                                                                            (click)="editReport(document,'edit')"
                                                                            *ngIf="AuthStore.getActivityPermission(200,'UPDATE_USER_ACTUAL_REPORT')"><i
                                                                                class="fas fa-pen"></i></a>
                                                                        <a [attr.title]="'delete'|translate"
                                                                            class="pointer"
                                                                            (click)="delete(document.user_actual_report_id)"
                                                                            *ngIf="AuthStore.getActivityPermission(200,'DELETE_USER_ACTUAL_REPORT')"><i
                                                                                class="fas fa-trash"></i></a>
                                                                    </div>
                                                                    <div class="license-box-bg blue-shadow pointer"
                                                                        data-toggle="modal"
                                                                        data-target="#document-popup">
                                                                        <div class="pointer" class="license-box"
                                                                            (click)="editReport(document)"
                                                                            [ngStyle]="{'background': 'url('+createImagePreview('actual-report-document',document.token)+') no-repeat'}">
                                                                            <div class="box-light-shadow"></div>
                                                                        </div>
                                                                        <div
                                                                            class="license-name-sec license-name-sec-pic  relative">
                                                                            <div
                                                                                class="d-flex flex-row user-list-sm user-box-smol-round">
                                                                                <!-- <img *ngIf="checkExtension(document.ext,'excel') != -1"
                                                                                    src="/assets/images/md-xl.png"
                                                                                    width="30px" height="30px">
                                                                                <img *ngIf="checkExtension(document.ext,'image') != -1"
                                                                                    src="/assets/images/md-jpg.png"
                                                                                    width="30px" height="30px">
                                                                                <img *ngIf="checkExtension(document.ext,'doc') != -1"
                                                                                    src="/assets/images/md-doc.png"
                                                                                    width="30px" height="30px">
                                                                                <img *ngIf="checkExtension(document.ext,'pdf') != -1"
                                                                                    src="/assets/images/md-pdf.png"
                                                                                    width="30px" height="30px">
                                                                                <img *ngIf="checkExtension(document.ext,'video') != -1"
                                                                                    src="/assets/images/md-video.png"
                                                                                    width="30px" height="30px">
                                                                                <img *ngIf="checkExtension(document.ext,'audio') != -1"
                                                                                    src="/assets/images/md-audio.png"
                                                                                    width="30px" height="30px">
                                                                                <img *ngIf="checkExtension(document.ext,'ppt') != -1"
                                                                                    src="/assets/images/md-ppt.png"
                                                                                    width="30px" height="30px"> -->
                                                                                    <img src="/assets/images/md-cmn.png" width="30px" height="30px">
                                                                                <div class="pointer new-size-text">
                                                                                    <h6 class="big-name" [attr.title]="document.title.length>20 && selectedReport.user_report.report_frequency_id!=1?document.title:document.title.length>15 && selectedReport.user_report.report_frequency_id==1?document.title:''">
                                                                                        {{document.title.length>20 && selectedReport.user_report.report_frequency_id!=1?document.title.substring(0,20)+' ...':document.title.length>15 && selectedReport.user_report.report_frequency_id==1?document.title.substring(0,15)+' ...':document.title}}
                                                                                    </h6>
                                                                                    <span>{{document.created_at|date : OrganizationGeneralSettingsStore.organizationSettings.date_format}}</span>
                                                                                </div>
                                                                                <div class="single-image">
                                                                                    <div class="rounde-hov-bg">
                                                                                        <a><img [attr.src]="document.create_by_image_token?createImagePreview('user-profile-picture',document.create_by_image_token):getDefaultImage('user-logo')"
                                                                                            onerror = "this.src='/assets/images/user-demo2.png'"
                                                                                                class="w-100 user-round-pics-new rounde-hov"></a>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-content"
                                        *ngIf="selectedReport && selectedReport.user_report.report_frequency_id==5">
                                        <div class="tab-pane fade active show" id="jan+" role="tabpanel">
                                            <div class="bg-white">
                                                <div class="panel-group panel-drop-sections panel-drop-white" id="jd" role="tablist"
                                                    aria-multiselectable="true">
                                                    <div class="panel panel-default edit-and-delete-main"
                                                        *ngFor="let day of dayArray;let d=index">
                                                        <div class="edit-option-show"
                                                            style="margin: 31px 27px 0 0;">
                                                            <!-- edit-and-delete starts -->
                                                            <a class="pointer" data-toggle="modal"
                                                                (click)="openFormModal(d+1,'day')"><i
                                                                    class="fas fa-plus"></i></a>
                                                        </div>
                                                        <div class="pointer"
                                                            [ngClass]="selectedFrequency.day==d+1?'panel-heading active':'panel-heading'"
                                                            role="tab" id="headingOne">
                                                            <div class="panel-title">
                                                                <a role="button" data-toggle="collapse"
                                                                    (click)="setFrequency(d+1,'day',true)" href="'#ceo1"
                                                                    [attr.aria-expanded]="selectedFrequency.day==d+1?'true':'false'"
                                                                    aria-controls="collapseOne"
                                                                    [attr.area-collapsed]="selectedFrequency.day==d+1?'':'collapsed'">
                                                                    <h5 class="width96pc mt-0"> {{'day'|translate}}
                                                                        {{d+1}}
                                                                        <span class="drop-down-icone"><i
                                                                                class="fas fa-chevron-down"></i></span>
                                                                    </h5>
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div id="ceo1" *ngIf="UserActualReportStore.loaded"
                                                            [ngClass]="selectedFrequency.day==d+1?'drop-detail-sec panel-collapse collapse show':'drop-detail-sec panel-collapse collapse'"
                                                            role="tabpanel" aria-labelledby="headingOne"
                                                            data-parent="ceo1">
                                                            <div class="panel-body bg-white pb-0">
                                                                <div class="row">
                                                                    <div class="col-xl-4 col-lg-6 col-md-6"
                                                                        *ngFor="let document of UserActualReportStore.reportDetails">
                                                                        <div class="license-box-bg-main edit-option">
                                                                            <div class="edit-option-show-inner">
                                                                                <a class="pointer"
                                                                                    (click)="downloadAllDocument(document)"
                                                                                    *ngIf="AuthStore.getActivityPermission(200,'DOWNLOAD_USER_ACTUAL_REPORT_DOCUMENT')"><i
                                                                                        class="fas fa-download"></i></a>
                                                                                <a [attr.title]="'edit'|translate"
                                                                                    class="pointer"
                                                                                    (click)="editReport(document,'edit')"
                                                                                    *ngIf="AuthStore.getActivityPermission(200,'UPDATE_USER_ACTUAL_REPORT')"><i
                                                                                        class="fas fa-pen"></i></a>
                                                                                <a class="pointer"
                                                                                    [attr.title]="'delete'|translate"
                                                                                    (click)="delete(document.user_actual_report_id)"
                                                                                    *ngIf="AuthStore.getActivityPermission(200,'DELETE_USER_ACTUAL_REPORT')"><i
                                                                                        class="fas fa-trash"></i></a>
                                                                            </div>
                                                                            <div class="license-box-bg blue-shadow pointer"
                                                                                data-toggle="modal"
                                                                                data-target="#document-popup">

                                                                                <div class="pointer" class="license-box"
                                                                                    (click)="editReport(document)"
                                                                                    [ngStyle]="{'background': 'url('+createImagePreview('actual-report-document',document.token)+') no-repeat'}">
                                                                                    <div class="box-light-shadow"></div>
                                                                                </div>
                                                                                <div
                                                                                    class="license-name-sec license-name-sec-pic  relative">
                                                                                    <div
                                                                                        class="d-flex flex-row user-list-sm user-box-smol-round">
                                                                                        <!-- <img *ngIf="checkExtension(document.ext,'excel') != -1"
                                                                                            src="/assets/images/md-xl.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'image') != -1"
                                                                                            src="/assets/images/md-jpg.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'doc') != -1"
                                                                                            src="/assets/images/md-doc.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'pdf') != -1"
                                                                                            src="/assets/images/md-pdf.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'video') != -1"
                                                                                            src="/assets/images/md-video.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'audio') != -1"
                                                                                            src="/assets/images/md-audio.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'ppt') != -1"
                                                                                            src="/assets/images/md-ppt.png"
                                                                                            width="30px" height="30px"> -->
                                                                                            <img src="/assets/images/md-cmn.png" width="30px" height="30px">
                                                                                        <div
                                                                                            class="pointer new-size-text">
                                                                                            <h6 class="big-name" [attr.title]="document.title.length>20?document.title:''">
                                                                                                {{document.title.length>20?document.title.substring(0,20)+' ...':document.title}}
                                                                                            </h6>
                                                                                            <span>{{document.created_at|date : OrganizationGeneralSettingsStore.organizationSettings.date_format}}</span>
                                                                                        </div>
                                                                                        <div class="single-image">
                                                                                            <div class="rounde-hov-bg">
                                                                                                <a><img [attr.src]="document.create_by_image_token?createImagePreview('user-profile-picture',document.create_by_image_token):getDefaultImage('user-logo')"
                                                                                                    onerror = "this.src='/assets/images/user-demo2.png'"
                                                                                                        class="w-100 user-round-pics-new rounde-hov"></a>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                                <div class="text-center p-5" *ngIf="UserActualReportStore.loaded && (!UserActualReportStore.reportDetails || UserActualReportStore.reportDetails.length==0)">
                                                                    <!-- <p class="mb-3">{{'no_records_found'|translate}}!!!</p> -->
                                                                    <app-no-data-list [source] = "emptyList" [height]=false [border]=false>
                                                                    </app-no-data-list>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-content"
                                        *ngIf="selectedReport && selectedReport.user_report.report_frequency_id==4">
                                        <div class="tab-pane fade active show" id="jan+" role="tabpanel">
                                            <div class="bg-white">
                                                <div class="panel-group panel-drop-sections pt-0" id="jd" role="tablist"
                                                    aria-multiselectable="true">
                                                    <div class="panel panel-default edit-and-delete-main"
                                                        *ngFor="let week of weekArray;let w=index">
                                                        <div class="edit-option-show"
                                                            style="margin: 33px 27px 0 0;">
                                                            <!-- edit-and-delete starts -->
                                                            <a class="pointer" data-toggle="modal"
                                                                (click)="openFormModal(w+1,'week')"><i
                                                                    class="fas fa-plus"></i></a>
                                                        </div>
                                                        <div class="pointer"
                                                            [ngClass]="selectedFrequency.week==w+1?'panel-heading active':'panel-heading'"
                                                            role="tab" id="headingOne">
                                                            <div class="panel-title">
                                                                <a role="button" data-toggle="collapse"
                                                                    (click)="setFrequency(w+1,'week',true)"
                                                                    [attr.aria-expanded]="selectedFrequency.week==w+1?'true':'false'"
                                                                    aria-controls="collapseOne"
                                                                    [attr.area-collapsed]="selectedFrequency.week==w+1?'':'collapsed'">
                                                                    <h5 class="width96pc mt-0"> {{'week'|translate}} {{w+1}}
                                                                        <span class="drop-down-icone"><i
                                                                                class="fas fa-chevron-down"></i></span>
                                                                    </h5>
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div id="ceo01"
                                                            [ngClass]="selectedFrequency.week==w+1?'drop-detail-sec panel-collapse collapse show':'drop-detail-sec panel-collapse collapse'"
                                                            role="tabpanel" aria-labelledby="headingOne"
                                                            data-parent="#ceo01">
                                                            <div class="panel-body bg-white pb-0">
                                                                <div class="row">
                                                                    <div class="col-xl-4 col-lg-6 col-md-6"
                                                                        *ngFor="let document of UserActualReportStore.reportDetails">
                                                                        <div class="license-box-bg-main edit-option">
                                                                            <div class="edit-option-show-inner">
                                                                                <a class="pointer"
                                                                                    (click)="downloadAllDocument(document)"
                                                                                    *ngIf="AuthStore.getActivityPermission(200,'DOWNLOAD_USER_ACTUAL_REPORT_DOCUMENT')"><i
                                                                                        class="fas fa-download"></i></a>
                                                                                <a class="pointer"
                                                                                    [attr.title]="'edit'|translate"
                                                                                    (click)="editReport(document,'edit')"
                                                                                    *ngIf="AuthStore.getActivityPermission(200,'UPDATE_USER_ACTUAL_REPORT')"><i
                                                                                        class="fas fa-pen"></i></a>
                                                                                <a class="pointer"
                                                                                    [attr.title]="'delete'|translate"
                                                                                    (click)="delete(document.user_actual_report_id)"
                                                                                    *ngIf="AuthStore.getActivityPermission(200,'DELETE_USER_ACTUAL_REPORT')"><i
                                                                                        class="fas fa-trash"></i></a>
                                                                            </div>
                                                                            <div class="license-box-bg blue-shadow pointer"
                                                                                data-toggle="modal"
                                                                                data-target="#document-popup">
                                                                                <div class="pointer" class="license-box"
                                                                                    (click)="editReport(document)"
                                                                                    [ngStyle]="{'background': 'url('+createImagePreview('actual-report-document',document.token)+') no-repeat'}">
                                                                                    <div class="box-light-shadow"></div>
                                                                                </div>
                                                                                <div
                                                                                    class="license-name-sec license-name-sec-pic  relative">
                                                                                    <div
                                                                                        class="d-flex flex-row user-list-sm user-box-smol-round">
                                                                                        <!-- <img *ngIf="checkExtension(document.ext,'excel') != -1"
                                                                                            src="/assets/images/md-xl.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'image') != -1"
                                                                                            src="/assets/images/md-jpg.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'doc') != -1"
                                                                                            src="/assets/images/md-doc.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'pdf') != -1"
                                                                                            src="/assets/images/md-pdf.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'video') != -1"
                                                                                            src="/assets/images/md-video.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'audio') != -1"
                                                                                            src="/assets/images/md-audio.png"
                                                                                            width="30px" height="30px">
                                                                                        <img *ngIf="checkExtension(document.ext,'ppt') != -1"
                                                                                            src="/assets/images/md-ppt.png"
                                                                                            width="30px" height="30px"> -->
                                                                                            <img src="/assets/images/md-cmn.png" width="30px" height="30px">
                                                                                        <div
                                                                                            class="pointer new-size-text">
                                                                                            <h6 class="big-name" [attr.title]="document.title.length>20?document.title:''">
                                                                                                {{document.title.length>20?document.title.substring(0,20)+' ...':document.title}}
                                                                                            </h6>
                                                                                            <span>{{document.created_at|date : OrganizationGeneralSettingsStore.organizationSettings.date_format}}</span>
                                                                                        </div>
                                                                                        <div class="single-image">
                                                                                            <div class="rounde-hov-bg">
                                                                                                <a><img [attr.src]="document.create_by_image_token?createImagePreview('user-profile-picture',document.create_by_image_token):getDefaultImage('user-logo')"
                                                                                                    onerror = "this.src='/assets/images/user-demo2.png'"
                                                                                                        class="w-100 user-round-pics-new rounde-hov"></a>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="text-center p-5" *ngIf="UserActualReportStore.loaded && (!UserActualReportStore.reportDetails || UserActualReportStore.reportDetails.length==0)">
                                                                    <!-- <p class="mb-3">{{'no_records_found'|translate}}!!!</p> -->
                                                                    <app-no-data-list [source] = "emptyList" [height]=false [border]=false>
                                                                    </app-no-data-list>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div class="tab-common-left-content-m cmn-bdr">
                                    
                                </div> -->
                                <!-- <div class="tab-common-left-content-m cmn-bdr">
                                
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
      
    </div>
    <ng-container *mobxAutorun>
        <div *ngIf="reportLoader">
            <app-user-actual-report-loader></app-user-actual-report-loader>
        </div>
    </ng-container>
</main>

<div class="modal modal-style-1 fade popup-full-width" id="add-user-report-popup" data-keyboard="false"
    data-backdrop="static" #formModal>
    <button type="button" class="close" data-dismiss="modal" (click)="closeFormModal()"><i
            class="lni-close"></i><span>{{'esc'|translate}}</span></button>
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">{{'user_report'|translate}}</h4>

            </div>
            <!-- Modal body -->
            <div class="modal-body form-body">
                <form [formGroup]="form" *mobxAutorun>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label>{{'report'|translate}}<sup>*</sup></label>
                                <div class="clearfix">
                                    <div class="pointer" class="multiple-plain-ngselect">


                                        <ng-select [searchable]="true" [placeholder]="'select_report'|translate"
                                            (clear)="getReports()" (search)="searchReport($event)" (open)="getReports()"
                                            formControlName="user_user_report_id" (change)="changeReport($event)">
                                            <ng-template ngFor let-item [ngForOf]="UserReportStore?.reportDetails">
                                                <ng-option [disabled]="true" value="item">
                                                    <h5><b>-- {{ item.report_frequency|titlecase }} --</b></h5>
                                                </ng-option>
                                                <ng-option *ngFor="let child of item.reports" [value]="child.id">
                                                    {{ child.user_report.title }}</ng-option>

                                            </ng-template>
                                        </ng-select>
                                        <p style="color: red;" *ngIf="formErrors && formErrors.user_user_report_id">
                                            {{formErrors.user_user_report_id}}</p>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>{{'year'|translate}}</label>
                                <div class="clearfix">
                                    <div class="plain-select">
                                        <select class="pointer" class="form-control" name="test"
                                            [attr.placeholder]="'year'|translate" formControlName="year">
                                            <option [value]="i" *ngFor="let i of frequencyArray">{{i}}</option>

                                        </select>
                                        <p style="color: red;" *ngIf="formErrors && formErrors.year">
                                            {{formErrors.year}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6" *ngIf="selectedReport?.user_report.report_frequency_id!=1">
                            <div class="form-group">
                                <label>{{'quarter'|translate}}</label>
                                <div class="clearfix">
                                    <div class="plain-select">
                                        <select class="pointer" class="form-control" name="test"
                                            [attr.placeholder]="'quarter'|translate" formControlName="quarter">
                                            <option [value]="q+1" *ngFor="let quarter of QuarterArray;let q=index">
                                                {{quarter}}</option>

                                        </select>
                                        <p style="color: red;" *ngIf="formErrors && formErrors.quarter">
                                            {{formErrors.quarter}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6"
                            *ngIf="selectedReport?.user_report.report_frequency_id==3||selectedReport?.user_report.report_frequency_id==4||selectedReport?.user_report.report_frequency_id==5">
                            <div class="form-group">
                                <label>{{'month'|translate}}</label>
                                <div class="clearfix">
                                    <div class="plain-select">
                                        <select class="pointer" class="form-control" name="test"
                                            [attr.placeholder]="'month'|translate" formControlName="month">

                                            <option [value]="m+1" *ngFor="let month of monthArray;let m=index"
                                                [disabled]="form.value.quarter == month.quarter?false:true">
                                                {{month.title}}</option>

                                        </select>
                                        <p style="color: red;" *ngIf="formErrors && formErrors.month">
                                            {{formErrors.month}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6"
                            *ngIf="selectedReport?.user_report.report_frequency_id==4||selectedReport?.user_report.report_frequency_id==5">
                            <div class="form-group">
                                <label>Week</label>
                                <div class="clearfix">
                                    <div class="plain-select">
                                        <select class="pointer" class="form-control" name="test" [attr.placeholder]="'week'|translate"
                                            formControlName="week">

                                            <option [value]="w+1" *ngFor="let week of weekArray;let w=index">
                                                {{week}}</option>

                                        </select>
                                        <p style="color: red;" *ngIf="formErrors && formErrors.week">
                                            {{formErrors.week}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6" *ngIf="selectedReport?.user_report.report_frequency_id==5">
                            <div class="form-group">
                                <label>{{'day'|translate}}</label>
                                <div class="clearfix">
                                    <div class="plain-select">
                                        <select class="pointer" class="form-control" name="test"
                                            [attr.placehoder]="'day'|translate" formControlName="day">
                                            <option [value]="d+1" *ngFor="let day of dayArray;let d=index">{{day}}
                                            </option>

                                        </select>
                                        <p style="color: red;" *ngIf="formErrors && formErrors.day"> {{formErrors.day}}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <label for="name" class="label-style mb-0">{{'documents'|translate}}<sup>*</sup></label>
                    <p style="color: red;" *ngIf="formErrors && formErrors.documents"> {{formErrors.documents}}</p>
                    <div class="scroll-documents" #browseArea>
                        <div class="row m-0 upload-section">
                            <div class="col-sm-4 costmz-logo-new mt-2">
                                <div class="question-circle-inp" *ngIf = "OrganizationGeneralSettingsStore.organizationSettings?.support_file_allowed_types.length > 0" style="margin-right: 7px;">
                                    <i class="far fa-question-circle"></i>
                                    <div class="message-password-inp">
                                        <p class="mb-0">{{'allowed_file_types' | translate}} {{OrganizationGeneralSettingsStore.organizationSettings?.support_file_allowed_types.toString()}}</p>
                                    </div>
                                 </div>
                                <div class="form-group form-group-upload">
                                    <div class="darag-dropifile-upload">
                                        <div class="d-flex justify-content-center align-items-center text-center">
                                            <div>
                                                <img src="assets/images/drag-pic.png" class="drag-pic-files">
                                                <div class="drag-file-name">{{'select_upload_your_file_here'|translate}}</div>
                                                <div class="upload-btn-wrapper">
                                                    <input type="file" multiple name="myfile"
                                                        (change)="onFileChange($event,'support-file')"
                                                        [accept]="checkAcceptFileTypes('brochure')" />
                                                    <button class="pointer" class="btn">{{'browse_files'|translate}}</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <div [ngClass]="files.success? 'col-sm-4 up-pic-cf mt-2 hide_loader' : 'col-sm-4 up-pic-cf mt-2'"
                                *ngFor="let files of fileUploadsArray">
                                <div class="upload-pics edit-option file-upload-loader">
                                    <circle-progress class="browse-form-pic" [percent]=files.uploadProgress
                                        [title]=files.uploadProgress>
                                    </circle-progress>
                                </div>
                            </div>

                            <div [ngClass]="doc.is_deleted ? 'col-sm-4 up-pic-cf mt-2 image_deleted':'col-sm-4 up-pic-cf mt-2'"
                                *ngFor="let doc of  UserActualReportStore.docDetails">
                                <div class="upload-pics edit-option">
                                    <div *ngIf="doc.preview" class="browse-form-pic"
                                        [ngStyle]="{'background': 'url(' + doc.preview + ') no-repeat 0 0 / cover'}">
                                    </div>
                                    <div class="browse-form-name clearfix">
                                        <div class="float-left">
                                            <h6>{{doc.name.length>15?doc.name.substring(0,15)+' ...':doc.name}}</h6>
                                            <span>{{doc.size/1048576 | number:'0.2-2'}}MB</span>
                                        </div>
                                        <div class="browse-logo">
                                            <img *ngIf="checkExtension(doc.ext,'excel') != -1"
                                                src="/assets/images/md-xl.png">
                                            <img *ngIf="checkExtension(doc.ext,'image') != -1"
                                                src="/assets/images/md-jpg.png">
                                            <img *ngIf="checkExtension(doc.ext,'doc') != -1"
                                                src="/assets/images/md-doc.png">
                                            <img *ngIf="checkExtension(doc.ext,'pdf') != -1"
                                                src="/assets/images/md-pdf.png">

                                            <img *ngIf="checkExtension(doc.ext,'video') != -1"
                                                src="/assets/images/md-video.png">
                                            <img *ngIf="checkExtension(doc.ext,'audio') != -1"
                                                src="/assets/images/md-audio.png">
                                            <img *ngIf="checkExtension(doc.ext,'ppt') != -1"
                                                src="/assets/images/md-ppt.png">


                                        </div>
                                    </div>

                                    <div class="pointer" class="edit-option-show">
                                        <a (click)="removeDocument(doc.token)"><i class="fas fa-trash"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="d-block justify-content-left border-0 mt-3">
                                <button type="button" data-toggle="modal" (click)="save()"
                                    class="btn btn-active"
                                    [disabled]="AppStore.loading||checkFileIsUploading() || checkDocumentEmpty()||form.controls.user_user_report_id.invalid">{{ AppStore.loading  ? 'Loading...' : 'Save' }}</button>
                                <button type="button" data-toggle="modal" (click)="save(true)"
                                    class="btn"
                                    [disabled]="AppStore.loading ||checkFileIsUploading() || checkDocumentEmpty()||form.controls.user_user_report_id.invalid">{{ AppStore.loading  ? 'Loading...' : 'Save & Close' }}</button>
                                <button type="button" data-toggle="modal" (click)="closeFormModal()"
                                    class="btn">{{ AppStore.loading  ? 'Loading...' : 'Cancel' }}</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <!-- Modal footer -->
        </div>
    </div>

</div>


<!-- <div class="modal modal-style-1 popup-full-width fade" data-keyboard="false" data-backdrop="static" #descriptionModal>
    <button type="button" class="close" (click)="closeViewMore()"><i class="lni-close"></i><span>esc</span></button>
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
         
            <div class="modal-header">
            </div>
         
            <div class="modal-body form-body">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="form-group form-group-add-report">
                            <label for="name">{{'description'|translate}}</label>
                            <p class="head-details" *ngIf="selectedReport" style="white-space: pre-wrap;">
                                {{selectedReport.user_report.description}}</p>
                        </div>
                    </div>
                </div>

            </div>
        
        </div>
    </div>
</div> -->


<div class="modal modal-style-1 popup-full-width fade popup-new-type " id="document-popup" data-keyboard="false"
    data-backdrop="static" #detailsModal>
    <button type="button" class="close" (click)="closePreviewModal()" data-dismiss="modal"><i
            class="lni-close"></i><span>{{'esc'|translate}}</span></button>
    <div class="modal-dialog modal-lg modal-dialog-centered size-adjust-popup" *mobxAutorun>
        <div class="modal-content bg-main" *ngIf="UserActualReportStore.individualReportDetails">


            <div class="modal-header">

                <div class="header-new-popup clearfix">
                    <div class="d-flex flex-row user-list-sm user-list-no-hov user-box-smol-round p-0">

                        <img *ngIf="checkExtension(UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.ext,'excel') != -1"
                            src="/assets/images/md-xl.png" width="30px" height="30px">
                        <img *ngIf="checkExtension(UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.ext,'image') != -1"
                            src="/assets/images/md-jpg.png" width="30px" height="30px">
                        <img *ngIf="checkExtension(UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.ext,'doc') != -1"
                            src="/assets/images/md-doc.png" width="30px" height="30px">
                        <img *ngIf="checkExtension(UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.ext,'pdf') != -1"
                            src="/assets/images/md-pdf.png" width="30px" height="30px">

                        <div class="pointer new-size-text">
                            <h6 class="big-name">
                                {{UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.title.length>35?UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.title.substring(0,35)+' ...':UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.title}}
                            </h6>
                            <span>{{UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.size/1048576 | number:'0.2-2'}}MB</span>

                        </div>
                    </div>
                    <!-- <span
                        class="indication-text color-blue">{{UserActualReportStore.individualReportDetails.user_report_status.title}}</span> -->
                    <div class="popup-link-icon">
                        <!-- <a class="pointer" [attr.title]="'chatbox'"> <i class="far fa-comment-dots"></i></a> -->
                        <a class="pointer" [attr.title]="'download'"
                            (click)="downloadDocument(UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index])"
                            *ngIf="AuthStore.getActivityPermission(200,'DOWNLOAD_USER_ACTUAL_REPORT_DOCUMENT_FILE')"><i
                                class="fas fa-download"></i></a>
                    </div>
                </div>
            </div>
            <div class="bg-light-grey p-3" style="border-right: none;">

                <div class="popup-new-type relative">
                    <div class="bg-white height-popup-new d-flex align-items-center">

                        <iframe
                            *ngIf="checkExtension(UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.ext,'image') == -1"
                            [attr.src]="UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]['preview_src']"
                            frameborder="0" height="500px" width="100%"></iframe>
                        <div *ngIf="checkExtension(UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]?.ext,'image') != -1"
                            class="popup-pic-img-new">
                            <img width="100%"
                                [attr.src]="UserActualReportStore.individualReportDetails.user_actual_report.documents[current_index]['preview_src']"
                                onerror = "this.src='/assets/images/user-demo2.png'">
                        </div>

                        <div class="popup-slider-control clearfix"
                            *ngIf="UserActualReportStore.individualReportDetails.user_actual_report.documents.length>1">
                            <a *ngIf="current_index!=0" class="popup-slider-control-left"><i class="fas fa-chevron-left"
                                    (click)="addImageIndex(-1)"></i></a>
                            <a *ngIf="current_index!=UserActualReportStore.individualReportDetails.user_actual_report.documents.length-1"
                                class="popup-slider-control-right"><i class="fas fa-chevron-right"
                                    (click)="addImageIndex(1)"></i></a>
                        </div>
                    </div>

                </div>

                <div class="uploaded-files margin-left-15"
                *ngIf="UserActualReportStore.individualReportDetails.user_actual_report.documents.length>1">
                <a *ngIf="UserActualReportStore.individualReportDetails.user_actual_report.documents.length>3 && current_index>0" class="pointer"
                  (click)="addImageIndex(-1)"><i class="fas fa-angle-up"></i></a>
                <a class="pointer" *ngFor="let ind of documentArray()" [ngClass]="current_index==ind?'active':''"
                  (click)="setCurrentIndex(ind)"> {{ind+1}} </a>
                <a *ngIf="UserActualReportStore.individualReportDetails.user_actual_report.documents.length>3 && current_index!=UserActualReportStore.individualReportDetails.user_actual_report.documents.length-1"
                  class="pointer" (click)="addImageIndex(1)"><i class="fas fa-angle-down"></i></a> </div>

                <!-- <div class="uploaded-files"
                    *ngIf="UserActualReportStore.individualReportDetails.user_actual_report.documents.length>1">

                    <a *ngFor="let ind of UserActualReportStore.individualReportDetails.user_actual_report.documents;let i=index"
                        [ngClass]="current_index==i?'active':''"> {{i+1}} </a></div> -->


            </div>


            <div class="row">
                <div class="col-xl-12">
                    <div class="d-flex flex-row user-list-sm bg-white pt-2">
                        <img *ngIf="!UserActualReportStore.individualReportDetails.created_by.image.token"
                            src="/assets/images/user-demo2.png" width="30px" height="30px" class="rounded-circle">
                        <img *ngIf="UserActualReportStore.individualReportDetails.created_by.image.token"
                            [attr.src]="createImagePreview('user-profile-picture',UserActualReportStore.individualReportDetails.created_by.image.token)"
                            onerror = "this.src='/assets/images/user-demo2.png'"
                            width="30px" height="30px" class="rounded-circle">
                        <div class="w-100">
                            <h6>
                                {{UserActualReportStore.individualReportDetails.created_by.first_name}}{{UserActualReportStore.individualReportDetails.created_by.last_name}}
                            </h6>
                            <span>
                                {{UserActualReportStore.individualReportDetails.created_by.designation}} | {{'created_on'|translate}}
                                {{UserActualReportStore.individualReportDetails.created_at|date : OrganizationGeneralSettingsStore.organizationSettings.date_format}}</span>
                        </div>
                        <!-- <button type="button" data-toggle="modal" (click)="save()"
                            class="btn ordinary-btn mr-3 btn-active">Submit</button> -->
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<!------------------- Delete Confirmation Modal Start --------------------------->

<div class="modal modal-style-1 fade" id="delete-popup" data-backdrop="static" data-keyboard="false" #deletePopup>
    <app-delete-popup [source]="deleteObject"></app-delete-popup>
</div>

<!------------------- Delete Confirmation Modal End --------------------------->

<!-- preview component for image preview -->
<div class="modal modal-style-1 popup-full-width fade popup-new-type" id="add-three-popup" data-keyboard="false"
  data-backdrop="static" #filePreviewModal *mobxAutorun>
  <button type="button" class="close" data-dismiss="modal" (click)="closeReportPreviewModal($event)"><i
      class="lni-close"></i><span>{{'esc'|translate}}</span></button>
  <app-previewcomponent *ngIf="previewObject.uploaded_user" [source]="previewObject" (close)="closeReportPreviewModal($event)">
  </app-previewcomponent>
</div>
<!-- preview modal end -->