<!-- [routerLink]="['/human-capital/assessments/edit-assessment']" -->
<ng-container *mobxAutorun>
<div class="tab-pane" id="products" *ngIf="AssessmentStore.user_assessment_loaded && AuthStore.getActivityPermission(200,'USER_COMPETENCY_ASSESSMENTS')">
<div class="widget-body-light">
  <div class="row">
    <div class="col-lg-8 col-sm-12">
      <div class="panel-group panel-drop-sections panel-drop-white" *ngIf="AssessmentStore?.userAssessment?.length>0" id="jd" role="tablist" aria-multiselectable="true">
        <div class="panel panel-default" *ngFor="let assessment of AssessmentStore.userAssessment;let num=index">
          <div [ngClass]="assessment.is_accordion_active == true ? 'panel-heading active' : 'panel-heading'"  role="tab" id="headingOne">
            <div class="panel-title">
              <a role="button" (click)="setCurrentAssessment(assessment.competency_group_id,num)" data-toggle="collapse" aria-expanded="true"
                aria-controls="collapse-one">
                <h5 class="width96pc mt-0">{{assessment.competency_group_title}}<span class="drop-down-icone"><i
                      class="fas fa-chevron-down"></i></span> </h5>
              </a>
            </div>
          </div>
          <div [ngClass]="assessment.is_accordion_active == true ? 'drop-detail-sec panel-collapse collapse show' : 'drop-detail-sec panel-collapse collapse'" role="tabpanel"
            aria-labelledby="headingOne" >
            <div class="panel-body bg-white">

              <div class="competency-progrss-main">
                <span class="value-cmn value-top-center">5</span>
                <!-- repeat -->
                <div class="competency-progrss" *ngFor="let competency of assessment.competencies">
                  <span class="value-cmn position-name">{{competency.competency_title}}</span>
                  <div class="progress">
                    <div class="require-competencies high" data-toggle="tooltip" title="Required"
                       [style.margin-left.%]="competency.required*10">
                      <span class="require-flag-icon"><img src="/assets/images/flag-pic.png" class="img-fluid"></span>
                      <span class="require-number">{{competency.required}}</span>
                    </div>
                    <div [ngClass]="competency.competency_score<competency.required?'progress-bar bg-danger progress-bar-animation':'progress-bar bg-success progress-bar-animation'" role="progressbar" aria-valuenow="50"
                      aria-valuemin="0" aria-valuemax="100" [style.max-width.%]="competency.competency_score*10"><span class="value-inner">{{competency.competency_score}}</span>
                    </div>
                  </div>
                </div>
                <div class="relative">
                  <div class="competency-progrss-bottom-line">
                    <span class="value-cmn value-left">0</span>
                    <span class="value-cmn value-right">10</span>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
        
        
        


      </div>

      <div class="panel-group panel-drop-sections panel-drop-white" id="jd2" role="tablist" aria-multiselectable="true" *ngIf="DesignationMasterStore.competencies.length>0 && !(AssessmentStore?.userAssessment?.length>0)">
        <div class="panel panel-default" *ngFor="let assessment of DesignationMasterStore.competencies;let num=index">
          <div [ngClass]="assessment.is_accordion_active == true ? 'panel-heading active' : 'panel-heading'"  role="tab" id="headingOne">
            <div class="panel-title">
              <a role="button" (click)="setCurrentAssessment(assessment.competency_group_id,num)" data-toggle="collapse" aria-expanded="true"
                aria-controls="collapse-one">
                <h5 class="width96pc mt-0">{{assessment.competency_group}}<span class="drop-down-icone"><i
                      class="fas fa-chevron-down"></i></span> </h5>
              </a>
            </div>
          </div>
          <div [ngClass]="assessment.is_accordion_active == true ? 'drop-detail-sec panel-collapse collapse show' : 'drop-detail-sec panel-collapse collapse'" role="tabpanel"
            aria-labelledby="headingOne" >
            <div class="panel-body bg-white">

              <div class="competency-progrss-main">
                <span class="value-cmn value-top-center">5</span>
                <!-- repeat -->
                <div class="competency-progrss" *ngFor="let competency of assessment.competencies">
                  <span class="value-cmn position-name">{{competency.title}}</span>
                  <div class="progress">
                    <div class="require-competencies high" data-toggle="tooltip" title="Required"
                       [style.margin-left.%]="competency.required*10">
                      <span class="require-flag-icon"><img src="/assets/images/flag-pic.png" class="img-fluid"></span>
                      <span class="require-number">{{competency.required}}</span>
                    </div>
                    <div class="progress-bar bg-danger progress-bar-animation" role="progressbar" aria-valuenow="50"
                      aria-valuemin="0" aria-valuemax="100" style="max-width:0%;"><span class="value-inner">0</span>
                    </div>
                  </div>
                </div>
                <div class="relative">
                  <div class="competency-progrss-bottom-line">
                    <span class="value-cmn value-left">0</span>
                    <span class="value-cmn value-right">10</span>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
        
        
        


      </div>
      <!-- <div class="row">
        <div class="col-sm-12">
          <ul class="pagination justify-content-center mt-3">
            <li class="page-item"><a class="page-link" href="javascript:void(0);"><i
                  class="fas fa-chevron-left"></i></a></li>
            <li class="page-item"><a class="page-link active" href="javascript:void(0);">1</a></li>
            <li class="page-item"><a class="page-link" href="javascript:void(0);">2</a></li>
            <li class="page-item"><a class="page-link" href="javascript:void(0);"><i
                  class="fas fa-chevron-right"></i></a></li>
            <li class="page-item"><input type="text" class="pagination-input" placeholder="100"></li>
            <li class="page-item"><a class="page-link per-page">Per Page</a></li>
          </ul>
        </div>
      </div> -->
    </div>
    <div class="col-lg-4 col-sm-12 padding-left-0" *ngIf="AssessmentStore?.lastAssessment || (AssessmentStore.user_assessment_loaded && !(AssessmentStore?.userAssessment?.length>0) && DesignationMasterStore.competencies.length>0)">
      <div class="risk-rating-box bg-white p-3 text-left">
        <h6 class="text-left">{{'last_assessment_details'|translate}}</h6>
        <hr class="mt-0 mb-3">

        <div class="d-flex flex-row user-box user-list-sm pt-0" *ngIf="AssessmentStore?.lastAssessment">
          <img [attr.src]="AssessmentStore?.lastAssessment?.last_assessment_image_token?createImagePreview('user-profile-picture',AssessmentStore.lastAssessment.last_assessment_image_token):getDefaultImage('user-logo')" 
          width="30px" height="30px" 
          class="rounded-circle"
          onerror = "this.src='/assets/images/user-demo2.png'">
          <div>
            <h6>{{AssessmentStore.lastAssessment.last_assessment_first_name}} {{AssessmentStore.lastAssessment.last_assessment_last_name}}</h6>
            <span>{{AssessmentStore.lastAssessment.last_assessment_designation}}</span>
          </div>
        </div>
        <div class="d-flex align-items-center" *ngIf="AssessmentStore?.lastAssessment">
          <div class="last-assessment-icon" style="font-size: 27px;">
            <i class="fas fa-history"></i>
          </div>
          <div class="last-assessment-text">
            <p class="mb-0">{{AssessmentStore.lastAssessment.last_assessment_date|date:OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</p>
            <p class="text-red mb-0">({{createDaysString(AssessmentStore.lastAssessment.days)}})</p>
          </div>
        </div>
        <ng-container>
          <app-no-data *ngIf="AssessmentStore.user_assessment_loaded && !(AssessmentStore?.userAssessment?.length>0) && DesignationMasterStore.competencies.length>0"></app-no-data>
        </ng-container>
        <div *ngIf="!(AssessmentStore.user_assessment_loaded && !(AssessmentStore?.userAssessment?.length>0))" class="text-center mt-3" [routerLink]="['/human-capital/assessments/edit-assessment']">
          <button type="button" class="btn">{{'new_assessment'|translate}}</button>
        </div>
      </div>
    </div>
  </div>


</div>

</div>
</ng-container>

<ng-container *mobxAutorun>
  <app-user-competency-loader *ngIf="!AssessmentStore.user_assessment_loaded"></app-user-competency-loader>
</ng-container>

<ng-container *mobxAutorun>
  <app-no-data *ngIf="AssessmentStore.user_assessment_loaded && !(AssessmentStore?.userAssessment?.length>0) && DesignationMasterStore.competencies.length==0"></app-no-data>
</ng-container>