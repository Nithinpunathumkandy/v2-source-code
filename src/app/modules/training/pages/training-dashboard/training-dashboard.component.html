

<nav class="edit-bar" data-toggle="affix" scrollPoint #navigationBar *mobxAutorun>
   <app-breadcrumb-menu></app-breadcrumb-menu>
   <div class="module-name-block module-name-block-space float-left">
      <a class="dropdown module-title">{{'dashboard'|translate}}</a>
    </div>
   <!-- <div class="dropdown edit-dropdown d-lg-none">
       <a class="btn btn-primary float-left three-dots-dropdown dropdown-toggle" data-toggle="dropdown"><i
               class="fas fa-ellipsis-v"></i></a>
       <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
           <a class="dropdown-item" data-toggle="pill" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
               [routerLink]="['/trainings/dashboard']">{{'dashboard'|translate}}</a>
       </div>
   </div>
   <ul class="nav nav-pills float-left  d-none d-lg-block" role="tablist">
       <li class="nav-item">
           <a class="nav-link active" data-toggle="pill" routerLinkActive="active"
               [routerLinkActiveOptions]="{exact: true}"
               [routerLink]="['/trainings/dashboard']">{{'dashboard'|translate}}</a>
       </li>
      
   </ul> -->
   
</nav>
<main class="mt-3 acl-page cpf-space-adjust db-small-space-boxes db-layout-150" >
    <div class="container-fluid" *mobxAutorun>
      <app-filter-menu></app-filter-menu>
       <div class="widget" *ngIf="TrainingDashboardStore.dashboardLoaded">
          <div class="row sm-row">
             <div class="col-lg-6 col-sm-12 sm-col main-db-risk">
                <div class="row sm-row">
                   <div class="col-lg-6 col-sm-6 sm-col">
                      <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                         <div class="row align-items-center justify-content-center">
                            <div class="text-center">
                              <h3 class="big-text-four">{{TrainingDashboardStore.TrainingCount?.total_training}}</h3>
                               <h5 class="mb-0">{{'total_trainings' | translate}}</h5>
                             
                            </div>
                         </div>
                      </div>
                   </div>
                   <div class="col-lg-6 col-sm-6 sm-col">
                      <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                         <div class="row align-items-center justify-content-center">
                            <div class="text-center">
                              <h3 class="big-text-four">{{TrainingDashboardStore.TrainingAttendies?.total_attendees}}</h3>
                               <h5 class="mb-0">{{'total_attendees' | translate}}</h5>
                            </div>
                         </div>
                      </div>
                   </div>
                </div>
                <div class="row sm-row left-small-boxes-training">
                   <div class="col-lg-3 col-sm-3 sm-col left-small-boxes-training">
                      <div class="bg-white padding-small-10 btm-space-10 risk-db-left-one relative"
                      [ngStyle]="{'min-height': TrainingDashboardStore.totalItems>5 ? '128px' : '115px'}">
                         <div class="left-line-type-text-main d-inline-block">
                            <div class="left-line-type-text">
                               <!-- <span class="big-line-bdr-left" [ngStyle]="{'background': TrainingDashboardStore.TrainingPieStatus ? '#00FF00' : 'none'}"></span> -->
                               <h6 class="mb-1">{{TrainingDashboardStore.TrainingCount?.total_completed_training}}</h6>
                               <p class="dot-div-new mb-0 db-status"><span [ngStyle]="{'background': TrainingDashboardStore.TrainingPieStatus ? '#00FF00' : 'none'}"></span>{{'completed' | translate}}</p>
                               
                               <!-- <h5>{{'completed' | translate}}</h5> -->

                            </div>
                         </div>
                         <div class="bottom-right-value-box db-light-light-color top-right-value-box">{{TrainingDashboardStore.TrainingCount?.completed_training_percentage}}%</div>
                      </div>

                      <div class="bg-white padding-small-10 btm-space-10 risk-db-left-one relative"
                      [ngStyle]="{'min-height': TrainingDashboardStore.totalItems>5 ? '128px' : '115px'}">
                         <div class="left-line-type-text-main d-inline-block">
                            <div class="left-line-type-text">
                               <!-- <span class="big-line-bdr-left" [ngStyle]="{'background': TrainingDashboardStore.TrainingPieStatus ? '#0000FF' : 'none'}"></span> -->
                               <h6 class="mb-1">{{TrainingDashboardStore.TrainingCount?.total_upcoming_training}}</h6>
                               <p class="dot-div-new mb-0 db-status"><span [ngStyle]="{'background': TrainingDashboardStore.TrainingPieStatus ? '#0000FF' : 'none'}"></span>{{'upcoming' | translate}}</p>
                               
                               <!-- <h5>{{'upcoming' | translate}} </h5> -->
                              
                            </div>
                         </div>
                         <div class="bottom-right-value-box db-light-light-color top-right-value-box">{{TrainingDashboardStore.TrainingCount?.upcoming_training_percentage}}%</div>
                      </div>

                      <div class="bg-white padding-small-10 btm-space-10 risk-db-left-one relative"
                      [ngStyle]="{'min-height': TrainingDashboardStore.totalItems>5 ? '128px' : '115px'}">
                         <div class="left-line-type-text-main d-inline-block">
                            <div class="left-line-type-text">
                               <!-- <span class="big-line-bdr-left" [ngStyle]="{'background': TrainingDashboardStore.TrainingPieStatus ? '#FFFF00' : 'none'}"></span> -->
                               <h6 class="mb-1">{{TrainingDashboardStore.TrainingCount?.total_ongoing_training}}</h6>
                               <p class="dot-div-new mb-0 db-status"><span [ngStyle]="{'background': TrainingDashboardStore.TrainingPieStatus ? '#FFFF00' : 'none'}"></span>{{'ongoing' | translate}}</p>
                               
                               <!-- <h5>{{'ongoing' | translate}}</h5> -->
                               
                            </div>
                         </div>
                         <div class="bottom-right-value-box db-light-light-color top-right-value-box">{{TrainingDashboardStore.TrainingCount?.ongoing_training_percentage}}%</div>
                      </div>

                      <!-- <div class="bg-white padding-small-10 btm-space-10 risk-db-left-one relative"
                      [ngStyle]="{'min-height': TrainingDashboardStore.totalItems>5 ? '128px' : '115px'}"
                      *ngFor="let row of TrainingDashboardStore.TrainingPieStatus">
                         <div class="left-line-type-text-main d-inline-block">
                            <div class="left-line-type-text">
                               <span class="big-line-bdr-left" [ngStyle]="{'background':row.color}"></span>
                               <h5>{{row.training_statuses}} <br> {{'trainings' | translate}}</h5>
                               <h6>{{row.count}}</h6>
                            </div>
                         </div>
                         <div class="bottom-right-value-box db-light-light-color">{{calculatePercentage(row.count,null)}}%</div>
                      </div> -->

                      <div class="bg-white padding-small-10 btm-space-10 risk-db-left-one relative"
                      [ngStyle]="{'min-height': TrainingDashboardStore.totalItems>5 ? '128px' : '115px'}">
                         <div class="left-line-type-text-main d-inline-block">
                            <div class="left-line-type-text">
                               <!-- <span class="big-line-bdr-left" [ngStyle]="{'background': TrainingDashboardStore.TrainingPieStatus ? '#FF0000' : 'none'}"></span> -->
                               <h6 class="mb-1">{{TrainingDashboardStore.TrainingCount?.total_cancelled_training}}</h6>
                               <p class="dot-div-new mb-0 db-status"><span [ngStyle]="{'background': TrainingDashboardStore.TrainingPieStatus ? '#FF0000' : 'none'}"></span>{{'cancelled' | translate}}</p>
                              
                               <!-- <h5>{{'cancelled' | translate}}</h5> -->
                              
                            </div>
                         </div>
                         <div class="bottom-right-value-box db-light-light-color top-right-value-box">{{TrainingDashboardStore.TrainingCount?.cancelled_training_percentage}}%</div>
                      </div>
                   </div>
                   <div class="col-lg-9 col-sm-9 sm-col">
                      <div class="bg-white widg-padding-cmn btm-space-10 risk-db-left-two">
                         <h6>{{'training_status' | translate}}</h6>
                         <hr>
                         <div class="ceo-db-aut-sec-row-height"
                          [ngStyle]="{'min-height': TrainingDashboardStore.totalItems>5 ? '482px' : '418px'}">
                            <div class="dpt-pic-ceo w-100" *ngIf="!showPieNoDataMap">
                              <div id="trainingchart" style="width: 100%; height: 420px" #trainingchart></div>
                               
                            </div>
                            <div class="dpt-pic-ceo db-md-screen-center" *ngIf="showPieNoDataMap" style="min-height: 406px;">
                              <app-no-chart-data [source]="trainingPieChart">
                              </app-no-chart-data>
                           </div>
                         </div>
                      </div>
                   </div>
                </div>
             </div>
             <div class="col-lg-6 col-sm-12 sm-col">
               <div class="bg-white widg-padding-cmn btm-space-10 tab-with-text-db training-right-main">
                  <div class="row widget-heading line-tab">
                     <div class="col-lg-6 col-md-12">
                        <h5 class="cmn-head-style m-0 pt-2">
                           <!-- {{'latest_trainings' | translate}} -->
                           Latest {{TrainingDashboardStore.trainingStatus}} Trainings
                        </h5>
                     </div>

                     <!-- select box -->
                     <!-- <div class="col-lg-6 col-md-12">
                        <div class="small-slect-btn btn-clr-select clearfix">
                           <div class="form-group mb-0 float-right w-50">
                              <div class="clearfix d-flex">
                                 <div class="plain-select w-100">
                                    <select class="form-control" name="test" (change)="getTraining($event.srcElement.value)">                               
                                       <option *ngFor="let row of TrainingStatusMasterStore.allItems" [value]="row.id">
                                          {{row.title}}
                                       </option>                             
                                    </select>
                                 </div>
                                 
                               </div>
                          </div>
                       </div>
                     </div> -->
                     <!-- select box end-->
                     
                     <!-- <div class="col-lg-6 col-md-12">

                        <div class="dropdown float-right">
                           <button class="btn-small mb-2 btn-primary dropdown-toggle" type="button" data-toggle="dropdown">{{buttonText}}
                              <i class="fas fa-chevron-down" style="font-size:12px;"></i></button>
                           <ul class="dropdown-menu">
                             <li *ngFor="let row of TrainingStatusMasterStore.allItems"><a (click)="getTraining(row)">{{row.title}}</a></li> -->
                             <!-- <li><a (click)="getTraining()">Completed</a></li>
                             <li><a (click)="getTraining()">Cancelled</a></li> -->
                           <!-- </ul>
                         </div>

                     </div> -->
                  </div>
                  <hr>

                  <div class="pt-2" style="min-height: 558px;">
                     <div class="dpt-pic-ceo w-100">
                        <div class="top-ten-risk-db-main training-right-box">

                           <div class="slider-db-top-ten-sec">
                              <!-- <div id="owl-demo-2" class="owl-carousel owl-theme"> -->

                                 <owl-carousel-o [options]="clientOptions"> 
                                    
                                    <ng-container *ngIf="TrainingDashboardStore.Training?.length!=0">
                                  <ng-template carouselSlide>
                                     
                                    <div class="top-ten-risk-db"
                                    *ngFor="let row of getSecondList(TrainingDashboardStore.Training,'first'); let num=index" >
                                       <div class="d-flex align-items-center">
                                          <h4 class="border-right pr-2">{{num+1}}</h4>
                                          <div class="middle-text-sec-risk-db w-40">
                                             <div class="pt-2 pb-2">
                                             <h5>{{row.title | titlecase}}
                                             </h5>
                                             <h5 class="font-normal">{{row.start_date | date:
                                                OrganizationGeneralSettingsStore.organizationSettings?.date_format}}-{{row.end_date | date:
                                                    OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</h5>
                                              <h5 class="mb-0 font-normal"><span class="mr-1"><i class="fas fa-clock"></i></span>{{row.start_date | date: 'h:mm a'}} - {{row.end_date | date: 'h:mm a'}}</h5>
                                             </div>
                                          </div>
                                          <div class="middle-text-sec-risk-db w-29">
                                             <h5>{{'competency' | translate}}</h5>
                                             <p>{{row.training_category_title}}
                                             </p>
                                          </div>
                                          <div class="middle-text-sec-risk-db w-30">
                                             <div class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg p-0"> 
                                                <!-- <img src="/assets/images/user-gate.jpg" width="30px" height="30px" class="rounded-circle"> -->
                                                 <img *ngIf="row?.created_by_image_token"
                                                [attr.src]="createImagePreview('user-profile-picture',row?.created_by_image_token)"
                                                style="width: 30px; height: 30px" class="rounded-circle">
                                             <img *ngIf="!row?.created_by_image_token" [attr.src]="getDefaultImage('user-logo')"
                                                style="width: 30px; height: 30px" class="rounded-circle">
                                                <div class="pointer new-size-text text-left ml-1">
                                                    <h5 class="pb-0 mb-0">{{row.created_by_first_name}} {{row.created_by_last_name}}</h5>
                                                    <span class="pt-0">{{row.created_by_designation}}</span>
                                                </div>
                                            </div>
                                          </div>
                                       </div>
                                    </div>
                                  </ng-template>
                                    </ng-container>
                                    <ng-container *ngIf="TrainingDashboardStore.Training?.length!=0">
                                       <ng-template *ngIf="TrainingDashboardStore.totalItems>5" carouselSlide>
                                         <div class="top-ten-risk-db"
                                         *ngFor="let row of TrainingDashboardStore.secondTraining; let num=index" >
                                            <div class="d-flex align-items-center">
                                               <h4 class="border-right pr-2">{{num+6}}</h4>
                                               <div class="middle-text-sec-risk-db w-40">
                                                <div class="pt-2 pb-2">
                                                  <h5>{{row.title | titlecase}}
                                                  </h5>
                                                  <h5 class="font-normal">{{row.start_date | date:
                                                     OrganizationGeneralSettingsStore.organizationSettings?.date_format}}-{{row.end_date | date:
                                                         OrganizationGeneralSettingsStore.organizationSettings?.date_format}}</h5>
                                                   <h5 class="mb-0 font-normal"><span class="mr-1"><i class="fas fa-clock"></i></span>{{row.start_date | date: 'h:mm a'}} - {{row.end_date | date: 'h:mm a'}}</h5>
                                                </div>
                                               </div>
                                               <div class="middle-text-sec-risk-db w-29">
                                                  <h5>{{'competency' | translate}}</h5>
                                                  <p>{{row.training_category_title}}
                                                  </p>
                                               </div>
                                               <div class="middle-text-sec-risk-db w-30">
                                                  <div class="d-flex flex-row user-list-sm user-box-smol-round user-box-smol-round-table-scrol rounde-hov-bg p-0">
                                                     <!-- <img src="/assets/images/user-gate.jpg" width="30px" height="30px" class="rounded-circle"> -->
                                                      <img *ngIf="row?.created_by_image_token"
                                                     [attr.src]="createImagePreview('user-profile-picture',row?.created_by_image_token)"
                                                     style="width: 30px; height: 30px" class="rounded-circle">
                                                  <img *ngIf="!row?.created_by_image_token" [attr.src]="getDefaultImage('user-logo')"
                                                  style="width: 30px; height: 30px" class="rounded-circle">
                                                     <div class="pointer new-size-text text-left ml-1">
                                                         <h5 class="pb-0 mb-0">{{row.created_by_first_name}} {{row.created_by_last_name}}</h5>
                                                         <span class="pt-0">{{row.created_by_designation}}</span>
                                                     </div>
                                                 </div>
                                               </div>
                                            </div>
                                         </div>
                                       </ng-template>
                                         </ng-container>
                                 </owl-carousel-o>
                                 <ng-container>
                                    <app-no-data *ngIf="TrainingDashboardStore.Training?.length==0">
                                    </app-no-data>
                                 </ng-container>     
                           </div>
                       </div>
                     </div>
                  </div>
               </div>        
             </div>
          </div>
          <div class="row sm-row">
             <div class="col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 tab-with-text-db">
                   <div class="row widget-heading line-tab">
                      <div class="col-lg-6 col-md-12">
                         <h5 class="cmn-head-style m-0">{{'trainings' | translate}}</h5>
                      </div>
                      <div class="col-lg-6 col-md-12">
                         <ul class="nav nav-tabs float-right">
                           <li class="nav-item"> <a (click)="createBarChart(1)" class="nav-link active show" data-toggle="tab"
                                 href="#by-department-cpf" data-original-title="" title="">{{'by_competency' | translate}}</a> </li>
                           <li class="nav-item"> <a (click)="createBarChart(4)" class="nav-link show" data-toggle="tab" href="#by-competency-group"
                                 data-original-title="" title="">{{'by_competency_group' | translate}}</a> </li>
                           <li class="nav-item"> <a (click)="createBarChart(2)" class="nav-link" data-toggle="tab" href="#by-year-cpf"
                                 data-original-title="" title="">{{'by_year' | translate}}</a> </li>
                           <li class="nav-item"> <a (click)="createBarChart(3)" class="nav-link" data-toggle="tab" href="#by-department-training"
                                 data-original-title="" title="">{{'by_department' | translate}}</a> </li>
                         </ul>
                      </div>
                   </div>
                  <div class="tab-content tab-content-body pt-3">
                     <div class="tab-pane active show" id="by-department-cpf">
                        <div class="ceo-db-aut-sec-row-height">
                           <div class="dpt-pic-ceo w-100">
                              <div id="barChartCompetency" style="width: 100%;height: 250px;" #barChartCompetency></div>
                           </div>
                        </div>               
                     </div>
                     <div class="tab-pane fade" id="by-competency-group">
                        <div class="ceo-db-aut-sec-row-height">
                           <div class="dpt-pic-ceo w-100">
                              <div id="barChartCompetencyGroup" style="width: 100%;height: 250px;" #barChartCompetencyGroup></div>
                           </div>
                        </div>               
                     </div>
                     <div class="tab-pane fade" id="by-year-cpf">
                        <div class="ceo-db-aut-sec-row-height">
                           <div class="dpt-pic-ceo w-100">
                              <div id="barChartYears" style="width: 100%;height: 250px;" #barChartYears></div>
                           </div>
                        </div>
                     </div>
                     <div class="tab-pane fade" id="by-department-training">
                        <div class="ceo-db-aut-sec-row-height">
                           <div class="dpt-pic-ceo w-100">
                              <div id="barChartDepartment" style="width: 100%;height: 250px;" #barChartDepartment></div>
                           </div>
                        </div>
                     </div>
                  </div>
                </div>
             </div>

          </div>


       </div>
      <ng-container *mobxAutorun>
         <div *ngIf="!TrainingDashboardStore.dashboardLoaded">
            <app-training-dashboard-loader></app-training-dashboard-loader>
         </div>
      </ng-container>
    </div>
 </main>
