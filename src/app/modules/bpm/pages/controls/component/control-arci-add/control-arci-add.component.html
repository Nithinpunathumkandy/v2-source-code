<div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">{{'controll_arci' | translate}}</h4>
      </div>
      <!-- Modal body -->
      <div class="modal-body form-body" [formGroup]="arciMatrixForm">
        <!-- <p class="head-details">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. <a href="#">learn more</a> Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea comt in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident.</p> -->
        <div class="row">
          <div class="col-sm-12">
            <div class="form-group">
              <label>{{'control' | translate}}<span class="form-error">*</span></label>
              <div class="clearfix">
                 <div class="multiple-plain-ngselect">
                  <ng-select [placeholder]="'select_control' | translate" [multiple]="false" searchable="true" formControlName="control_id"
                  (clear)="getControl()" (open)="getControl()" (change)="controlChange($event)"   (search)="searchControl($event)">
                  <ng-option [value]="type.id" *ngFor="let type of ControlStore.controlList">
                      {{type.title}}
                  </ng-option>
              </ng-select>
                 </div> 
              </div>
              <p class="form-error pt-1" *ngIf="arciMatrixFormErrors"> {{arciMatrixFormErrors.control_id}}</p>
            </div>
            <div class="form-group">
              <label>{{'accountable_users' | translate}}</label>
              <div class="clearfix">
                <div class="multiple-plain-ngselect">
                  <ng-select [items]="UsersStore.usersList" multiple="true" bindLabel="email"
                    [placeholder]="'select_accountable_users'|translate" formControlName="accountable_user_ids" [closeOnSelect]="false"  (search)="searchUers($event)"
                    (clear)="getUsers()" (open)="getUsers()" [searchFn]="customSearchFn">                
                    <ng-template ng-label-tmp let-item="item" let-clear="clear">
                      <img *ngIf = "item.image_token" class="ng-select-user-display" height="15" width="15" [attr.src]="createImageUrl('user-profile-picture',item.image_token)" onerror = "this.src='/assets/images/user-demo2.png'"/>
                      <img *ngIf = "!item.image_token" class="ng-select-user-display" height="15" width="15" [attr.src]="getDefaultImage('user-logo')"/>
                      <b style="padding-left: 3px;">{{getStringsFormatted([item.first_name,item.last_name],100,' ') | titlecase}}</b><span aria-hidden="true" (click) = "clear(item)" style="border:none;" class="ng-value-icon left">×</span>
                   </ng-template>
                   <ng-template ng-option-tmp let-item="item" let-index="index">
                      <div class="user-post-department-pic">
                         <img *ngIf = "item.image_token" class="ng-select-user-display" height="25" width="25" [attr.src]="createImageUrl('user-profile-picture',item.image_token)" onerror = "this.src='/assets/images/user-demo2.png'"/>
                         <img *ngIf = "!item.image_token" class="ng-select-user-display" height="25" width="25" [attr.src]="getDefaultImage('user-logo')"/>
                      </div>
                      <div class="user-post-department-div">
                         <b>{{getStringsFormatted([item.first_name,item.last_name],100,' ') | titlecase}}</b>
                         <p class="user-post-department-multiple">{{getStringsFormatted([item.designation_title,' '+item.department],100,',')}}</p>
                      </div>
                   </ng-template>
                  </ng-select>
                </div>
              </div> 
            </div>
            <div class="form-group">
              <label>{{'responsible_user' | translate}}</label>     
              <div class="clearfix">
                <div class="multiple-plain-ngselect">
                  <ng-select [items]="UsersStore.usersList" multiple="true" bindLabel="email"
                  [placeholder]="'select_responsible_users'|translate" formControlName="responsible_user_ids" [closeOnSelect]="false"   (search)="searchUers($event)"
                    (clear)="getUsers()" (open)="getUsers()" [searchFn]="customSearchFn">                 
                    <ng-template ng-label-tmp let-item="item" let-clear="clear">
                      <img *ngIf = "item.image_token" class="ng-select-user-display" height="15" width="15" [attr.src]="createImageUrl('user-profile-picture',item.image_token)" onerror = "this.src='/assets/images/user-demo2.png'"/>
                      <img *ngIf = "!item.image_token" class="ng-select-user-display" height="15" width="15" [attr.src]="getDefaultImage('user-logo')"/>
                      <b style="padding-left: 3px;">{{getStringsFormatted([item.first_name,item.last_name],100,' ') | titlecase}}</b><span aria-hidden="true" (click) = "clear(item)" style="border:none;" class="ng-value-icon left">×</span>
                   </ng-template>
                   <ng-template ng-option-tmp let-item="item" let-index="index">
                      <div class="user-post-department-pic">
                         <img *ngIf = "item.image_token" class="ng-select-user-display" height="25" width="25" [attr.src]="createImageUrl('user-profile-picture',item.image_token)" onerror = "this.src='/assets/images/user-demo2.png'"/>
                         <img *ngIf = "!item.image_token" class="ng-select-user-display" height="25" width="25" [attr.src]="getDefaultImage('user-logo')"/>
                      </div>
                      <div class="user-post-department-div">
                         <b>{{getStringsFormatted([item.first_name,item.last_name],100,' ') | titlecase}}</b>
                         <p class="user-post-department-multiple">{{getStringsFormatted([item.designation_title,' '+item.department],100,',')}}</p>
                      </div>
                   </ng-template>
                  </ng-select>
                </div>
            </div>
          </div>
            <div class="form-group">
              <label>{{'consulted_users' | translate}}</label>     
              <div class="clearfix">
                <div class="multiple-plain-ngselect">
                  <ng-select [items]="UsersStore.usersList" multiple="true" bindLabel="email" [closeOnSelect]="false"
                  [placeholder]="'select_consulted_users'|translate" formControlName="consulted_user_ids"   (search)="searchUers($event)"
                    (clear)="getUsers()" (open)="getUsers()" [searchFn]="customSearchFn">                
                    <ng-template ng-label-tmp let-item="item" let-clear="clear">
                      <img *ngIf = "item.image_token" class="ng-select-user-display" height="15" width="15" [attr.src]="createImageUrl('user-profile-picture',item.image_token)" onerror = "this.src='/assets/images/user-demo2.png'"/>
                      <img *ngIf = "!item.image_token" class="ng-select-user-display" height="15" width="15" [attr.src]="getDefaultImage('user-logo')"/>
                      <b style="padding-left: 3px;">{{getStringsFormatted([item.first_name,item.last_name],100,' ') | titlecase}}</b><span aria-hidden="true" (click) = "clear(item)" style="border:none;" class="ng-value-icon left">×</span>
                   </ng-template>
                   <ng-template ng-option-tmp let-item="item" let-index="index">
                      <div class="user-post-department-pic">
                         <img *ngIf = "item.image_token" class="ng-select-user-display" height="25" width="25" [attr.src]="createImageUrl('user-profile-picture',item.image_token)" onerror = "this.src='/assets/images/user-demo2.png'"/>
                         <img *ngIf = "!item.image_token" class="ng-select-user-display" height="25" width="25" [attr.src]="getDefaultImage('user-logo')"/>
                      </div>
                      <div class="user-post-department-div">
                         <b>{{getStringsFormatted([item.first_name,item.last_name],100,' ') | titlecase}}</b>
                         <p class="user-post-department-multiple">{{getStringsFormatted([item.designation_title,' '+item.department],100,',')}}</p>
                      </div>
                   </ng-template>
                  </ng-select>
                </div>
            </div>
            </div>
            <div class="form-group">
              <label>{{'informed_users' | translate}}</label>     
              <div class="clearfix">
                <div class="multiple-plain-ngselect">
                  <ng-select [items]="UsersStore.usersList" multiple="true" bindLabel="email" [closeOnSelect]="false"
                  [placeholder]="'selecet_informed_users'|translate" formControlName="informed_user_ids"   (search)="searchUers($event)"
                    (clear)="getUsers()" (open)="getUsers()" [searchFn]="customSearchFn">                
                    <ng-template ng-label-tmp let-item="item" let-clear="clear">
                      <img *ngIf = "item.image_token" class="ng-select-user-display" height="15" width="15" [attr.src]="createImageUrl('user-profile-picture',item.image_token)" onerror = "this.src='/assets/images/user-demo2.png'"/>
                      <img *ngIf = "!item.image_token" class="ng-select-user-display" height="15" width="15" [attr.src]="getDefaultImage('user-logo')"/>
                      <b style="padding-left: 3px;">{{getStringsFormatted([item.first_name,item.last_name],100,' ') | titlecase}}</b><span aria-hidden="true" (click) = "clear(item)" style="border:none;" class="ng-value-icon left">×</span>
                   </ng-template>
                   <ng-template ng-option-tmp let-item="item" let-index="index">
                      <div class="user-post-department-pic">
                         <img *ngIf = "item.image_token" class="ng-select-user-display" height="25" width="25" [attr.src]="createImageUrl('user-profile-picture',item.image_token)" onerror = "this.src='/assets/images/user-demo2.png'"/>
                         <img *ngIf = "!item.image_token" class="ng-select-user-display" height="25" width="25" [attr.src]="getDefaultImage('user-logo')"/>
                      </div>
                      <div class="user-post-department-div">
                         <b>{{getStringsFormatted([item.first_name,item.last_name],100,' ') | titlecase}}</b>
                         <p class="user-post-department-multiple">{{getStringsFormatted([item.designation_title,' '+item.department],100,',')}}</p>
                      </div>
                   </ng-template>
                  </ng-select>
                </div>
            </div>
            </div>
         
        </div>
       
          <div class="col-sm-12">
            <div class="d-block justify-content-left border-0 mt-3">
                <button type="submit" class="btn btn-active" (click)="saveARCI()"
                    [disabled]="validityCheck() || AppStore.loading">{{  AppStore.loading  ? getButtonText('loading') : getButtonText('save') }}</button>
                <button type="button" data-toggle="modal" data-target="#signal-lost"
                    class="btn" (click)="saveARCI(true)"
                    [disabled]="validityCheck() || AppStore.loading">{{  AppStore.loading  ? getButtonText('loading') : getButtonText('save_close') }}</button>
                <button type="button" data-toggle="modal" data-target="#error-message"
                    class="btn"
                    (click)="cancel()">{{  AppStore.loading  ? getButtonText('loading') : getButtonText('cancel')}}</button>
            </div>
        </div>
        
      </div>
      <!-- Modal footer -->
    </div>
  </div>