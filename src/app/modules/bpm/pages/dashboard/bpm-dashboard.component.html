<nav class="edit-bar" data-toggle="affix" scrollPoint #navigationBar *mobxAutorun>
   <app-breadcrumb-menu></app-breadcrumb-menu>
   <div class="module-name-block module-name-block-space float-left">
      <a class="dropdown module-title">{{'dashboard'|translate}}</a>
   </div>
   <!-- <ul class="nav nav-pills edit-icons float-right d-none d-xl-block" role="tablist">
      <li>
          <button (click) = "routeToQlikDashboard()" type="button" class="btn btn-small btn-header-db">
              {{'qlik_dashboard' | translate}}
          </button>
      </li>
   </ul> -->
</nav>

<main class="mt-3 acl-page db-small-space-boxes db-layout-150" *mobxAutorun>
   <div class="container-fluid">
      <app-filter-menu></app-filter-menu>
      <div class="widget" *ngIf="BPMDashboardStore.dashboardLoaded">
         <div class="row sm-row">
            <div class="col-lg-6 col-sm-12 sm-col">
               <div class="row sm-row">
                  <div class="col-lg-4 col-sm-4 sm-col">
                     <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                        <div class="row align-items-center justify-content-center">

                           <div class="text-center pointer"
                              (click)="redirectToListPage('process-groups',BPMDashboardStore.BPMCounts?.process_group_count)">
                              <h3 class="big-text-four">{{BPMDashboardStore.BPMCounts?.process_group_count}}</h3>
                              <h5 class="mb-0">{{'bpm_db_process_group'|translate}}</h5>

                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="col-lg-4 col-sm-4 sm-col" *ngIf = "OrganizationModulesStore.checkIndividualSubModule(600,23301)">
                     <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                        <div class="row align-items-center justify-content-center">

                           <div class="text-center pointer"
                              (click)="redirectToListPage('process',BPMDashboardStore.BPMCounts?.process_count)">
                              <h3 class="big-text-four">{{BPMDashboardStore.BPMCounts?.process_count}}</h3>
                              <h5 class="mb-0">{{'bpm_db_total_process'|translate}}</h5>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="col-lg-4 col-sm-4 sm-col" *ngIf = "OrganizationModulesStore.checkIndividualSubModule(600,11501)">
                     <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                        <div class="row align-items-center justify-content-center">
                           <div class="text-center pointer"
                              (click)="redirectToListPage('controls',BPMDashboardStore.BPMCounts?.process_control_count)">
                              <h3 class="big-text-four">{{BPMDashboardStore.BPMCounts?.process_control_count}}</h3>
                              <h5 class="mb-0">{{'bpm_db_controls'|translate}}</h5>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <!-- 
               <div class="row sm-row">
                  <div class="col-lg-3 col-sm-3 sm-col left-small-boxes-risk-db">
                     <div class="bg-white padding-small-10 btm-space-10 db-shadow risk-db-left-one"
                        *ngFor="let color of BPMDashboardStore.BpmPieChart">
                        <div class="left-line-type-text-main d-inline-block">
                           <div class="left-line-type-text">
                              <h3 class="big-text-one mb-0">{{color.count}}</h3>
                              <p [attr.class]="'dot-div-new mb-0 dot-'+color.label">{{color.risk_ratings}}</p>
                           </div>
                        </div>
                     </div>
                  
                  </div>
                  <div class="col-lg-9 col-sm-9 sm-col">
                     <div class="bg-white widg-padding-cmn btm-space-10 db-shadow risk-db-left-two">
                        <h6>Process / Risk wise</h6>
                        <hr>
                        <div class="risk-aab-chart-one" *ngIf="!showPieNoDataMap">
                           <div id="bpmchart" style="width: 100%; height: 250px"></div>
                        </div>
                        <div class="risk-aab-chart-one" *ngIf="showPieNoDataMap" style="min-height: 250px;">
                           <app-no-chart-data [source]="bpmPieChart">
                           </app-no-chart-data>
                        </div>
                     </div>
                  </div>
               </div> -->
               <div class="bg-white widg-padding-cmn btm-space-10 db-shadow" *ngIf = "OrganizationModulesStore.checkOrganizationModules(900)">
                  <h5>{{'bpm_db_process_risk_wise'|translate}}</h5>
                  <hr>
                  <div style="min-height: 323px;">
                     <div class="row sm-row ia-db-finding-sec">
                        <div class="col-lg-3 col-sm-4 sm-col">
                           <ng-container *ngFor="let color of BPMDashboardStore.BpmPieChart">
                              <div class="pt-2 pb-3 swot-sec-score-sec">
                                 <h3 class="big-text-one">{{color.count}}</h3>
                                 <p class="dot-div-new dot-normal-violet mb-0 span-dot-color">
                                    <span [ngStyle]="{'background':color.label}"></span>{{color.risk_ratings}}
                                 </p>
                              </div>
                           </ng-container>
                        </div>
                        <div class="col-lg-9 col-sm-8 sm-col">
                           <div class="dpt-pic-ceo w-100" style="width: 100%; height: 300px" *ngIf="!showPieNoDataMap">
                              <div id="bpmchart" style="height: 100%;" #bpmchart></div>
                           </div>
                           <div class="dpt-pic-ceo w-100" style="width: 100%; height: 300px" *ngIf="showPieNoDataMap">
                              <app-no-chart-data [source]="'pie'"></app-no-chart-data>
                           </div>
                          
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-lg-6 col-sm-12 sm-col">
               <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                  <h5 class="cmn-head-style m-0">{{'top_10_open_process'|translate}}</h5>
                  <hr>
                  <div class="slider-db-top-ten-sec ia-db-slider-height" style="min-height: 390px;" 
                  *ngIf="BPMDashboardStore.BpmFirst?.length != 0 || BPMDashboardStore.BpmSecond?.length != 0">
                     <!-- <div id="owl-demo-2" class="owl-carousel owl-theme"> -->
                     <!-- <div class="item"> -->
                     <owl-carousel-o [options]="clientOptions">
                        <ng-container *ngIf="BPMDashboardStore.BpmFirst?.length!=0">
                           <ng-template carouselSlide>
                              <div class="bg-white btm-space-10 widg-padding-cmn-small cmn-bdr db-box-link-sec mr-1"
                                 *ngFor="let row of BPMDashboardStore.BpmFirst; let num=index">
                                 <div
                                    [ngClass]="AuthStore.getActivityPermission(100,'PROCESS_DETAILS') ? 'd-flex align-items-center pointer' : 'd-flex align-items-center'"
                                    (click)="AuthStore.getActivityPermission(100,'PROCESS_DETAILS') ? gotoProcessDetails(row.id) : ''">
                                    <h3 class="mb-0 big-text-two text-black font-weight-600">{{num+1}}</h3>
                                    <div class="w-100 ml-3">
                                       <p class="mb-0 text-black font-weight-600 elips">{{row.title}}</p>
                                    </div>
                                    <div class="ml-2" style="width: 100px;">
                                       <p [attr.class]="'dot-div-new mb-0 dot-'+row.label">{{row.risk_score}}</p>
                                       <p class="mb-0 text-black">{{row.risk_ratings}}</p>
                                    </div>
                                 </div>
                              </div>
                           </ng-template>
                        </ng-container>
                        <ng-container *ngIf="BPMDashboardStore.BpmFirst?.length!=0">
                           <ng-template *ngIf="BPMDashboardStore.totalItems>5" carouselSlide>
                              <!-- </div>
                          <div class="item"> -->
                              <div class="bg-white btm-space-10 widg-padding-cmn-small cmn-bdr db-box-link-sec mr-1"
                                 *ngFor="let row of BPMDashboardStore.BpmSecond; let num=index">
                                 <div [ngClass]="AuthStore.getActivityPermission(100,'PROCESS_DETAILS') ? 'd-flex align-items-center pointer' : 'd-flex align-items-center'"
                                 (click)="AuthStore.getActivityPermission(100,'PROCESS_DETAILS') ? gotoProcessDetails(row.id) : ''">
                                    <h3 class="mb-0 big-text-two text-black font-weight-600">{{num+6}}</h3>
                                    <div class="w-100 ml-3">
                                       <p class="mb-0 text-black font-weight-600 elips">{{row.title}}</p>
                                    </div>
                                    <div class="ml-2" style="width: 100px;">
                                       <p [attr.class]="'dot-div-new mb-0 dot-'+row.label">{{row.risk_score}}</p>
                                       <p class="mb-0 text-black">{{row.risk_ratings}}</p>
                                    </div>
                                 </div>
                              </div>
                           </ng-template>
                        </ng-container>
                     </owl-carousel-o>
                     <!-- </div> -->
                     <!-- </div> -->
                  </div>
                  <div style="min-height: 404px;" *ngIf="BPMDashboardStore.BpmFirst?.length == 0 && BPMDashboardStore.BpmSecond?.length == 0" >
                     <ng-container>
                        <app-report-no-data [source]="emptyIntro"  [border]="false" [height]="true"></app-report-no-data>
                     </ng-container>
                  </div>
               </div>
            </div>
         </div>
         <div class="row sm-row" *ngIf = "OrganizationModulesStore.checkIndividualSubModule(600,23301)">
            <div class="col-sm-12 sm-col">
               <div class="bg-white widg-padding-cmn btm-space-10 db-shadow tab-with-text-db">
                  <div class="row widget-heading line-tab">
                     <div class="col-lg-6 col-md-12">
                        <h5 class="cmn-head-style m-0 pt-1">{{'bpm_db_process'|translate}}</h5>
                     </div>
                     <div class="col-lg-6 col-md-12">
                        <ul class="nav nav-tabs float-right">
                           <li class="nav-item"> <a (click)="createBarChart(1)" class="nav-link active show"
                                 data-toggle="tab" href="#risk-one">{{'bpm_db_by_department'|translate}}</a> </li>
                           <!-- <li class="nav-item"> <a (click)="createBarChart(2)" class="nav-link" data-toggle="tab" href="#risk-two">By Control</a> </li> -->
                           <li class="nav-item"> <a (click)="createBarChart(3)" class="nav-link" data-toggle="tab"
                                 href="#risk-three">{{'bpm_db_by_owner'|translate}}</a> </li>
                           <!-- <li class="nav-item"> <a class="nav-link" data-toggle="tab" href="#risk-four">By Category</a> </li>
                              <li class="nav-item"> <a class="nav-link" data-toggle="tab" href="#risk-five">By Risk Rating</a> </li> -->
                        </ul>
                     </div>
                  </div>
                  <div class="tab-content tab-content-body pt-3">
                     <div class="tab-pane active show" id="risk-one">
                        <div class="risk-chart-aab-two" *ngIf="!showNoDataBarChart">
                           <div id="barChartDepartment" style="width: 100%;height: 250px;" #barChartDepartment></div>
                        </div>
                        <div class="risk-chart-aab-two" *ngIf="showNoDataBarChart">
                           <app-no-chart-data [source]="'bar'">
                           </app-no-chart-data>
                       </div>
                     </div>
                     <div class="tab-pane fade" id="risk-two">
                        <div class="risk-chart-aab-two" *ngIf="!showNoDataBarChart">
                           <div id="barChartControls" style="width: 100%;height: 250px;" #barChartControls></div>
                        </div>
                        <div class="risk-chart-aab-two" *ngIf="showNoDataBarChart">
                           <app-no-chart-data [source]="'bar'">
                           </app-no-chart-data>
                       </div>
                     </div>
                     <div class="tab-pane fade" id="risk-three">
                        <div class="risk-chart-aab-two" *ngIf="!showNoDataBarChart">
                           <div id="barChartOwner" style="width: 100%;height: 250px;" #barChartOwner></div>
                        </div>
                        <div class="risk-chart-aab-two" *ngIf="showNoDataBarChart">
                           <app-no-chart-data [source]="'bar'">
                           </app-no-chart-data>
                       </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <ng-container *mobxAutorun>
         <div *ngIf="!BPMDashboardStore.dashboardLoaded">
             <app-bpm-dashboard-loader></app-bpm-dashboard-loader>
         </div>
      </ng-container>
   </div>
</main>