
<nav class="edit-bar" data-toggle="affix" scrollPoint #navigationBar *mobxAutorun>
    <app-breadcrumb-menu></app-breadcrumb-menu>
    <div class="module-name-block module-name-block-space float-left">
       <a class="dropdown module-title">{{'isms_risk_details' | translate}}</a>
     </div>
     <app-sub-menu></app-sub-menu>
  </nav>
<main class="mt-3 acl-page cpf-space-adjust db-small-space-boxes">
    <div class="container-fluid">
        <!-- <div class="ceo-db-top" data-toggle="affix">
            <div class="box-cnt-one tab-type-btn-small breadcrumb-db-top clearfix">
               <h6 class="mb-0">{{ 'isms_risk_details' | translate}}</h6>
                <div style="float: right;">
 
               <span class="mr-1" 
               style="font-size: 13px;color: #0088ff;"><a [routerLink]="['/isms/dashboard']" class="breadcrumb-db-back-page ml-3"><i
                class="fas fa-arrow-left"></i>{{ 'back_to_dashboard' | translate}}</a></span>
                </div>
            </div>
         </div> -->

        <div class="row sm-row">
            <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 ceo-db-aut-three db-shadow">
                   <h5 class="cmn-head-style m-0">{{ 'risk_by_category' | translate}}</h5>
                   <hr>
  
                 <div class="">
                    <div class="chart-new-round-pic text-right" *ngIf="ISMSDashboardStore.ismsRiskCategories.length!=0">
                        <div id="chartdiv" style="width: 100%; height: 230px"></div>
                    </div>
                    <div class="chart-new-round-pic text-right" style="width: 100%; height: 230px" *ngIf="ISMSDashboardStore.ismsRiskCategories.length==0">
                      <app-no-chart-data [source]="'pie'">
                      </app-no-chart-data>
                  </div>
                </div>
  
                </div>
             </div>
             <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 ceo-db-aut-four db-shadow">
                   <h5 class="cmn-head-style m-0">{{ 'risk_by_source' | translate}} </h5>
                   <hr>
  
                   <div class="">
                    <div class="chart-new-round-pic text-right" style="width: 100%; height: 230px" *ngIf="ISMSDashboardStore.ismsRiskSource.length!=0">
                       <div id="barChart" style="height: 100%;"></div>
                   </div>
                   <div class="chart-new-round-pic text-right" style="width: 100%; height: 230px" *ngIf="ISMSDashboardStore.ismsRiskSource.length==0">
                      <app-no-chart-data [source]="'bar'">
                      </app-no-chart-data>
                  </div>
                   </div>
  
                </div>
             </div>
             <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 ceo-db-aut-four db-shadow">
                   <h5 class="cmn-head-style m-0">{{'risk_by_status' | translate}} </h5>
                   <hr>
  
                   <div class="">
                    <div class="chart-new-round-pic text-right" *ngIf="ISMSDashboardStore.IsmsRiskStatuses.length!=0">
                        <div id="chartStatus" style="width: 100%; height: 230px"></div>
                    </div>
                    <div class="chart-new-round-pic text-right" style="width: 100%; height: 230px" *ngIf="ISMSDashboardStore.IsmsRiskStatuses.length==0">
                      <app-no-chart-data [source]="'pie'">
                      </app-no-chart-data>
                  </div>
                </div>
  
                </div>
             </div>
        </div>


        <div class="row sm-row">
            <div class="col-lg-8 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{ 'risk_agening_status' | translate}}</h5>
                    <hr>
                    <div class="isms-db-dtl-page-two isms-dashboard-table-new">
                        <div class="owner-db-table-one-main bg-white">
                            <table class="ceo-db-table-one">
                               <tr>
                                <th style="width: 20%;" class="db-table-bg-dark-grey text-black">{{ 'risk_agening' | translate}}</th>
                                <th style="width: 20%;" class="text-white" [ngStyle]="{'background':risk.color}"
                                *ngFor="let risk of ISMSDashboardStore?.ismsRiskAgeningStatusCount[0]?.data">{{risk.risk_statuses | uppercase}}</th>
                             </tr>
                             <tr *ngFor="let riskAgeing of ISMSDashboardStore.ismsRiskAgeningStatusCount">
                                <td class="db-table-bg-gray">{{riskAgeing.label}}</td>
                                <td [ngClass]="risk.count > 0 ?'pointer':''" [ngStyle]="{'background':risk.light_color}"  *ngFor="let risk of riskAgeing.data" >{{risk.count}}</td>
                             </tr>

                            </table>

                         </div>
                    </div>

                </div>
            </div>
            <div class="col-lg-4 col-sm-12 sm-col">
                <div class="bg-white widg-padding-cmn btm-space-10 db-shadow">
                    <h5 class="cmn-head-style m-0">{{ 'risk_treatment_plan_prgress' | translate}}</h5>
                    <hr>
                    <div class="text-center isms-db-dtl-page-two db-md-screen-center finding-sec-height-ia-db"
                    *ngIf="ISMSDashboardStore.ismsRiskTreatmentProgressCount.length!=0">
                        <div id="chartRiskTreatment" style="width: 100%; height: 230px"></div>
                    </div>
                    <div class="chart-new-round-pic text-right" style="width: 100%; height: 230px" *ngIf="ISMSDashboardStore.ismsRiskTreatmentProgressCount.length==0">
                        <app-no-chart-data [source]="'pie'">
                        </app-no-chart-data>
                    </div>

                </div>
            </div>
        </div>


        <div class="row sm-row">

        <div class="col-sm-12 sm-col">
           <div class="bg-white widg-padding-cmn btm-space-10 tab-with-text-db">
              <div class="row widget-heading line-tab">
                 <div class="col-lg-6 col-md-12">
                    <h5 class="cmn-head-style m-0 pt-1"> {{ 'risk_heat_map' | translate}}   </h5>
                 </div>
              </div>

              <div class="tab-content tab-content-body pt-3">
                 <div class="tab-pane active show" id="document-tab-one">
                    
                    <div class="no-fixed-table relative ml-5 risk-heatmap-category likelihood-risk-table bg-white risk-heat-map-aab">
                       <table class="mt-3">
                        <tr>
                            <!-- <td></td> -->
                            <td rowspan="6">
                                <h4 class="mb-0">
                                    <div class="risk-dashboard-heatmap-label label-lef-center text-rotate-tbl heatmap-likelihood-title">{{ 'asset_criticality' | translate}}</div>
                                </h4>
                            </td>
                        </tr>
                        <tr *ngFor="let option of ISMSDashboardStore.ismsRiskHeatMap;let num=index">
                            <td class="number-heatmap-order-left">{{option[0].total_score / option[0].impact_likelihood_score}}</td>
                            <td [ngClass]="'color-box-risk bg-'+map.color"
                                [style.width.%]="100/option.length"
                                *ngFor="let map of option;let colm=index"><span
                                    [ngClass]="activeRow == num && activeColumn==colm?'count-risk active':'count-risk'" 
                                    (click)="redirectToHeatMap(     
                                    map.total_score,
                                    num,
                                    colm,
                                    map.risk_count)"
                                    >{{map.risk_count}}</span>
                            </td>
                        </tr>
                        <tr>
                            <!-- <td></td> -->
                            <td></td>
                            <td class="number-heatmap-order-btm" *ngFor="let option of ISMSDashboardStore.ismsRiskHeatMap[0]">
                                {{option.impact_likelihood_score}}</td>
                        </tr>
                        <tr>
                            <td class="pt-0" [attr.colspan]="ISMSDashboardStore.ismsRiskHeatMap[0]?.length+2">
                                <h4 class="mb-0">{{ 'likelihood' | translate}} x {{ 'impact' | translate}}</h4>
                            </td>
                        </tr>
                    </table>
                       
                    </div>

                 </div>
              </div>


           </div>
        </div>

     </div> 














    </div>
</main>