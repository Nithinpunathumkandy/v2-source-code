<nav class="edit-bar" data-toggle="affix" scrollPoint #navigationBar *mobxAutorun>    
    <div class="module-name-block module-name-block-space float-left">
        <a class="dropdown module-title">{{'audit' | translate }} {{'dashboard' | translate }}</a>
    </div>
      <div class="dropdown edit-dropdown d-xl-none">
        <a class="btn btn-primary float-right three-dots-dropdown dropdown-toggle" data-toggle="dropdown"><i class="fas fa-ellipsis-v"></i></a>
    </div>
      <ul class="nav nav-pills edit-icons float-right d-none d-xl-block" role="tablist">
        <li>            
            <button  type="button" (click)="goToFindings()" class="btn btn-small btn-header-db">{{'findings' | translate }} {{'dashboard' | translate }}&nbsp;&nbsp;<i class="fas fa-arrow-right"></i></button>
            <button  type="button" (click)="goToTopFindings()" class="btn btn-small btn-header-db">{{'top_20_findings' | translate}}&nbsp;&nbsp;<i class="fas fa-arrow-right"></i></button>
        </li>
    </ul>        
 </nav>

<main class="audit-program-details-page db-small-space-boxes db-layout-150 mt-3">
    <app-filter-menu></app-filter-menu>
    <div class="container-fluid" *ngIf="AMAuditDashboardStore.commonLoader">
        <div class="row">
            <div class="col-sm-12">
               <div class="widget">
                  <div class="tab-content">
                     <!-- Profille -->
                     <div class="tab-pane active" id="top-tab-left-one">
                        
                        <div>       
                           <div class="row sm-row">
                              <div class="col-lg-3 col-sm-6 sm-col">
                                <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow db-box-hover " [ngClass]="AMAuditDashboardStore?.auditCount?.total_am_annual_plan!=0 ? 'pointer':''" (click)="goToAuditProgram(AMAuditDashboardStore?.auditCount?.total_am_annual_plan)">
                                  <div class="w-100 db-box-hover-inner">
                                       <div class="text-left">
                                           <h3 class="big-text-three">{{AMAuditDashboardStore?.auditCount?.total_am_annual_plan}}</h3>
                                           <div class="row sm-row">
                                             <div class="col-6 sm-col">
                                                 <p class="mb-0 text-black elips-1">{{'audit_program' | translate }}</p>
                                              </div>
                                              <div class="col-6 sm-col text-right">
                                                 <a class="mb-0 text-black font-weight-600 hover-text view-dtl-link-db">Details<i class="far fa-angle-right small-text text-17 mt-0 ml-2 text-black"></i></a>
                                              </div>
                                           </div>
                                       </div>
                                   </div>        
                                </div>
                              </div>
                              <div class="col-lg-3 col-sm-6 sm-col">
                                <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow db-box-hover " [ngClass]="AMAuditDashboardStore?.auditCount?.total_am_individual_audit_plan!=0 ? 'pointer':''" (click)="goToIndividualAuditPlan(AMAuditDashboardStore?.auditCount?.total_am_individual_audit_plan)">
                                  <div class="w-100 db-box-hover-inner">
                                       <div class="text-left">
                                           <h3 class="big-text-three">{{AMAuditDashboardStore?.auditCount?.total_am_individual_audit_plan}}</h3>
                                           <div class="row sm-row">
                                             <div class="col-6 sm-col">
                                                 <p class="mb-0 text-black elips-1">{{'audit_plan' | translate }}</p>
                                              </div>
                                              <div class="col-6 sm-col text-right">
                                                 <a class="mb-0 text-black font-weight-600 hover-text view-dtl-link-db">{{'details' | translate }}<i class="far fa-angle-right small-text text-17 mt-0 ml-2 text-black"></i></a>
                                              </div>
                                           </div>
                                       </div>
                                   </div>        
                                </div>
                              </div>
                              <div class="col-lg-3 col-sm-6 sm-col">
                                <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow db-box-hover " [ngClass]="AMAuditDashboardStore?.auditCount?.total_am_audit!=0 ? 'pointer':''" (click)="goToAudit(AMAuditDashboardStore?.auditCount?.total_am_audit)">
                                  <div class="w-100 db-box-hover-inner">
                                       <div class="text-left">
                                           <h3 class="big-text-three">{{AMAuditDashboardStore?.auditCount?.total_am_audit}}</h3>
                                           <div class="row sm-row">
                                             <div class="col-6 sm-col">
                                                 <p class="mb-0 text-black elips-1">{{'audits' | translate }}</p>
                                              </div>
                                              <div class="col-6 sm-col text-right">
                                                 <a class="mb-0 text-black font-weight-600 hover-text view-dtl-link-db">{{'details' | translate }}<i class="far fa-angle-right small-text text-17 mt-0 ml-2 text-black"></i></a>
                                              </div>
                                           </div>
                                       </div>
                                   </div>        
                                </div>
                              </div>
                              <div class="col-lg-3 col-sm-6 sm-col">
                                <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow db-box-hover pointer" [ngClass]="AMAuditDashboardStore?.auditCount?.total_finding!=0 ? 'pointer':''" (click)="goToFinding(AMAuditDashboardStore?.auditCount?.total_finding)">
                                  <div class="w-100 db-box-hover-inner">
                                       <div class="text-left">
                                           <h3 class="big-text-three">{{AMAuditDashboardStore?.auditCount?.total_finding}}</h3>
                                           <div class="row sm-row">
                                             <div class="col-6 sm-col">
                                                 <p class="mb-0 text-black elips-1">{{'findings' | translate }}</p>
                                              </div>
                                              <div class="col-6 sm-col text-right">
                                                 <a class="mb-0 text-black font-weight-600 hover-text view-dtl-link-db">{{'details' | translate }}<i class="far fa-angle-right small-text text-17 mt-0 ml-2 text-black"></i></a>
                                              </div>
                                           </div>
                                       </div>
                                   </div>        
                                </div>
                              </div>
                           </div>
        
                           <div class="row sm-row">
                              <div class="col-lg-8 col-sm-12 sm-col">
                                 <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow">
                                    <div class="row sm-row align-items-center">
                                       <div class="col-12 sm-col">
                                           <h5 class="cmn-head-style m-0">{{'audit_status' | translate }}</h5>
                                        </div>
                                     </div>
                                    <hr>
        
                                    
                                    
        
                                    <div class="db-md-screen-center">
                                        <!-- AM Chart -->
                                        <div class="w-100">
        
        
                                         <div class="row">
                                           <div class="col-lg-5">
                                              <ul class="list_reports">
                                                 <li *ngFor="let row of AMAuditDashboardStore.getAuditStatuses" [ngClass]="row?.type == 'planning' ? 'org' : row?.type == 'draft-report' ? 'red' : row?.type == 'field-work' ? '' : row?.type == 'preliminary-report' ? 'lgrey' : 'l-blue' " [ngStyle]="{'color': row?.color_code}"><span>{{row?.title}}</span> <div><span class="dots" [ngStyle]="{'background': row?.color_code}"></span>{{row?.count}}</div></li>                                                 
                                               </ul> 
                                            </div> 
                                            <div class="col-lg-7" *ngIf="AMAuditDashboardStore.getAuditStatuses?.length >0">
                                              <div id="risk-by-rating-chart" style="height: 300px;"></div>
                                            </div>
                                            <div class="col-lg-7" style="height: 300px;" *ngIf="AMAuditDashboardStore.getAuditStatuses?.length == 0">
                                                <app-no-chart-data [source]="'pie'"></app-no-chart-data>
                                            </div>
                                         </div>                                            
                                        </div>
        
                                    </div>
        
                                </div>
                              </div>
                              <div class="col-lg-4 col-sm-12 sm-col">
                                 <div class="row sm-row">
                                    <div class="col-lg-12 col-sm-6 sm-col">
                                       <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow">
                                          <h5 class="cmn-head-style m-0">{{'audit_plans' | translate }} VS {{'audits' | translate }}</h5>
                                          <hr>
                                          <div class="text-center ia-db-finding-department db-md-screen-center compliance-score-height">
        
                                            <div class="w-100" *ngIf="AMAuditDashboardStore.getAuditPlan?.total_am_audit !=0 || AMAuditDashboardStore.getAuditPlan?.total_am_individual_audit_plan !=0">                                              
                                               <div style="height: 300px;" id="chartdiv"></div>
                                            </div>
                                            <div style="height: 300px;" class="w-100" *ngIf="AMAuditDashboardStore.getAuditPlan?.total_am_audit == 0 && AMAuditDashboardStore.getAuditPlan?.total_am_individual_audit_plan ==0 ">
                                                <app-no-chart-data [source]="'bar'"></app-no-chart-data>
                                            </div>
        
                                          </div>
                                      </div>
                                    </div>
                                    
                                    
                                 </div>
                              </div>
                               <div class="col-lg-4 sm-col">
                                   <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow">
                                     <div class="col-12 sm-col">
                                           <h5 class="cmn-head-style m-0">{{'ea_db_findings_by_risk_rating' | translate }}</h5>
                                           <hr>
                                        </div>
                                        <div *ngIf="AMAuditDashboardStore.getFindingRiskRating?.length > 0">
                                            <div id="risk-treatment-chart" style="height: 225px;"></div>
                                        </div>
                                        <div style="height: 225px;" *ngIf="AMAuditDashboardStore.getFindingRiskRating?.length == 0">
                                            <app-no-chart-data [source]="'pie'"></app-no-chart-data>
                                        </div>                                      
                                   </div>
                             </div>
                             <div class="col-lg-4 sm-col">
                                <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow">
                                     <h5 class="cmn-head-style m-0">{{'corrective_action' | translate }}</h5>
                                     <hr>
                                     <div class="text-center ia-db-finding-department db-md-screen-center grc-audit-box-two-height">
                       
                                        <div class="w-100">
                                         
                                           <div class="grc-db-action-plan-box">
                                                            
                                               <div class="round-doted-md grc-db-action-box-one">
                                                  <div class="round-doted-color-div-inner db-md-screen-center bg-red relative">
                                                     <div class="rotate-line rotate-animation"></div>
                                                     <div class="w-100">
                                                        <h6 class="text-22 mb-0 text-white">{{'due' | translate }}</h6>
                                                        <p class="mb-0 text-white">{{AMAuditDashboardStore?.getCorrectiveAction?.due_corrective_action}}</p>
                                                     </div>
                                                  </div>
                                                </div>
                       
                                                  <div class="round-doted-color-div-inner db-md-screen-center grc-db-action-box-two" style="background: #B7E2FF;">
                                                     <div class="w-100">
                                                        <h6 class="text-22 mb-0">{{AMAuditDashboardStore?.getCorrectiveAction?.not_solved_corrective_action}}</h6>
                                                        <p class="mb-0">{{'not' | translate }}<br> {{'solved' | translate }}</p>
                                                     </div>
                                                  </div>
                       
                                                  <div class="round-doted-color-div-md grc-db-action-box-three">
                                                     <div class="round-doted-color-div-inner db-md-screen-center" style="background: #E3EBF0;">
                                                        <div class="w-100">
                                                           <h6 class="text-22 mb-0">{{AMAuditDashboardStore?.getCorrectiveAction?.total_corrective_action}}</h6>
                                                           <p class="mb-0">{{'total' | translate }}</p>
                                                        </div>
                                                     </div>
                                                   </div>
                                              
                       
                                            </div>
                                            <hr>
                       
                                            <div class="d-flex mt-2">
                                              <div class="w-100 text-left">
                                                 <p class="mb-0 elips-2">The last action plan was done on    <span class="text-black font-weight-600">{{AMAuditDashboardStore?.getCorrectiveAction?.last_row?.created_at | date: 'dd/MM/yyyy' }}</span><span class="text-black font-weight-600"> &nbsp;{{AMAuditDashboardStore?.getCorrectiveAction?.last_row?.corrective_action_status?.language[0]?.pivot?.title}}</span></p>
                                              </div>
                                             </div>
                       
                                       </div>
                       
                                     </div>
                                 </div>
                            </div>
             <div class="col-xl-4 col-lg-6 col-sm-6 sm-col">
                 <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow">
                      <h5 class="cmn-head-style m-0">{{'impact_analysis' | translate }}</h5>
                      <hr>
                      <div class="grc-audit-box-two-height">
                          
                            <div class="row">
                             <div class="col-6 mt-3 mb-3 cmn-bdr-right">
                                 <div class="d-flex">
                                     <h6 class="mb-0 text-red mr-1 text-20"></h6>
                                     <div class="w-100">
                                         <h6 class="mb-0 text-red text-20">${{AMAuditDashboardStore?.getImpactAnalysis?.money_total}}</h6>
                                         <p class="mb-0 text-black">{{'money' | translate }}</p>
                                     </div>
                                 </div>
                             </div>
                             <div class="col-6 mt-3 mb-3">
                                 <div class="d-flex">
                                     <h6 class="mb-0 text-green mr-1 text-20"></h6>
                                     <div class="w-100">
                                         <h6 class="mb-0 text-green text-20">{{AMAuditDashboardStore?.getImpactAnalysis?.total_time}}</h6>
                                         <p class="mb-0 text-black">{{'hours' | translate }}</p>
                                     </div>
                                 </div>
                             </div>
                            </div>
        
                            <div class="row align-items-end mt-4">
                             <div class="col-6 mt-3 mb-3">
                                 <div class="d-flex">
                                     <h6 class="mb-0 text-red mr-1 text-20"></h6>
                                     <div class="w-100">
                                         <h6 class="mb-0 text-red text-20">{{AMAuditDashboardStore?.getImpactAnalysis?.average_performance}}%</h6>
                                         <p class="mb-0 text-black">{{'performance' | translate }}</p>
                                     </div>
                                 </div>
                             </div>
                            </div>
                            
                        
        
                      </div>
                  </div>
             </div>
                               <div class="col-lg-12 col-sm-12 sm-col">
                                 <div class="row sm-row">
                                    <div class="col-lg-12 col-sm-6 sm-col">
                                       <div class="bg-white widg-padding-cmn-small btm-space-10 db-shadow">
                                          <h5 class="cmn-head-style m-0">{{'am_audit_by_departments' | translate }}</h5>
                                          <hr>
                                          <div class="text-center ia-db-finding-department db-md-screen-center compliance-score-height">
        
                                             <div class="w-100" *ngIf="AMAuditDashboardStore.getAuditDepartment?.length > 0">                                              
                                               <div style="width: 100%;height: 380px;" id="chartdiv2"></div>
                                            </div>
                                            <div *ngIf="AMAuditDashboardStore.getAuditDepartment?.length == 0" class="w-100">
                                                <app-no-chart-data [source]="'bar'"></app-no-chart-data>
                                            </div>
        
                                          </div>
                                      </div>
                                    </div>
                                    
                                    
                                 </div>
                              </div>
                              
                              
                           </div>
        
                           
        
        
                        </div>
                        
                     </div>
                     
                     
                  </div>
               </div>
            </div>
         </div>
    </div>
    <ng-container  *mobxAutorun>
        <app-am-audit-dashboard-loader *ngIf="!AMAuditDashboardStore.commonLoader"></app-am-audit-dashboard-loader>
    </ng-container>
</main>
