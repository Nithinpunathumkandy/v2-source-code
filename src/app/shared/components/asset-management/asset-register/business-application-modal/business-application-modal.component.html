<button type="button" class="close" data-dismiss="modal" (click)="cancel()"><i
    class="lni-close"></i><span>esc</span></button>
<div class="modal-dialog modal-xl modal-dialog-centered" *mobxAutorun>
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="modal-title">{{'business_application_modal_title' | translate}} {{businessApplicationModalTitle?.component ? businessApplicationModalTitle?.component : 'item'}}</h4>

        </div>
        
        <div class="modal-body form-body add-profie-org-pup">
            
            <p class="head-details">{{'business_application_modal_message' | translate}} {{businessApplicationModalTitle?.component ? businessApplicationModalTitle?.component : 'item'}}</p>
            <div class="row">
                <div class="col-sm-6 col-lg-6">
                    <div class="form-group">
                        <label for="name">{{'search' | translate}}</label>
                       
                        <form class="form-control issue-select-process-search bg-white search-popup-new" (submit)="searchBusinessApplication()">
                            <input type="text" [(ngModel)]="searchTerm" placeholder="Search.." name="search" (keyup)="searchBusinessApplication()"
                                class="search-process" autocomplete="off">
                            <a class="search-clear-btn" (click)="clear()" *ngIf="searchTerm">X</a>
                        
                            <button type="submit" (click)="searchBusinessApplication()"><i class="fa fa-search"></i></button>
                        </form>
                    </div>
                </div>
                <!-- <div class="col-sm-6 col-lg-6">
                    <div class="form-group">
                        <label for="name">{{'issue_category' | translate}}</label>
                        <div class="clearfix">
                            <div class="multiple-plain-ngselect">
                                <ng-select [items]="IssueCategoryStore.issueCategories"
                                    placeholder="Select Issue Category" 
                                    [multiple]="false"
                                    bindLabel="title"
                                    bindValue="id"
                                    [(ngModel)] = "issue_category_id"
                                    (search)="searchIssueCategory($event)" 
                                    (change)="sortIssues()"
                                    (clear)="getIssueCategory()" 
                                    (open)="getIssueCategory()"
                                    autocomplete="new-password">
                                    
                                </ng-select>
                            </div>
                        </div>
                    </div>
                </div> -->

                <!-- <div class="col-sm-4 col-lg-4">
                    <div class="form-group">
                        <label for="name">{{'issue_domain' | translate}}</label>
                        <div class="clearfix">
                            <div class="multiple-plain-ngselect">
                                <ng-select [items]="IssueDomainMasterStore.issueDomains"
                                    placeholder="Select Issue Domain" 
                                    [multiple]="false"
                                    bindLabel="title"
                                    bindValue="id"
                                    [(ngModel)] = "issue_domain_id"
                                    (search)="searchDomain($event)" 
                                    (clear)="getDomain()"
                                    (change)="sortIssues()" 
                                    (open)="getDomain()"
                                    autocomplete="new-password">
                                    
                                </ng-select>
                            </div>
                        </div>
                    </div>
                </div> -->
                <!-- <div class="col-sm-4 col-lg-4">
                    <div class="form-group">
                        <label for="name">{{'issue_type' | translate}}</label>
                        <div class="clearfix">
                            <div class="multiple-plain-ngselect">
                                <ng-select [items]="IssueTypeStore.issueTypes"
                                    placeholder="Select Issue Type"
                                    [multiple]="false"
                                    [(ngModel)] = "issue_type_id"
                                    (search)="searchIssueType($event)" 
                                    (clear)="getIssueType()"
                                    (open)="getIssueType()" 
                                    (change)="sortIssues()"
                                    bindLabel="title"
                                    bindValue="id"
                                    autocomplete="new-password">
                                    
                                </ng-select>
                            </div>
                        </div>
                    </div>
                </div> -->
              
                <!-- <div class="col-sm-4 col-lg-4">
                    <div class="form-group">
                        <label for="name">{{'department' | translate}}</label>
                        <div class="multiple-plain-ngselect bg-white">
                           <ng-select [items]="DepartmentStore.department"
                              bindLabel="title"
                              bindValue="id"
                              placeholder="Select Department"
                              [multiple]="false"
                              [(ngModel)] = "department_ids"
                              (search) = "searchDepartment($event)"
                              (clear) = "getDepartment()"
                              (open) = "getDepartment()"
                              (change) = "sortIssues()">
                           </ng-select>
                        </div>
                    </div>
                </div> -->
            </div>

            <div class="audit-form-table w-100">
                <table class="table table-bordered ordinary-table table-hover issue-list-table-org mb-1">
                    <thead>
                        <tr>
                            <th class="border-top-0 issue-list-org-tab-one" width="4%">
                                <div class="container2">
                                    <label><input type="checkbox" id="selectall" (change)="selectAllBusinessApplications($event)" />
                                        <span class="checkmark"></span>#</label>
                        
                                </div>
                            </th>
                            <!-- <th class="border-top-0 issue-list-org-tab-two pointer" (click)="setIssueSort('organization_issues.reference_code')"
                                width="15%">{{'reference_code' | translate}}
                            </th>
                            <th class="border-top-0 issue-list-org-tab-three pointer" width="25%"
                                (click)="setIssueSort('organization_issues.title')">{{'issue' | translate}} <img
                                    *ngIf="BusinessApplicationsMasterStore.orderItem == 'organization_issues.title'"
                                    [attr.src]="BusinessApplicationsMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'"
                                    class="sort-down-pics"></th>
                            <th class="border-top-0 issue-list-org-tab-four pointer" width="15%" (click)="setIssueSort('organization_issues.type')">
                                {{'issue_type' | translate}} <img *ngIf="BusinessApplicationsMasterStore.orderItem == 'organization_issues.type'"
                                    [attr.src]="BusinessApplicationsMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'"
                                    class="sort-down-pics"></th>
                            <th class="border-top-0 issue-list-org-tab-four pointer" width="15%" (click)="setIssueSort('issue_categories')">{{'
                                issue_category' | translate}} <img *ngIf="BusinessApplicationsMasterStore.orderItem == 'issue_categories'"
                                    [attr.src]="BusinessApplicationsMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'"
                                    class="sort-down-pics"></th>
                            <th class="border-top-0 issue-list-org-tab-four pointer" width="15%" (click)="setIssueSort('issue_domains')">
                                {{'issue_domain' | translate}} <img *ngIf="BusinessApplicationsMasterStore.orderItem == 'issue_domains'"
                                    [attr.src]="BusinessApplicationsMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'"
                                    class="sort-down-pics"></th>
                            <th class="border-top-0 issue-list-org-tab-five pointer" width="15%" (click)="setIssueSort('departments')">
                                {{'department' | translate}} <img *ngIf="BusinessApplicationsMasterStore.orderItem == 'departments'"
                                    [attr.src]="BusinessApplicationsMasterStore.orderBy == 'asc'?'assets/images/sort-down.png':'assets/images/sort-up.png'"
                                    class="sort-up-pics"></th> -->
                            <th (click)="sortTitle('business_applications_title')" class="border-top-0 issue-list-org-tab-three pointer" width="19%">
                                <span>{{'title' | translate}}</span>
                                <img _ngcontent-twv-c17="" class="sort-down-pics pl-2" [attr.src]="BusinessApplicationsMasterStore.orderBy=='desc' ? 
                                     'assets/images/sort-up.png' : BusinessApplicationsMasterStore.orderBy=='asc' ? 
                                      'assets/images/sort-down.png' : 'assets/images/sort-empty.png'">
                            </th> 
                            <th width="20%">{{'description' | translate}}</th>        
                            <th width="17%">{{'business_application_type' | translate}}</th>                
                            <th width="11%">{{'supplier' | translate}}</th>
                            <th width="7%">{{'is_amc' | translate}}</th>
                            <th width="11%">{{'amc_start' | translate}}</th>
                            <th width="11%">{{'amc_end' | translate}}</th>
                              
                        </tr>
                    </thead>
                    <tbody>
                    
                        <tr [attr.title]="'View '+businessApplications.title"
                            *ngFor="let businessApplications of BusinessApplicationsMasterStore.businessApplications | paginate: {id:'business-application-modal',currentPage:BusinessApplicationsMasterStore?.currentPage, itemsPerPage:BusinessApplicationsMasterStore?.itemsPerPage,totalItems:BusinessApplicationsMasterStore?.totalItems};let num = index">

                            <td>
                            
                                <div class="container2">
                                    <label><input class="pointer" type="checkbox" [checked]="businessApplicationPresent(businessApplications.id)"
                                            (change)="businessApplicationSelected(businessApplications)" class="case" name="case" />
                                        <span
                                            class="checkmark"></span>{{(BusinessApplicationsMasterStore?.currentPage - 1) * BusinessApplicationsMasterStore?.itemsPerPage + (num + 1)}}</label>
                                </div>
                            </td>
                            <td>{{businessApplications.title}}</td>
                            <td>{{businessApplications.description ? businessApplications.description : AppStore.noContentText}}</td>
                            <td>{{businessApplications.business_application_type_title}}</td>                        
                            <td>{{businessApplications.supplier_title? businessApplications.supplier_title : AppStore.noContentText}}</td>
                            <td>{{businessApplications.is_amc==1?'True':'False'}}</td>
                            <td>{{businessApplications.amc_start | date : OrganizationGeneralSettingsStore.organizationSettings?.date_format}}
                                <p *ngIf="!businessApplications?.amc_start"> {{AppStore.noContentText}}</p>
                            </td>
                            <td>{{businessApplications.amc_end | date : OrganizationGeneralSettingsStore.organizationSettings?.date_format}}
                                <p *ngIf="!businessApplications?.amc_start"> {{AppStore.noContentText}}</p>
                            </td>
                            
                        </tr>

                    </tbody>

                </table>
                <app-no-data-list *ngIf="BusinessApplicationsMasterStore.loaded && BusinessApplicationsMasterStore.businessApplications.length == 0"  [source]="emptyBusinessApplications"></app-no-data-list>
                
                <div class="col-sm-12" *ngIf="BusinessApplicationsMasterStore?.totalItems > BusinessApplicationsMasterStore?.itemsPerPage">
                    <ul class="pagination justify-content-center mt-3">
                        <div class="list">
                            <pagination-controls (pageChange)="pageChange($event)" id="business-application-modal" class="my-pagination">
                            </pagination-controls>
                        </div>
                    </ul>
                </div>

            </div>

            <div class="d-block justify-content-left border-0 mt-5">
                <button type="button" data-toggle="modal"
                    class="btn mr-3 btn-active" (click)="save()" [disabled]="selectedBusinessApplications.length==0">{{'add' | translate}}</button>
                <button type="button" data-toggle="modal" class="btn mr-3"
                    (click)="save(true)" [disabled]="selectedBusinessApplications.length==0">{{'add_close' | translate}}</button>
                <button type="button" data-toggle="modal" class="btn mr-2"
                (click)="cancel()">{{'cancel' | translate}}</button>
            </div>

        </div>
        
    </div>
</div>
